/*! For license information please see main.6a3f1d48.js.LICENSE.txt */
!function(){var t={7465:function(t){"use strict";var e,i="object"===typeof Reflect?Reflect:null,n=i&&"function"===typeof i.apply?i.apply:function(t,e,i){return Function.prototype.apply.call(t,e,i)};e=i&&"function"===typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var r=Number.isNaN||function(t){return t!==t};function s(){s.init.call(this)}t.exports=s,t.exports.once=function(t,e){return new Promise((function(i,n){function r(i){t.removeListener(e,s),n(i)}function s(){"function"===typeof t.removeListener&&t.removeListener("error",r),i([].slice.call(arguments))}d(t,e,s,{once:!0}),"error"!==e&&function(t,e,i){"function"===typeof t.on&&d(t,"error",e,i)}(t,r,{once:!0})}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var o=10;function a(t){if("function"!==typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function h(t){return void 0===t._maxListeners?s.defaultMaxListeners:t._maxListeners}function u(t,e,i,n){var r,s,o,u;if(a(i),void 0===(s=t._events)?(s=t._events=Object.create(null),t._eventsCount=0):(void 0!==s.newListener&&(t.emit("newListener",e,i.listener?i.listener:i),s=t._events),o=s[e]),void 0===o)o=s[e]=i,++t._eventsCount;else if("function"===typeof o?o=s[e]=n?[i,o]:[o,i]:n?o.unshift(i):o.push(i),(r=h(t))>0&&o.length>r&&!o.warned){o.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=t,l.type=e,l.count=o.length,u=l,console&&console.warn&&console.warn(u)}return t}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function c(t,e,i){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:i},r=l.bind(n);return r.listener=i,n.wrapFn=r,r}function g(t,e,i){var n=t._events;if(void 0===n)return[];var r=n[e];return void 0===r?[]:"function"===typeof r?i?[r.listener||r]:[r]:i?function(t){for(var e=new Array(t.length),i=0;i<e.length;++i)e[i]=t[i].listener||t[i];return e}(r):f(r,r.length)}function _(t){var e=this._events;if(void 0!==e){var i=e[t];if("function"===typeof i)return 1;if(void 0!==i)return i.length}return 0}function f(t,e){for(var i=new Array(e),n=0;n<e;++n)i[n]=t[n];return i}function d(t,e,i,n){if("function"===typeof t.on)n.once?t.once(e,i):t.on(e,i);else{if("function"!==typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,(function r(s){n.once&&t.removeEventListener(e,r),i(s)}))}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(t){if("number"!==typeof t||t<0||r(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");o=t}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(t){if("number"!==typeof t||t<0||r(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},s.prototype.getMaxListeners=function(){return h(this)},s.prototype.emit=function(t){for(var e=[],i=1;i<arguments.length;i++)e.push(arguments[i]);var r="error"===t,s=this._events;if(void 0!==s)r=r&&void 0===s.error;else if(!r)return!1;if(r){var o;if(e.length>0&&(o=e[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var h=s[t];if(void 0===h)return!1;if("function"===typeof h)n(h,this,e);else{var u=h.length,l=f(h,u);for(i=0;i<u;++i)n(l[i],this,e)}return!0},s.prototype.addListener=function(t,e){return u(this,t,e,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(t,e){return u(this,t,e,!0)},s.prototype.once=function(t,e){return a(e),this.on(t,c(this,t,e)),this},s.prototype.prependOnceListener=function(t,e){return a(e),this.prependListener(t,c(this,t,e)),this},s.prototype.removeListener=function(t,e){var i,n,r,s,o;if(a(e),void 0===(n=this._events))return this;if(void 0===(i=n[t]))return this;if(i===e||i.listener===e)0===--this._eventsCount?this._events=Object.create(null):(delete n[t],n.removeListener&&this.emit("removeListener",t,i.listener||e));else if("function"!==typeof i){for(r=-1,s=i.length-1;s>=0;s--)if(i[s]===e||i[s].listener===e){o=i[s].listener,r=s;break}if(r<0)return this;0===r?i.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(i,r),1===i.length&&(n[t]=i[0]),void 0!==n.removeListener&&this.emit("removeListener",t,o||e)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(t){var e,i,n;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[t]&&(0===--this._eventsCount?this._events=Object.create(null):delete i[t]),this;if(0===arguments.length){var r,s=Object.keys(i);for(n=0;n<s.length;++n)"removeListener"!==(r=s[n])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(e=i[t]))this.removeListener(t,e);else if(void 0!==e)for(n=e.length-1;n>=0;n--)this.removeListener(t,e[n]);return this},s.prototype.listeners=function(t){return g(this,t,!0)},s.prototype.rawListeners=function(t){return g(this,t,!1)},s.listenerCount=function(t,e){return"function"===typeof t.listenerCount?t.listenerCount(e):_.call(t,e)},s.prototype.listenerCount=_,s.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]}},9054:function(t,e,i){"use strict";var n,r=i(4704).default,s=i(6690).default,o=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Animation=e.PlayMode=void 0,function(t){t[t.NORMAL=0]="NORMAL",t[t.LOOP=1]="LOOP",t[t.LOOP_PINGPONG=2]="LOOP_PINGPONG",t[t.REVERSED=3]="REVERSED",t[t.LOOP_REVERSED=4]="LOOP_REVERSED"}(n=e.PlayMode||(e.PlayMode={}));var a=function(){function t(e,i){s(this,t),this.totalDuration=0,this.keyFrames=e,Array.isArray(i)||(i=[i]);for(var n=i[i.length-1]||0;i.length<e.length;)i.push(n);var o,a=r(i);try{for(a.s();!(o=a.n()).done;){var h=o.value;this.totalDuration+=h}}catch(u){a.e(u)}finally{a.f()}this.frameDurations=i}return o(t,[{key:"getFrameNumber",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.frameDurations,n=e?i.length-1:0;!((t-=i[n])<0);)e?n--:n++;return n}},{key:"getKeyFrame",value:function(t,e){var i=this.keyFrames,r=this.frameDurations,s=this.totalDuration,o=Math.floor(t/s),a=t%s,h=0;switch(e){case n.NORMAL:h=0===o?this.getFrameNumber(a):r.length-1;break;case n.LOOP:h=this.getFrameNumber(a);break;case n.LOOP_PINGPONG:h=this.getFrameNumber(a,o%2===1);break;case n.REVERSED:h=0===o?this.getFrameNumber(a,!0):0;break;case n.LOOP_REVERSED:h=this.getFrameNumber(a,!0)}return i[h]}}]),t}();e.Animation=a},5283:function(t,e,i){"use strict";var n=i(7061).default,r=i(9728).default,s=i(6690).default,o=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function o(t){try{h(n.next(t))}catch(e){s(e)}}function a(t){try{h(n.throw(t))}catch(e){s(e)}}function h(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.BitmapFont=void 0;var a=i(6735),h=i(909),u=i(8637),l=r((function t(e,i,n){var r=this;s(this,t),this.load=function(t){for(var e=Object.values(t.glyphs),i=0;i<e.length;i++){var n=e[i];if(n)for(var s=0;s<n.length;s++){var o=n[s];o&&t.setGlyphRegion(o,r.regions[o.page])}}null!=t.missingGlyph&&t.setGlyphRegion(t.missingGlyph,r.regions[t.missingGlyph.page])},this.draw=function(t,e,i,n,s){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:u.Align.left,a=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],h=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:e.length,c=arguments.length>9?arguments[9]:void 0;r.cache.clear(),r.cache.addText(e,i,n,h,l,s,o,a,c),r.cache.draw(t)},this.getColor=function(){return r.cache.getColor()},this.getScaleX=function(){return r.data.scaleX},this.getScaleY=function(){return r.data.scaleY},this.getRegions=function(){return r.regions},this.getRegion=function(t){return r.regions[t]},this.getLineHeight=function(){return r.data.lineHeight},this.getSpaceXadvance=function(){return r.data.spaceXadvance},this.getXHeight=function(){return r.data.xHeight},this.getCapHeight=function(){return r.data.capHeight},this.getAscent=function(){return r.data.ascent},this.getDescent=function(){return r.data.descent},this.isFlipped=function(){return r.flipped},this.dispose=function(){if(r.ownsTexture)for(var t=0;t<r.regions.length;t++)r.regions[t].texture.dispose()},this.setFixedWidthGlyphs=function(t){for(var e=r.data,i=0,n=0,s=t.length;n<s;n++){var o=e.getGlyph(t.charAt(n));null!=o&&o.xadvance>i&&(i=o.xadvance)}for(var a=0,h=t.length;a<h;a++){var u=e.getGlyph(t.charAt(a));u&&(u.xoffset+=(i-u.xadvance)/2,u.xadvance=i,u.kerning=[],u.kerning=null,u.fixedWidth=!0)}},this.setUseIntegerPositions=function(t){r.integer=t,r.cache.setUseIntegerPositions(t)},this.usesIntegerPositions=function(){return r.integer},this.getCache=function(){return r.cache},this.getData=function(){return r.data},this.getOwnsTexture=function(){return r.ownsTexture},this.setOwnsTexture=function(t){r.ownsTexture=t},this.newFontCache=function(){return new a.BitmapFontCache(r,r.integer)},this.regions=i,this.flipped=e.flipped,this.data=e,this.integer=n,0!==this.regions.length?(this.ownsTexture=!1,this.cache=this.newFontCache(),this.load(e)):console.log("No texture region were found")}));e.BitmapFont=l,l.load=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return o(void 0,void 0,void 0,n().mark((function s(){var o;return n().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=new h.BitmapFontData(e,i),n.next=3,o.loadFont(t);case 3:return n.abrupt("return",new l(o,o.regions,r));case 4:case"end":return n.stop()}}),s)})))}},6735:function(t,e,i){"use strict";var n=i(861).default,r=i(6690).default,s=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.BitmapFontCache=void 0;var o=i(417),a=i(2226),h=i(8637),u=function(){function t(e,i){var s=this;r(this,t),this.tempColor=new h.Color(1,1,1,1),this.drawingTexts=[],this.layouts=[],this.pooledLayouts=[],this.color=new h.Color(1,1,1,1),this.setPosition=function(t,e){s.translate(t-s.x,e-s.y)},this.translate=function(t,e){if(0!==t||0!==e){s.integer&&(t=Math.round(t),e=Math.round(e)),s.x+=t,s.y+=e;for(var i=s.pageVertices,n=0,r=i.length;n<r;n++)for(var o=i[n],a=0,h=s.idx[n];a<h;a+=5)o[a]+=t,o[a+1]+=e}},this.setColors=function(t,e,i,n){for(var r=255<<24|255*i<<16|255*e<<8|255*t,o=a.NumberUtil.intToFloatColor(r),h=0,u=s.pageVertices.length;h<u;h++)for(var l=s.pageVertices[h],c=2,g=s.idx[h];c<g;c+=5)l[c]=o},this.getColor=function(){return s.color},this.setColor=function(t,e,i,n){s.color.set(t,e,i,n)},this.clear=function(){s.x=0,s.y=0,h.Pools.freeAll("GlyphLayout",s.pooledLayouts),s.pooledLayouts.length=0,s.layouts.length=0;for(var t=0,e=s.idx.length;t<e;t++)null!=s.pageGlyphIndices&&(s.pageGlyphIndices[t].length=0),s.idx[t]=0},this.requireGlyphs=function(t){if(1===s.pageVertices.length)s.requirePageGlyphs(0,t.glyphCount);else{for(var e=s.tempGlyphCount,i=0;i<e.length;i++)e[i]=0;for(var n=0,r=t.runs.length;n<r;n++)for(var o=t.runs[n].glyphs,a=o,h=0,u=o.length;h<u;h++)e[a[h].page]++;for(var l=0,c=e.length;l<c;l++)s.requirePageGlyphs(l,e[l])}},this.requirePageGlyphs=function(t,e){var i=s.idx[t]+20*e,n=s.pageVertices[t];if(n){if(n.length<i){var r=new Array(i);h.Utils.arrayCopy(n,0,r,0,s.idx[t]),s.pageVertices[t]=r}}else s.pageVertices[t]=new Array(i)},this.setPageCount=function(t){var e=new Array(t).fill([]);h.Utils.arrayCopy(s.pageVertices,0,e,0,s.pageVertices.length),s.pageVertices=n(e);var i=new Array(t);h.Utils.arrayCopy(s.idx,0,i,0,s.idx.length),s.idx=i;var r=new Array(t),o=0;null!=s.pageGlyphIndices&&(o=s.pageGlyphIndices.length,h.Utils.arrayCopy(s.pageGlyphIndices,0,r,0,s.pageGlyphIndices.length));for(var a=o;a<t;a++)r[a]=[];s.pageGlyphIndices=r,s.tempGlyphCount=new Array(t)},this.addToCache=function(t,e,i){var n=t.runs.length;if(0!==n){s.pageVertices.length<s.font.regions.length&&s.setPageCount(s.font.regions.length),s.layouts.push(t),s.requireGlyphs(t);var r=t.colors,o=0,h=0,u=0,l=0;s.drawingTexts.length=0;for(var c=0;c<n;c++)for(var g=t.runs[c],_=g.glyphs,f=g.xAdvances,d=e+g.x,p=i+g.y,v=0,x=g.glyphs.length;v<x;v++)u++===h&&(l=a.NumberUtil.intToFloatColor(r[++o]),h=++o<r.length?r[o]:-1),d+=f[v],s.drawingTexts.push(_[v].id),s.addGlyph(_[v],d,p,l);s.currentTint=a.NumberUtil.intToFloatColor(-1)}},this.addGlyph=function(t,e,i,n){var r=s.font.data.scaleX,o=s.font.data.scaleY;e+=t.xoffset*r,i+=t.yoffset*o;var a=t.width*r,h=t.height*o,u=t.u,l=t.u2,c=t.v,g=t.v2;s.integer&&(e=Math.round(e),i=Math.round(i),a=Math.round(a),h=Math.round(h));var _=e+a,f=i+h,d=t.page,p=s.idx[d];s.idx[d]+=20,null!=s.pageGlyphIndices&&s.pageGlyphIndices[d].push(s.glyphCount++);var v=s.pageVertices[d];v[p++]=e,v[p++]=i,v[p++]=n,v[p++]=u,v[p++]=c,v[p++]=e,v[p++]=f,v[p++]=n,v[p++]=u,v[p++]=g,v[p++]=_,v[p++]=f,v[p++]=n,v[p++]=l,v[p++]=g,v[p++]=_,v[p++]=i,v[p++]=n,v[p++]=l,v[p]=c},this.setText=function(t,e,i,n,r,o,a,h,u){return s.clear(),s.addText(t,e,i,n,r,o,a,h,u)},this.setTextToCache=function(t,e,i){s.clear(),s.addTextToCache(t,e,i)},this.addText=function(t,e,i,n,r,o,a,u,l){var c=h.Pools.obtain("GlyphLayout");return s.pooledLayouts.push(c),c.setText(s.font,t,n,r,s.color,o,a,u,l),s.addTextToCache(c,e,i),c},this.addTextToCache=function(t,e,i){s.addToCache(t,e,i+s.font.data.ascent)},this.getX=function(){return s.x},this.getY=function(){return s.y},this.getFont=function(){return s.font},this.setUseIntegerPositions=function(t){s.integer=t},this.usesIntegerPositions=function(){return s.integer},this.getVertices=function(t){return s.pageVertices[t]},this.getVertexCount=function(t){return s.idx[t]},this.getLayouts=function(){return s.layouts},this.font=e,this.integer=i;var u=e.regions.length;if(0===u&&console.log("The specified font must contain at least one texture page."),this.pageVertices=new Array(u).fill([]),this.idx=new Array(u),u>1){this.pageGlyphIndices=new Array(u);for(var l=0,c=this.pageGlyphIndices.length;l<c;l++)this.pageGlyphIndices[l]=[]}this.tempGlyphCount=new Array(u),h.Pools.get("GlyphLayout",(function(){return new o.GlyphLayout(e,"",0,0,h.Color.WHITE,0,h.Align.left,!1)}))}return s(t,[{key:"draw",value:function(t){for(var e=this,i=this.font.getRegions(),n=0;n<this.pageVertices.length;n++)if(this.idx[n]>0)for(var r=this.pageVertices[n],s=function(n){var s=20*n,o=i.find((function(t){var i;return t.id===(null===(i=e.drawingTexts)||void 0===i?void 0:i[n])}));o&&o.draw(t,r[0+s],r[1+s],r[10+s]-r[0+s],r[11+s]-r[1+s])},o=0;o<this.idx[n]/20;o++)s(o)}}]),t}();e.BitmapFontCache=u},909:function(t,e,i){"use strict";var n=i(861).default,r=i(7061).default,s=i(6690).default,o=i(9728).default,a=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function o(t){try{h(n.next(t))}catch(e){s(e)}}function a(t){try{h(n.throw(t))}catch(e){s(e)}}function h(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.BitmapFontData=void 0;var h=i(5508),u=i(3432),l=i(8026);function c(t,e){for(var i=t.split("/"),n=e.split("/"),r=[],s=0,o=i.length;s<o;s++)if(".."===i[s])r.pop();else{if("."===i[s])continue;r.push(i[s])}for(var a=0,h=n.length;a<h;a++)if(".."===n[a])r.pop();else{if("."===n[a])continue;r.push(n[a])}return r.join("/")}var g=65535,_=function(){function t(e,i){var n=this;s(this,t),this.capHeight=1,this.blankLineScale=1,this.scaleX=1,this.scaleY=1,this.glyphs={},this.xHeight=1,this.xChars=["x","e","a","o","n","s","r","c","u","m","v","w","z"],this.capChars=["M","N","B","D","C","E","F","K","A","G","H","I","J","L","O","P","Q","R","S","T","U","V","W","X","Y","Z"],this.loadFont=function(t){return a(n,void 0,void 0,r().mark((function e(){var i,n,s,o,a,_,d,p,v,x,y,m,M,w,b,E,C,k,P,S,L,T,V,A,F,O,R,I,D,N,j,G,X,B,Y,W,U,H,z,q,K,Z,Q,$,J,tt,et,it,nt,rt,st,ot,at,ht,ut,lt,ct,gt,_t,ft,dt,pt,vt,xt,yt,mt;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.imagePaths){e.next=2;break}return e.abrupt("return");case 2:return i=0,e.next=5,fetch(this.fontFile);case 5:return s=e.sent,e.next=8,s.text();case 8:if(n=e.sent,o=n.split("\n").map((function(t){return t.trim()})),e.prev=10,"string"===typeof(a=o[i])){e.next=14;break}throw new Error("File is empty.");case 14:if(a=a.substring(a.indexOf("padding=")+8),4===(_=a.substring(0,a.indexOf(" ")).split(",",4)).length){e.next=18;break}throw new Error("Invalid padding.");case 18:if(this.padTop=parseInt(_[0]),this.padRight=parseInt(_[1]),this.padBottom=parseInt(_[2]),this.padLeft=parseInt(_[3]),d=this.padTop+this.padBottom,i++,"string"===typeof(a=o[i])){e.next=27;break}throw new Error("Missing common header.");case 27:if(!((p=a.split(" ",9)).length<3)){e.next=30;break}throw new Error("Invalid common header.");case 30:if(p[1].startsWith("lineHeight=")){e.next=32;break}throw new Error("Missing: lineHeight");case 32:if(this.lineHeight=parseInt(p[1].substring(11)),p[2].startsWith("base=")){e.next=35;break}throw new Error("Missing: base");case 35:if(v=parseInt(p[2].substring(5)),x=1,p.length>=6&&null!=p[5]&&p[5].startsWith("pages="))try{x=Math.max(1,parseInt(p[5].substring(6)))}catch(r){}this.imagePaths=new Array(x),y=[],m=0;case 41:if(!(m<x)){e.next=65;break}if(i++,"string"===typeof(a=o[i])){e.next=46;break}throw new Error("Missing additional page definitions.");case 46:if(!((M=a.match(new RegExp(".*id=(\\d+)")))&&M.length>1)){e.next=57;break}if(w=M[1],e.prev=49,parseInt(w)===m){e.next=53;break}throw new Error("Page IDs must be indices starting at 0: "+w);case 53:e.next=57;break;case 55:e.prev=55,e.t0=e.catch(49);case 57:if((b=a.match(new RegExp('.*file="?([^"]+)"?')))&&!(b.length<=1)){e.next=60;break}throw new Error("Missing: file");case 60:E=b[1],y[m]=E;case 62:m++,e.next=41;break;case 65:this.descent=0;case 66:if(i++,a=o[i]){e.next=71;break}return e.abrupt("break",105);case 71:if(!a.startsWith("kernings ")){e.next=73;break}return e.abrupt("break",105);case 73:if(!a.startsWith("metrics ")){e.next=75;break}return e.abrupt("break",105);case 75:if(a.startsWith("char ")){e.next=77;break}return e.abrupt("continue",66);case 77:if(C=new h.Glyph,(k=new f(a,"=")).nextToken(),k.nextToken(),!((P=parseInt(k.nextToken()))>0&&P>g)){e.next=84;break}return e.abrupt("continue",66);case 84:if(C.id=P+"",k.nextToken(),C.srcX=parseInt(k.nextToken()),k.nextToken(),C.srcY=parseInt(k.nextToken()),k.nextToken(),C.width=parseInt(k.nextToken()),k.nextToken(),C.height=parseInt(k.nextToken()),k.nextToken(),C.xoffset=parseInt(k.nextToken()),k.nextToken(),this.flipped?C.yoffset=parseInt(k.nextToken()):C.yoffset=-(C.height+parseInt(k.nextToken())),k.nextToken(),C.xadvance=parseInt(k.nextToken()),k.hasMoreTokens()&&k.nextToken(),k.hasMoreTokens())try{C.page=parseInt(k.nextToken())}catch(Mt){}C.width>0&&C.height>0&&(this.descent=Math.min(v+C.yoffset,this.descent)),P<=0?this.missingGlyph=C:P<=g&&this.setGlyph(P,C),e.next=66;break;case 105:this.descent+=this.padBottom;case 106:if(i++,"string"===typeof(a=o[i])){e.next=111;break}return e.abrupt("break",127);case 111:if(a.startsWith("kerning ")){e.next=113;break}return e.abrupt("break",127);case 113:if((S=new f(a,"=")).nextToken(),S.nextToken(),L=parseInt(S.nextToken()),S.nextToken(),T=parseInt(S.nextToken()),!(L<0||L>g||T<0||T>g)){e.next=121;break}return e.abrupt("continue",106);case 121:V=this.getGlyph(L+""),S.nextToken(),A=parseInt(S.nextToken()),V&&V.setKerning(T,A),e.next=106;break;case 127:F=!1,O=0,R=0,I=0,D=0,N=0,j=0,G=0,null!=a&&a.startsWith("metrics ")&&(F=!0,(X=new f(a,"=")).nextToken(),X.nextToken(),O=parseFloat(X.nextToken()),X.nextToken(),R=parseFloat(X.nextToken()),X.nextToken(),I=parseFloat(X.nextToken()),X.nextToken(),D=parseFloat(X.nextToken()),X.nextToken(),N=parseFloat(X.nextToken()),X.nextToken(),j=parseFloat(X.nextToken()),X.nextToken(),G=parseFloat(X.nextToken())),(B=this.getGlyph("32"))||((B=new h.Glyph).id="32",(Y=this.getGlyph("l"))||(Y=this.getFirstGlyph()),B.xadvance=Y.xadvance,this.setGlyph(32,B)),0===B.width&&(B.width=this.padLeft+B.xadvance+this.padRight,B.xoffset=-this.padLeft),this.spaceXadvance=B.xadvance,U=0;case 141:if(!(U<this.xChars.length)){e.next=148;break}if(!(W=this.getGlyph(this.xChars[U]))){e.next=145;break}return e.abrupt("break",148);case 145:U++,e.next=141;break;case 148:W||(W=this.getFirstGlyph()),this.xHeight=W.height-d,z=0;case 151:if(!(z<this.capChars.length)){e.next=158;break}if(!(H=this.getGlyph(this.capChars[z]))){e.next=155;break}return e.abrupt("break",158);case 155:z++,e.next=151;break;case 158:if(H){e.next=178;break}q=Object.values(this.glyphs),K=0;case 161:if(!(K<q.length)){e.next=176;break}if(Z=q[K]){e.next=165;break}return e.abrupt("continue",173);case 165:Q=0;case 166:if(!(Q<Z.length)){e.next=173;break}if(Z[Q]&&0!==Z[Q].height&&0!==Z[Q].width){e.next=169;break}return e.abrupt("continue",170);case 169:this.capHeight=Math.max(this.capHeight,Z[Q].height);case 170:Q++,e.next=166;break;case 173:K++,e.next=161;break;case 176:e.next=179;break;case 178:this.capHeight=H.height;case 179:for(this.capHeight-=d,this.ascent=v-this.capHeight,this.down=-this.lineHeight,this.flipped&&(this.ascent=-this.ascent,this.down=-this.down),F&&(this.ascent=O,this.descent=R,this.down=I,this.capHeight=D,this.lineHeight=N,this.spaceXadvance=j,this.xHeight=G),$=[],J=Object.values(this.glyphs),tt=0;tt<J.length;tt++)for(et=Object.values(J[tt]),it=0;it<et.length;it++)nt={id:et[it].id,left:et[it].srcX,top:et[it].srcY,width:et[it].width,height:et[it].height,xoffset:et[it].xoffset,yoffset:et[it].yoffset,xadvance:et[it].xadvance,page:y[et[it].page],pageId:et[it].page},$.push(nt);rt=[],st=0;case 189:if(!(st<x)){e.next=199;break}return e.next=192,u.Texture.load(t,c(this.fontFile,"../".concat(y[st])));case 192:ot=e.sent,at=1/ot.width,ht=1/ot.height,rt.push({texture:ot,invTexWidth:at,invTexHeight:ht});case 196:st++,e.next=189;break;case 199:for(this.regions=[],ut=0,lt=$;ut<lt.length;ut++)ct=lt[ut],gt=ct.left,_t=ct.top,ft=ct.width,dt=ct.height,pt=rt[ct.pageId],vt=pt.texture,xt=pt.invTexWidth,yt=pt.invTexHeight,(mt=new l.TextureRegion(vt,gt,_t,ft,dt,ct,xt,yt)).originalWidth=ft,mt.originalHeight=dt,mt.offsetX=0,mt.offsetY=0,this.regions.push(mt);e.next=206;break;case 203:e.prev=203,e.t1=e.catch(10),console.error(e.t1);case 206:case"end":return e.stop()}}),e,this,[[10,203],[49,55]])})))},this.setGlyphRegion=function(t,e){var i=e.texture,r=1/i.width,s=1/i.height,o=e.u,a=e.v,h=(e.originalWidth,e.originalHeight,t.srcX),u=t.srcX+t.width,l=t.srcY,c=t.srcY+t.height;t.u=o+h*r,t.u2=o+u*r,n.flipped?(t.v=a+l*s,t.v2=a+c*s):(t.v2=a+l*s,t.v=a+c*s)},this.setLineHeight=function(t){n.lineHeight=t*n.scaleY,n.down=n.flipped?n.lineHeight:-n.lineHeight},this.setGlyph=function(t,e){var i=n.glyphs[t/h.PAGE_SIZE];i||(i=new Array(h.PAGE_SIZE),n.glyphs[t/h.PAGE_SIZE]=i),i[t&h.PAGE_SIZE-1]=e},this.getFirstGlyph=function(){for(var t=Object.values(n.glyphs),e=0;e<t.length;e++){var i=t[e];if(i)for(var r=0;r<i.length;r++){var s=i[r];if(s&&0!==s.height&&0!==s.width)return s}}},this.hasGlyph=function(t){return!!n.missingGlyph||null!=n.getGlyph(t)},this.getGlyph=function(t){var e=n.glyphs[t.charCodeAt(0)/h.PAGE_SIZE];if(null!=e)return e[t.charCodeAt(0)&h.PAGE_SIZE-1]},this.getGlyphs=function(t,e,i,r,s){if(0!==r-i){var o=n.markupEnabled,a=n.scaleX,h=t.glyphs,u=t.xAdvances;do{var l=e.charAt(i++);if("\r"!==l){var c=n.getGlyph(l);if(!c){if(!n.missingGlyph)continue;c=n.missingGlyph}h.push(c),u.push(s?(s.xadvance+s.getKerning(l))*a:c.fixedWidth?0:-c.xoffset*a-n.padLeft),s=c,o&&"["===l&&i<r&&"["===e.charAt(i)&&i++}}while(i<r);if(s){var g=s.fixedWidth?s.xadvance*a:(s.width+s.xoffset)*a-n.padRight;u.push(g)}}},this.getWrapIndex=function(t,e){var i=e-1,r=t,s=r[i].id;if(n.isWhitespace(s+""))return i;for(n.isBreakChar(s+"")&&i--;i>0;i--)if(s=r[i].id,n.isWhitespace(s+"")||n.isBreakChar(s+""))return i+1;return 0},this.isBreakChar=function(t){if(!n.breakChars)return!1;for(var e=String.fromCharCode(parseInt(t)),i=0;i<n.breakChars.length;i++)if(e===n.breakChars[i])return!0;return!1},this.isWhitespace=function(t){switch(String.fromCharCode(parseInt(t))){case"\n":case"\r":case"\t":case" ":return!0;default:return!1}},this.getImagePath=function(t){return n.imagePaths[t]},this.getImagePaths=function(){return n.imagePaths},this.setScale=function(t,e){if(0!==t&&0!==e){var i=t/n.scaleX,r=e/n.scaleY;n.lineHeight*=r,n.spaceXadvance*=i,n.xHeight*=r,n.capHeight*=r,n.ascent*=r,n.descent*=r,n.down*=r,n.padLeft*=i,n.padRight*=i,n.padTop*=r,n.padBottom*=r,n.scaleX=t,n.scaleY=e}},this.scale=function(t){n.setScale(n.scaleX+t,n.scaleY+t)},this.fontFile=e,this.flipped=i}return o(t,[{key:"setXYScale",value:function(t){this.setScale(t,t)}}]),t}();e.BitmapFontData=_;var f=function(){function t(e,i){s(this,t),this.strArray=[],this.currentIndex=0;for(var r=e.split(/\s+/),o=0;o<r.length;o++){var a,h=r[o];(a=this.strArray).push.apply(a,n(h.split(i)))}}return o(t,[{key:"hasMoreTokens",value:function(){return this.currentIndex>=this.strArray.length}},{key:"nextToken",value:function(){return this.strArray[this.currentIndex++]}}]),t}()},814:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.OrthoCamera=void 0;var s=i(5474),o=i(2668),a=function(){function t(e,i,r,a){n(this,t),this.position=new o.Vector3(0,0,0),this.direction=new o.Vector3(0,0,-1),this.up=new o.Vector3(0,1,0),this.near=0,this.far=100,this.zoom=1,this.viewportWidth=0,this.viewportHeight=0,this.projectionView=new s.Matrix4,this.inverseProjectionView=new s.Matrix4,this.projection=new s.Matrix4,this.view=new s.Matrix4,this.tmp3=new o.Vector3,this.resize(e,i,r,a)}return r(t,[{key:"setYDown",value:function(t){t?(this.up.set(0,-1,0),this.direction.set(0,0,1)):(this.up.set(0,1,0),this.direction.set(0,0,-1)),this.update()}},{key:"resize",value:function(t,e,i,n){this.viewportWidth=t,this.viewportHeight=e,this.screenWidth=i,this.screenHeight=n,this.update()}},{key:"setPosition",value:function(t,e){this.position.set(t,e,this.position.z)}},{key:"update",value:function(){var t=this.projection,e=this.view,i=this.projectionView,n=this.inverseProjectionView,r=this.zoom,s=this.viewportWidth,o=this.viewportHeight;t.ortho(r*(-s/2),r*(s/2),r*(-o/2),r*(o/2),this.near,this.far),e.lookAt(this.position,this.direction,this.up),i.set(t.values),i.multiply(e),n.set(i.values).invert()}},{key:"screenToWorld",value:function(t,e,i){e=e||this.screenWidth,i=i||this.screenHeight;var n=t.x,r=i-t.y-1;return t.x=2*n/e-1,t.y=2*r/i-1,t.z=2*t.z-1,t.project(this.inverseProjectionView),t}},{key:"worldToScreen",value:function(t,e,i){return e=e||this.screenWidth,i=i||this.screenHeight,t.project(this.projectionView),t.x=e*(t.x+1)/2,t.y=i*(t.y+1)/2,t.z=(t.z+1)/2,t}},{key:"unprojectVector2",value:function(t,e){this.tmp3.set(e.x,e.y,0),this.screenToWorld(this.tmp3),t.set(this.tmp3.x,this.tmp3.y)}},{key:"setViewport",value:function(t,e){this.viewportWidth=t,this.viewportHeight=e}}]),t}();e.OrthoCamera=a},2229:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Game=void 0;var s=function(){function t(){n(this,t)}return r(t,[{key:"setScreen",value:function(t){this.currentScreen&&this.currentScreen.dispose&&this.currentScreen.dispose(),this.currentScreen=t,this.currentScreen&&this.currentScreen.init&&this.currentScreen.init(this)}},{key:"update",value:function(t){this.currentScreen&&this.currentScreen.update&&this.currentScreen.update(t,this)}}]),t}();e.Game=s,s.shared=new s},5508:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Glyph=e.PAGES=e.PAGE_SIZE=e.LOG2_PAGE_SIZE=void 0,e.LOG2_PAGE_SIZE=9,e.PAGE_SIZE=1<<e.LOG2_PAGE_SIZE,e.PAGES=65536/e.PAGE_SIZE;var s=function(){function t(){n(this,t),this.page=0}return r(t,[{key:"getKerning",value:function(t){if(this.kerning){var i=this.kerning[t.charCodeAt(0)>>>e.LOG2_PAGE_SIZE];if(null!=i)return i[t.charCodeAt(0)&e.PAGE_SIZE-1]}return 0}},{key:"setKerning",value:function(t,i){this.kerning||(this.kerning=[]);var n=this.kerning[t>>>e.LOG2_PAGE_SIZE];n||(this.kerning[t>>>e.LOG2_PAGE_SIZE]=n=new Uint32Array(new ArrayBuffer(e.PAGE_SIZE))),n[t&e.PAGE_SIZE-1]=i}}]),t}();e.Glyph=s},417:function(t,e,i){"use strict";var n=i(861).default,r=i(6690).default,s=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.GlyphLayout=void 0;var o=i(1013),a=i(8637),h=function(){function t(e,i,s,h,u,l,c,g,_){var f=this;r(this,t),this.epsilon=1e-4,this.glyphRunPool=a.Pools.get("GlyphRun",(function(){return new o.GlyphRun})),this.colorStack=new Array(4),this.runs=[],this.colors=[],this.setText=function(t,e,i,n,r,s,o,a,h){f.reset();var u=t.data;if(i!==n){a&&(s=Math.max(s,3*u.spaceXadvance));var l=a||null!=h,c=r.toIntBits(),g=c;f.colors.shift();var _=u.markupEnabled;_&&f.colorStack.push(c);for(var d=!1,p=0,v=u.down,x=null,y=null,m=i;;){var M=void 0,w=!1;if(i===n){if(m===n)break;M=n,d=!0}else{if("\n"!==e.charAt(i++))continue;M=i-1,w=!0}t:{var b=f.glyphRunPool.obtain();if(b.x=0,b.y=p,u.getGlyphs(b,e,m,M,y),f.glyphCount+=b.glyphs.length,g!==c&&(f.colors[f.colors.length-2]===f.glyphCount?f.colors[f.colors.length-1]=g:(f.colors.push(f.glyphCount),f.colors.push(g)),c=g),0===b.glyphs.length){if(f.glyphRunPool.free(b),!x)break}else x?(x.appendRun(b),f.glyphRunPool.free(b)):(x=b,f.runs.push(x));if(w||d?(f.setLastGlyphXAdvance(u,x),y=null):y=x.glyphs[x.glyphs.length-1],l&&0!==x.glyphs.length&&(w||d))for(var E=x.xAdvances[0]+x.xAdvances[1],C=2;C<x.xAdvances.length;C++){var k=x.glyphs[C-1];if(E+f.getGlyphWidth(k,u)-f.epsilon<=s)E+=x.xAdvances[C];else{if(null!=h){f.truncate(u,x,s,h);break}var P=u.getWrapIndex(x.glyphs,C);if((0===P&&0===x.x||P>=x.glyphs.length)&&(P=C-1),!(x=f.wrap(u,x,P)))break t;f.runs.push(x),p+=v,x.x=0,x.y=p,E=x.xAdvances[0]+x.xAdvances[1],C=1}}}w&&(x=null,y=null,p+=M===m?v*u.blankLineScale:v),m=i}f.height=u.capHeight+Math.abs(p),f.calculateWidths(u),f.alignRuns(s,o),_&&(f.colorStack.length=0)}else f.height=u.capHeight},this.calculateWidths=function(t){for(var e,i=0,r=n(f.runs),s=0,o=f.runs.length;s<o;s++){for(var a=r[s],h=a.xAdvances,u=a.x+h[0],l=0,c=a.glyphs,g=0;g<a.glyphs.length;){var _=c[g],d=f.getGlyphWidth(_,t);l=Math.max(l,u+d),u+=null!==(e=h[++g])&&void 0!==e?e:0}a.width=Math.max(u,l)-a.x,i=Math.max(i,a.x+(isNaN(a.width)?u:a.width))}f.width=i},this.alignRuns=function(t,e){if(0===(e&a.Align.left))for(var i=0!==(e&a.Align.center),r=n(f.runs),s=0,o=f.runs.length;s<o;s++){var h=r[s];h.x+=i?.5*(t-h.width):t-h.width}},this.truncate=function(t,e,i,n){var r=e.glyphs.length,s=f.glyphRunPool.obtain();t.getGlyphs(s,n,0,n.length,null);var o=0;if(s.xAdvances.length>0){f.setLastGlyphXAdvance(t,s);for(var h=s.xAdvances,u=1;u<s.xAdvances.length;u++)o+=h[u]}i-=o;for(var l=0,c=e.x,g=e.xAdvances;l<e.xAdvances.length;){if((c+=g[l])>i)break;l++}if(l>1){if(l-1>=0&&e.glyphs.length>l-1)for(var _=l-1;_<e.glyphs.length;_++)e.glyphs.splice(_,1);if(l>=0&&e.xAdvances.length>l)for(var d=l;d<e.xAdvances.length;d++)e.xAdvances.splice(d,1);f.setLastGlyphXAdvance(t,e),s.xAdvances.length>0&&a.Utils.arrayCopy(s.xAdvances,1,e.xAdvances,e.xAdvances.length,s.xAdvances.length-1)}else e.glyphs.length=0,e.xAdvances.length=0,a.Utils.arrayCopy(s.xAdvances,0,e.xAdvances,e.xAdvances.length,s.xAdvances.length);var p=r-e.glyphs.length;if(p>0&&(f.glyphCount-=p,t.markupEnabled))for(;f.colors.length>2&&f.colors[f.colors.length-2]>=f.glyphCount;)f.colors.length-=2;a.Utils.arrayCopy(s.glyphs,0,e.glyphs,e.glyphs.length,s.glyphs.length),f.glyphCount+=n.length,f.glyphRunPool.free(s)},this.setLastGlyphXAdvance=function(t,e){var i=e.glyphs[e.glyphs.length-1];i.fixedWidth||(e.xAdvances[e.xAdvances.length-1]=f.getGlyphWidth(i,t))},this.getGlyphWidth=function(t,e){return(t.width+t.xoffset)*e.scaleX-e.padRight},this.getLineOffset=function(t,e){return-t[0].xoffset*e.scaleX-e.padLeft},this.reset=function(){f.glyphRunPool.freeAll(f.runs),f.runs.length=0,f.colors.length=0,f.glyphCount=0,f.width=0,f.height=0},this.setText(e,i,s,h,u,l,c,g,_)}return s(t,[{key:"wrap",value:function(t,e,i){for(var n=e.glyphs.length,r=e.glyphs,s=e.xAdvances,o=i;o>0&&t.isWhitespace(r[o-1].id);o--);for(var h,u=i;u<n&&t.isWhitespace(r[u].id);u++);if(u<n){var l=(h=this.glyphRunPool.obtain()).glyphs;a.Utils.arrayCopy(r,0,l,l.length,o),r.splice(0,u-1+1),e.glyphs=l,h.glyphs=r;var c=h.xAdvances;a.Utils.arrayCopy(s,0,c,c.length,o+1),s.splice(1,u),s[0]=this.getLineOffset(r,t),e.xAdvances=c,h.xAdvances=s;var g=e.glyphs.length,_=h.glyphs.length,f=n-g-_;if(this.glyphCount-=f,t.markupEnabled&&f>0)for(var d=this.glyphCount-_,p=this.colors.length-2;p>=2;p-=2){var v=this.colors[p];if(v<=d)break;this.colors[p]=v-f}}else{r=r.slice(0,o),s=s.slice(0,o+1);var x=u-o;if(x>0&&(this.glyphCount-=x,t.markupEnabled&&this.colors[this.colors.length-2]>this.glyphCount)){for(var y=this.colors[this.colors.length-1];this.colors[this.colors.length-2]>this.glyphCount;)this.colors.length-=2;this.colors[this.colors.length-2]=this.glyphCount,this.colors[this.colors.length-1]=y}}return 0===o?(this.glyphRunPool.free(e),this.runs.pop()):this.setLastGlyphXAdvance(t,e),h}}]),t}();e.GlyphLayout=h},1013:function(t,e,i){"use strict";var n=i(9728).default,r=i(6690).default;Object.defineProperty(e,"__esModule",{value:!0}),e.GlyphRun=void 0;var s=n((function t(){var e=this;r(this,t),this.glyphs=[],this.xAdvances=[],this.appendRun=function(t){e.glyphs.concat(t.glyphs),e.xAdvances.length||e.xAdvances.length--,e.xAdvances.concat(t.xAdvances)},this.reset=function(){e.glyphs.length=0,e.xAdvances.length=0}}));e.GlyphRun=s},3233:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.InputHandler=e.InputEvent=void 0;var s=i(7465),o=i(3192);!function(t){t.TouchStart="touchStart",t.TouchEnd="touchEnd",t.TouchMove="touchMove"}(e.InputEvent||(e.InputEvent={}));var a=function(){function t(e){var i=this;n(this,t),this.screenCoord=new o.Vector2,this.worldCoord=new o.Vector2,this.canvas=e,this.lastX=0,this.lastY=0,this.touched=!1;var r=this.emitter=new s.EventEmitter;this.mouseDownHandler=function(t){i.touched=!0,i.handleMove(t),r.emit("touchStart",i.getX(),i.getY())},this.mouseUpHandler=function(t){i.touched=!1,r.emit("touchEnd",i.getX(),i.getY())},this.mouseMoveHandler=function(t){i.handleMove(t),r.emit("touchMove",i.getX(),i.getY())},this.touchStartHandler=function(t){t.preventDefault();var e=t.touches[0];i.canvas.dispatchEvent(new MouseEvent("mousedown",{clientX:e.clientX,clientY:e.clientY}))},this.touchEndHandler=function(t){t.preventDefault(),i.canvas.dispatchEvent(new MouseEvent("mouseup"))},this.touchMoveHandler=function(t){t.preventDefault();var e=t.touches[0];i.canvas.dispatchEvent(new MouseEvent("mousemove",{clientX:e.clientX,clientY:e.clientY}))},this.canvas.addEventListener("mousedown",this.mouseDownHandler,!1),this.canvas.addEventListener("mouseup",this.mouseUpHandler,!1),this.canvas.addEventListener("mousemove",this.mouseMoveHandler,!1),this.canvas.addEventListener("touchstart",this.touchStartHandler,!1),this.canvas.addEventListener("touchend",this.touchEndHandler,!1),this.canvas.addEventListener("touchmove",this.touchMoveHandler,!1)}return r(t,[{key:"cleanup",value:function(){this.canvas.removeEventListener("mousedown",this.mouseDownHandler),this.canvas.removeEventListener("mouseup",this.mouseUpHandler),this.canvas.removeEventListener("mousemove",this.mouseMoveHandler),this.canvas.removeEventListener("touchstart",this.touchStartHandler),this.canvas.removeEventListener("touchend",this.touchEndHandler),this.canvas.removeEventListener("touchmove",this.touchMoveHandler)}},{key:"addEventListener",value:function(t,e){this.emitter.addListener(t,e)}},{key:"handleMove",value:function(t){var e=this.canvas.getBoundingClientRect(),i=t.clientX-e.left,n=t.clientY-e.top;this.lastX=i,this.lastY=n}},{key:"getX",value:function(){return this.lastX}},{key:"getY",value:function(){return this.lastY}},{key:"isTouched",value:function(){return this.touched}},{key:"getTouchedWorldCoord",value:function(t){return this.screenCoord.set(this.getX(),this.getY()),t.unprojectVector2(this.worldCoord,this.screenCoord),this.worldCoord}}]),t}();e.InputHandler=a},5474:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Matrix4=e.M33=e.M32=e.M31=e.M30=e.M23=e.M22=e.M21=e.M20=e.M13=e.M12=e.M11=e.M10=e.M03=e.M02=e.M01=e.M00=void 0;var s=i(2668);e.M00=0,e.M01=4,e.M02=8,e.M03=12,e.M10=1,e.M11=5,e.M12=9,e.M13=13,e.M20=2,e.M21=6,e.M22=10,e.M23=14,e.M30=3,e.M31=7,e.M32=11,e.M33=15;var o=function(){function t(){n(this,t),this.temp=new Float32Array(16),this.values=new Float32Array(16);var i=this.values;i[e.M00]=1,i[e.M11]=1,i[e.M22]=1,i[e.M33]=1}return r(t,[{key:"set",value:function(t){return this.values.set(t),this}},{key:"transpose",value:function(){var t=this.temp,i=this.values;return t[e.M00]=i[e.M00],t[e.M01]=i[e.M10],t[e.M02]=i[e.M20],t[e.M03]=i[e.M30],t[e.M10]=i[e.M01],t[e.M11]=i[e.M11],t[e.M12]=i[e.M21],t[e.M13]=i[e.M31],t[e.M20]=i[e.M02],t[e.M21]=i[e.M12],t[e.M22]=i[e.M22],t[e.M23]=i[e.M32],t[e.M30]=i[e.M03],t[e.M31]=i[e.M13],t[e.M32]=i[e.M23],t[e.M33]=i[e.M33],this.set(t)}},{key:"identity",value:function(){var t=this.values;return t[e.M00]=1,t[e.M01]=0,t[e.M02]=0,t[e.M03]=0,t[e.M10]=0,t[e.M11]=1,t[e.M12]=0,t[e.M13]=0,t[e.M20]=0,t[e.M21]=0,t[e.M22]=1,t[e.M23]=0,t[e.M30]=0,t[e.M31]=0,t[e.M32]=0,t[e.M33]=1,this}},{key:"invert",value:function(){var t=this.values,i=this.temp,n=t[e.M30]*t[e.M21]*t[e.M12]*t[e.M03]-t[e.M20]*t[e.M31]*t[e.M12]*t[e.M03]-t[e.M30]*t[e.M11]*t[e.M22]*t[e.M03]+t[e.M10]*t[e.M31]*t[e.M22]*t[e.M03]+t[e.M20]*t[e.M11]*t[e.M32]*t[e.M03]-t[e.M10]*t[e.M21]*t[e.M32]*t[e.M03]-t[e.M30]*t[e.M21]*t[e.M02]*t[e.M13]+t[e.M20]*t[e.M31]*t[e.M02]*t[e.M13]+t[e.M30]*t[e.M01]*t[e.M22]*t[e.M13]-t[e.M00]*t[e.M31]*t[e.M22]*t[e.M13]-t[e.M20]*t[e.M01]*t[e.M32]*t[e.M13]+t[e.M00]*t[e.M21]*t[e.M32]*t[e.M13]+t[e.M30]*t[e.M11]*t[e.M02]*t[e.M23]-t[e.M10]*t[e.M31]*t[e.M02]*t[e.M23]-t[e.M30]*t[e.M01]*t[e.M12]*t[e.M23]+t[e.M00]*t[e.M31]*t[e.M12]*t[e.M23]+t[e.M10]*t[e.M01]*t[e.M32]*t[e.M23]-t[e.M00]*t[e.M11]*t[e.M32]*t[e.M23]-t[e.M20]*t[e.M11]*t[e.M02]*t[e.M33]+t[e.M10]*t[e.M21]*t[e.M02]*t[e.M33]+t[e.M20]*t[e.M01]*t[e.M12]*t[e.M33]-t[e.M00]*t[e.M21]*t[e.M12]*t[e.M33]-t[e.M10]*t[e.M01]*t[e.M22]*t[e.M33]+t[e.M00]*t[e.M11]*t[e.M22]*t[e.M33];if(0===n)throw new Error("non-invertible matrix");var r=1/n;return i[e.M00]=t[e.M12]*t[e.M23]*t[e.M31]-t[e.M13]*t[e.M22]*t[e.M31]+t[e.M13]*t[e.M21]*t[e.M32]-t[e.M11]*t[e.M23]*t[e.M32]-t[e.M12]*t[e.M21]*t[e.M33]+t[e.M11]*t[e.M22]*t[e.M33],i[e.M01]=t[e.M03]*t[e.M22]*t[e.M31]-t[e.M02]*t[e.M23]*t[e.M31]-t[e.M03]*t[e.M21]*t[e.M32]+t[e.M01]*t[e.M23]*t[e.M32]+t[e.M02]*t[e.M21]*t[e.M33]-t[e.M01]*t[e.M22]*t[e.M33],i[e.M02]=t[e.M02]*t[e.M13]*t[e.M31]-t[e.M03]*t[e.M12]*t[e.M31]+t[e.M03]*t[e.M11]*t[e.M32]-t[e.M01]*t[e.M13]*t[e.M32]-t[e.M02]*t[e.M11]*t[e.M33]+t[e.M01]*t[e.M12]*t[e.M33],i[e.M03]=t[e.M03]*t[e.M12]*t[e.M21]-t[e.M02]*t[e.M13]*t[e.M21]-t[e.M03]*t[e.M11]*t[e.M22]+t[e.M01]*t[e.M13]*t[e.M22]+t[e.M02]*t[e.M11]*t[e.M23]-t[e.M01]*t[e.M12]*t[e.M23],i[e.M10]=t[e.M13]*t[e.M22]*t[e.M30]-t[e.M12]*t[e.M23]*t[e.M30]-t[e.M13]*t[e.M20]*t[e.M32]+t[e.M10]*t[e.M23]*t[e.M32]+t[e.M12]*t[e.M20]*t[e.M33]-t[e.M10]*t[e.M22]*t[e.M33],i[e.M11]=t[e.M02]*t[e.M23]*t[e.M30]-t[e.M03]*t[e.M22]*t[e.M30]+t[e.M03]*t[e.M20]*t[e.M32]-t[e.M00]*t[e.M23]*t[e.M32]-t[e.M02]*t[e.M20]*t[e.M33]+t[e.M00]*t[e.M22]*t[e.M33],i[e.M12]=t[e.M03]*t[e.M12]*t[e.M30]-t[e.M02]*t[e.M13]*t[e.M30]-t[e.M03]*t[e.M10]*t[e.M32]+t[e.M00]*t[e.M13]*t[e.M32]+t[e.M02]*t[e.M10]*t[e.M33]-t[e.M00]*t[e.M12]*t[e.M33],i[e.M13]=t[e.M02]*t[e.M13]*t[e.M20]-t[e.M03]*t[e.M12]*t[e.M20]+t[e.M03]*t[e.M10]*t[e.M22]-t[e.M00]*t[e.M13]*t[e.M22]-t[e.M02]*t[e.M10]*t[e.M23]+t[e.M00]*t[e.M12]*t[e.M23],i[e.M20]=t[e.M11]*t[e.M23]*t[e.M30]-t[e.M13]*t[e.M21]*t[e.M30]+t[e.M13]*t[e.M20]*t[e.M31]-t[e.M10]*t[e.M23]*t[e.M31]-t[e.M11]*t[e.M20]*t[e.M33]+t[e.M10]*t[e.M21]*t[e.M33],i[e.M21]=t[e.M03]*t[e.M21]*t[e.M30]-t[e.M01]*t[e.M23]*t[e.M30]-t[e.M03]*t[e.M20]*t[e.M31]+t[e.M00]*t[e.M23]*t[e.M31]+t[e.M01]*t[e.M20]*t[e.M33]-t[e.M00]*t[e.M21]*t[e.M33],i[e.M22]=t[e.M01]*t[e.M13]*t[e.M30]-t[e.M03]*t[e.M11]*t[e.M30]+t[e.M03]*t[e.M10]*t[e.M31]-t[e.M00]*t[e.M13]*t[e.M31]-t[e.M01]*t[e.M10]*t[e.M33]+t[e.M00]*t[e.M11]*t[e.M33],i[e.M23]=t[e.M03]*t[e.M11]*t[e.M20]-t[e.M01]*t[e.M13]*t[e.M20]-t[e.M03]*t[e.M10]*t[e.M21]+t[e.M00]*t[e.M13]*t[e.M21]+t[e.M01]*t[e.M10]*t[e.M23]-t[e.M00]*t[e.M11]*t[e.M23],i[e.M30]=t[e.M12]*t[e.M21]*t[e.M30]-t[e.M11]*t[e.M22]*t[e.M30]-t[e.M12]*t[e.M20]*t[e.M31]+t[e.M10]*t[e.M22]*t[e.M31]+t[e.M11]*t[e.M20]*t[e.M32]-t[e.M10]*t[e.M21]*t[e.M32],i[e.M31]=t[e.M01]*t[e.M22]*t[e.M30]-t[e.M02]*t[e.M21]*t[e.M30]+t[e.M02]*t[e.M20]*t[e.M31]-t[e.M00]*t[e.M22]*t[e.M31]-t[e.M01]*t[e.M20]*t[e.M32]+t[e.M00]*t[e.M21]*t[e.M32],i[e.M32]=t[e.M02]*t[e.M11]*t[e.M30]-t[e.M01]*t[e.M12]*t[e.M30]-t[e.M02]*t[e.M10]*t[e.M31]+t[e.M00]*t[e.M12]*t[e.M31]+t[e.M01]*t[e.M10]*t[e.M32]-t[e.M00]*t[e.M11]*t[e.M32],i[e.M33]=t[e.M01]*t[e.M12]*t[e.M20]-t[e.M02]*t[e.M11]*t[e.M20]+t[e.M02]*t[e.M10]*t[e.M21]-t[e.M00]*t[e.M12]*t[e.M21]-t[e.M01]*t[e.M10]*t[e.M22]+t[e.M00]*t[e.M11]*t[e.M22],t[e.M00]=i[e.M00]*r,t[e.M01]=i[e.M01]*r,t[e.M02]=i[e.M02]*r,t[e.M03]=i[e.M03]*r,t[e.M10]=i[e.M10]*r,t[e.M11]=i[e.M11]*r,t[e.M12]=i[e.M12]*r,t[e.M13]=i[e.M13]*r,t[e.M20]=i[e.M20]*r,t[e.M21]=i[e.M21]*r,t[e.M22]=i[e.M22]*r,t[e.M23]=i[e.M23]*r,t[e.M30]=i[e.M30]*r,t[e.M31]=i[e.M31]*r,t[e.M32]=i[e.M32]*r,t[e.M33]=i[e.M33]*r,this}},{key:"determinant",value:function(){var t=this.values;return t[e.M30]*t[e.M21]*t[e.M12]*t[e.M03]-t[e.M20]*t[e.M31]*t[e.M12]*t[e.M03]-t[e.M30]*t[e.M11]*t[e.M22]*t[e.M03]+t[e.M10]*t[e.M31]*t[e.M22]*t[e.M03]+t[e.M20]*t[e.M11]*t[e.M32]*t[e.M03]-t[e.M10]*t[e.M21]*t[e.M32]*t[e.M03]-t[e.M30]*t[e.M21]*t[e.M02]*t[e.M13]+t[e.M20]*t[e.M31]*t[e.M02]*t[e.M13]+t[e.M30]*t[e.M01]*t[e.M22]*t[e.M13]-t[e.M00]*t[e.M31]*t[e.M22]*t[e.M13]-t[e.M20]*t[e.M01]*t[e.M32]*t[e.M13]+t[e.M00]*t[e.M21]*t[e.M32]*t[e.M13]+t[e.M30]*t[e.M11]*t[e.M02]*t[e.M23]-t[e.M10]*t[e.M31]*t[e.M02]*t[e.M23]-t[e.M30]*t[e.M01]*t[e.M12]*t[e.M23]+t[e.M00]*t[e.M31]*t[e.M12]*t[e.M23]+t[e.M10]*t[e.M01]*t[e.M32]*t[e.M23]-t[e.M00]*t[e.M11]*t[e.M32]*t[e.M23]-t[e.M20]*t[e.M11]*t[e.M02]*t[e.M33]+t[e.M10]*t[e.M21]*t[e.M02]*t[e.M33]+t[e.M20]*t[e.M01]*t[e.M12]*t[e.M33]-t[e.M00]*t[e.M21]*t[e.M12]*t[e.M33]-t[e.M10]*t[e.M01]*t[e.M22]*t[e.M33]+t[e.M00]*t[e.M11]*t[e.M22]*t[e.M33]}},{key:"translate",value:function(t,i,n){var r=this.values;return r[e.M03]+=t,r[e.M13]+=i,r[e.M23]+=n,this}},{key:"copy",value:function(){return(new t).set(this.values)}},{key:"projection",value:function(t,i,n,r){this.identity();var s=1/Math.tan(n*(Math.PI/180)/2),o=(i+t)/(t-i),a=2*i*t/(t-i),h=this.values;return h[e.M00]=s/r,h[e.M10]=0,h[e.M20]=0,h[e.M30]=0,h[e.M01]=0,h[e.M11]=s,h[e.M21]=0,h[e.M31]=0,h[e.M02]=0,h[e.M12]=0,h[e.M22]=o,h[e.M32]=-1,h[e.M03]=0,h[e.M13]=0,h[e.M23]=a,h[e.M33]=0,this}},{key:"ortho2d",value:function(t,e,i,n){return this.ortho(t,t+i,e,e+n,0,1)}},{key:"ortho",value:function(t,i,n,r,s,o){this.identity();var a=2/(i-t),h=2/(r-n),u=-2/(o-s),l=-(i+t)/(i-t),c=-(r+n)/(r-n),g=-(o+s)/(o-s),_=this.values;return _[e.M00]=a,_[e.M10]=0,_[e.M20]=0,_[e.M30]=0,_[e.M01]=0,_[e.M11]=h,_[e.M21]=0,_[e.M31]=0,_[e.M02]=0,_[e.M12]=0,_[e.M22]=u,_[e.M32]=0,_[e.M03]=l,_[e.M13]=c,_[e.M23]=g,_[e.M33]=1,this}},{key:"multiply",value:function(t){var i=this.temp,n=this.values,r=t.values;return i[e.M00]=n[e.M00]*r[e.M00]+n[e.M01]*r[e.M10]+n[e.M02]*r[e.M20]+n[e.M03]*r[e.M30],i[e.M01]=n[e.M00]*r[e.M01]+n[e.M01]*r[e.M11]+n[e.M02]*r[e.M21]+n[e.M03]*r[e.M31],i[e.M02]=n[e.M00]*r[e.M02]+n[e.M01]*r[e.M12]+n[e.M02]*r[e.M22]+n[e.M03]*r[e.M32],i[e.M03]=n[e.M00]*r[e.M03]+n[e.M01]*r[e.M13]+n[e.M02]*r[e.M23]+n[e.M03]*r[e.M33],i[e.M10]=n[e.M10]*r[e.M00]+n[e.M11]*r[e.M10]+n[e.M12]*r[e.M20]+n[e.M13]*r[e.M30],i[e.M11]=n[e.M10]*r[e.M01]+n[e.M11]*r[e.M11]+n[e.M12]*r[e.M21]+n[e.M13]*r[e.M31],i[e.M12]=n[e.M10]*r[e.M02]+n[e.M11]*r[e.M12]+n[e.M12]*r[e.M22]+n[e.M13]*r[e.M32],i[e.M13]=n[e.M10]*r[e.M03]+n[e.M11]*r[e.M13]+n[e.M12]*r[e.M23]+n[e.M13]*r[e.M33],i[e.M20]=n[e.M20]*r[e.M00]+n[e.M21]*r[e.M10]+n[e.M22]*r[e.M20]+n[e.M23]*r[e.M30],i[e.M21]=n[e.M20]*r[e.M01]+n[e.M21]*r[e.M11]+n[e.M22]*r[e.M21]+n[e.M23]*r[e.M31],i[e.M22]=n[e.M20]*r[e.M02]+n[e.M21]*r[e.M12]+n[e.M22]*r[e.M22]+n[e.M23]*r[e.M32],i[e.M23]=n[e.M20]*r[e.M03]+n[e.M21]*r[e.M13]+n[e.M22]*r[e.M23]+n[e.M23]*r[e.M33],i[e.M30]=n[e.M30]*r[e.M00]+n[e.M31]*r[e.M10]+n[e.M32]*r[e.M20]+n[e.M33]*r[e.M30],i[e.M31]=n[e.M30]*r[e.M01]+n[e.M31]*r[e.M11]+n[e.M32]*r[e.M21]+n[e.M33]*r[e.M31],i[e.M32]=n[e.M30]*r[e.M02]+n[e.M31]*r[e.M12]+n[e.M32]*r[e.M22]+n[e.M33]*r[e.M32],i[e.M33]=n[e.M30]*r[e.M03]+n[e.M31]*r[e.M13]+n[e.M32]*r[e.M23]+n[e.M33]*r[e.M33],this.set(this.temp)}},{key:"multiplyLeft",value:function(t){var i=this.temp,n=this.values,r=t.values;return i[e.M00]=r[e.M00]*n[e.M00]+r[e.M01]*n[e.M10]+r[e.M02]*n[e.M20]+r[e.M03]*n[e.M30],i[e.M01]=r[e.M00]*n[e.M01]+r[e.M01]*n[e.M11]+r[e.M02]*n[e.M21]+r[e.M03]*n[e.M31],i[e.M02]=r[e.M00]*n[e.M02]+r[e.M01]*n[e.M12]+r[e.M02]*n[e.M22]+r[e.M03]*n[e.M32],i[e.M03]=r[e.M00]*n[e.M03]+r[e.M01]*n[e.M13]+r[e.M02]*n[e.M23]+r[e.M03]*n[e.M33],i[e.M10]=r[e.M10]*n[e.M00]+r[e.M11]*n[e.M10]+r[e.M12]*n[e.M20]+r[e.M13]*n[e.M30],i[e.M11]=r[e.M10]*n[e.M01]+r[e.M11]*n[e.M11]+r[e.M12]*n[e.M21]+r[e.M13]*n[e.M31],i[e.M12]=r[e.M10]*n[e.M02]+r[e.M11]*n[e.M12]+r[e.M12]*n[e.M22]+r[e.M13]*n[e.M32],i[e.M13]=r[e.M10]*n[e.M03]+r[e.M11]*n[e.M13]+r[e.M12]*n[e.M23]+r[e.M13]*n[e.M33],i[e.M20]=r[e.M20]*n[e.M00]+r[e.M21]*n[e.M10]+r[e.M22]*n[e.M20]+r[e.M23]*n[e.M30],i[e.M21]=r[e.M20]*n[e.M01]+r[e.M21]*n[e.M11]+r[e.M22]*n[e.M21]+r[e.M23]*n[e.M31],i[e.M22]=r[e.M20]*n[e.M02]+r[e.M21]*n[e.M12]+r[e.M22]*n[e.M22]+r[e.M23]*n[e.M32],i[e.M23]=r[e.M20]*n[e.M03]+r[e.M21]*n[e.M13]+r[e.M22]*n[e.M23]+r[e.M23]*n[e.M33],i[e.M30]=r[e.M30]*n[e.M00]+r[e.M31]*n[e.M10]+r[e.M32]*n[e.M20]+r[e.M33]*n[e.M30],i[e.M31]=r[e.M30]*n[e.M01]+r[e.M31]*n[e.M11]+r[e.M32]*n[e.M21]+r[e.M33]*n[e.M31],i[e.M32]=r[e.M30]*n[e.M02]+r[e.M31]*n[e.M12]+r[e.M32]*n[e.M22]+r[e.M33]*n[e.M32],i[e.M33]=r[e.M30]*n[e.M03]+r[e.M31]*n[e.M13]+r[e.M32]*n[e.M23]+r[e.M33]*n[e.M33],this.set(this.temp)}},{key:"lookAt",value:function(i,n,r){t.initTemps();var s=t.xAxis,o=t.yAxis,a=t.zAxis;a.setFrom(n).normalize(),s.setFrom(n).normalize(),s.cross(r).normalize(),o.setFrom(s).cross(a).normalize(),this.identity();var h=this.values;return h[e.M00]=s.x,h[e.M01]=s.y,h[e.M02]=s.z,h[e.M10]=o.x,h[e.M11]=o.y,h[e.M12]=o.z,h[e.M20]=-a.x,h[e.M21]=-a.y,h[e.M22]=-a.z,t.tmpMatrix.identity(),t.tmpMatrix.values[e.M03]=-i.x,t.tmpMatrix.values[e.M13]=-i.y,t.tmpMatrix.values[e.M23]=-i.z,this.multiply(t.tmpMatrix),this}}],[{key:"initTemps",value:function(){null===t.xAxis&&(t.xAxis=new s.Vector3),null===t.yAxis&&(t.yAxis=new s.Vector3),null===t.zAxis&&(t.zAxis=new s.Vector3)}}]),t}();e.Matrix4=o,o.xAxis=null,o.yAxis=null,o.zAxis=null,o.tmpMatrix=new o},4731:function(t,e,i){"use strict";var n=i(1655).default,r=i(6389).default,s=i(6690).default,o=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Color2Attribute=e.ColorAttribute=e.TexCoordAttribute=e.Position3Attribute=e.Position2Attribute=e.VertexAttribute=e.VertexAttributeType=e.Mesh=void 0;var a,h=i(6403),u=i(8077),l=function(){function t(e,i,n,r){s(this,t),this.attributes=i,this.verticesLength=0,this.dirtyVertices=!1,this.indicesLength=0,this.dirtyIndices=!1,this.elementsPerVertex=0,this.context=e instanceof u.ManagedWebGLRenderingContext?e:new u.ManagedWebGLRenderingContext(e),this.elementsPerVertex=0;for(var o=0;o<i.length;o++)this.elementsPerVertex+=i[o].numElements;this.vertices=new Float32Array(n*this.elementsPerVertex),this.indices=new Uint16Array(r),this.context.addRestorable(this)}return o(t,[{key:"getAttributes",value:function(){return this.attributes}},{key:"maxVertices",value:function(){return this.vertices.length/this.elementsPerVertex}},{key:"numVertices",value:function(){return this.verticesLength/this.elementsPerVertex}},{key:"setVerticesLength",value:function(t){this.dirtyVertices=!0,this.verticesLength=t}},{key:"getVertices",value:function(){return this.vertices}},{key:"maxIndices",value:function(){return this.indices.length}},{key:"numIndices",value:function(){return this.indicesLength}},{key:"setIndicesLength",value:function(t){this.dirtyIndices=!0,this.indicesLength=t}},{key:"getIndices",value:function(){return this.indices}},{key:"getVertexSizeInFloats",value:function(){for(var t=0,e=0;e<this.attributes.length;e++){t+=this.attributes[e].numElements}return t}},{key:"setVertices",value:function(t){if(this.dirtyVertices=!0,t.length>this.vertices.length)throw Error("Mesh can't store more than "+this.maxVertices()+" vertices");this.vertices.set(t,0),this.verticesLength=t.length}},{key:"setIndices",value:function(t){if(this.dirtyIndices=!0,t.length>this.indices.length)throw Error("Mesh can't store more than "+this.maxIndices()+" indices");this.indices.set(t,0),this.indicesLength=t.length}},{key:"draw",value:function(t,e){this.drawWithOffset(t,e,0,this.indicesLength>0?this.indicesLength:this.verticesLength/this.elementsPerVertex)}},{key:"drawWithOffset",value:function(t,e,i,n){var r=this.context.gl;(this.dirtyVertices||this.dirtyIndices)&&this.update(),this.bind(t),this.indicesLength>0?r.drawElements(e,n,r.UNSIGNED_SHORT,2*i):r.drawArrays(e,i,n),this.unbind(t)}},{key:"bind",value:function(t){var e=this.context.gl;e.bindBuffer(e.ARRAY_BUFFER,this.verticesBuffer);for(var i=0,n=0;n<this.attributes.length;n++){var r=this.attributes[n],s=t.getAttributeLocation(r.name);e.enableVertexAttribArray(s),e.vertexAttribPointer(s,r.numElements,e.FLOAT,!1,4*this.elementsPerVertex,4*i),i+=r.numElements}this.indicesLength>0&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indicesBuffer)}},{key:"unbind",value:function(t){for(var e=this.context.gl,i=0;i<this.attributes.length;i++){var n=this.attributes[i],r=t.getAttributeLocation(n.name);e.disableVertexAttribArray(r)}e.bindBuffer(e.ARRAY_BUFFER,null),this.indicesLength>0&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)}},{key:"update",value:function(){var t=this.context.gl;this.dirtyVertices&&(this.verticesBuffer||(this.verticesBuffer=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,this.verticesBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices.subarray(0,this.verticesLength),t.DYNAMIC_DRAW),this.dirtyVertices=!1),this.dirtyIndices&&(this.indicesBuffer||(this.indicesBuffer=t.createBuffer()),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indicesBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices.subarray(0,this.indicesLength),t.DYNAMIC_DRAW),this.dirtyIndices=!1)}},{key:"restore",value:function(){this.verticesBuffer=null,this.indicesBuffer=null,this.update()}},{key:"dispose",value:function(){this.context.removeRestorable(this);var t=this.context.gl;t.deleteBuffer(this.verticesBuffer),t.deleteBuffer(this.indicesBuffer)}}]),t}();e.Mesh=l,function(t){t[t.Float=0]="Float"}(a=e.VertexAttributeType||(e.VertexAttributeType={}));var c=o((function t(e,i,n){s(this,t),this.name=e,this.type=i,this.numElements=n}));e.VertexAttribute=c;var g=function(t){n(i,t);var e=r(i);function i(){return s(this,i),e.call(this,h.Shader.POSITION,a.Float,2)}return o(i)}(c);e.Position2Attribute=g;var _=function(t){n(i,t);var e=r(i);function i(){return s(this,i),e.call(this,h.Shader.POSITION,a.Float,3)}return o(i)}(c);e.Position3Attribute=_;var f=function(t){n(i,t);var e=r(i);function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return s(this,i),e.call(this,h.Shader.TEXCOORDS+(0===t?"":t),a.Float,2)}return o(i)}(c);e.TexCoordAttribute=f;var d=function(t){n(i,t);var e=r(i);function i(){return s(this,i),e.call(this,h.Shader.COLOR,a.Float,4)}return o(i)}(c);e.ColorAttribute=d;var p=function(t){n(i,t);var e=r(i);function i(){return s(this,i),e.call(this,h.Shader.COLOR2,a.Float,4)}return o(i)}(c);e.Color2Attribute=p},2226:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.NumberUtil=void 0;var s=new Int8Array(4),o=new Int32Array(s.buffer,0,1),a=new Float32Array(s.buffer,0,1),h=function(){function t(){n(this,t)}return r(t,null,[{key:"intBitsToFloat",value:function(t){return o[0]=t,a[0]}},{key:"floatToIntBits",value:function(t){return a[0]=t,o[0]}},{key:"intToFloatColor",value:function(e){return t.intBitsToFloat(4278190079&e)}},{key:"colorToFloat",value:function(e,i,n,r){var s=r<<24|n<<16|i<<8|e;return t.intToFloatColor(s)}},{key:"isPowerOfTwo",value:function(t){return 0===(t&t-1)}},{key:"nextPowerOfTwo",value:function(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)+1}}]),t}();e.NumberUtil=h},2991:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.PolygonBatch=void 0;var s=i(8637),o=i(4731),a=i(6403),h=i(8077),u=[0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0],l=new s.Color(1,1,1,1),c=function(){function t(e){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10920;if(n(this,t),this.isDrawing=!1,this.shader=null,this.lastTexture=null,this.verticesLength=0,this.indicesLength=0,this.projectionValues=new Float32Array(16),this.color=l,this.twoColorTint=!0,this.yDown=!1,r>10920)throw new Error("Can't have more than 10920 triangles per batch: "+r);this.context=e instanceof h.ManagedWebGLRenderingContext?e:new h.ManagedWebGLRenderingContext(e);var s=i?[new o.Position2Attribute,new o.ColorAttribute,new o.TexCoordAttribute,new o.Color2Attribute]:[new o.Position2Attribute,new o.ColorAttribute,new o.TexCoordAttribute];this.mesh=new o.Mesh(e,s,r,3*r),this.shader=a.Shader.newTwoColoredTextured(e);var u=this.context.gl;this.srcColorBlend=u.SRC_ALPHA,this.srcAlphaBlend=u.ONE,this.dstBlend=u.ONE_MINUS_SRC_ALPHA,this.twoColorTint=i}return r(t,[{key:"setColor",value:function(t){this.color=t}},{key:"setShader",value:function(t){this.shader=t}},{key:"setProjection",value:function(t){this.projectionValues=t}},{key:"begin",value:function(){if(this.isDrawing)throw new Error("PolygonBatch is already drawing. Call PolygonBatch.end() before calling PolygonBatch.begin()");this.drawCalls=0;var t=this.shader;this.lastTexture=null,this.isDrawing=!0,t.bind(),t.setUniform4x4f(a.Shader.MVP_MATRIX,this.projectionValues),t.setUniformi("u_texture",0);var e=this.context.gl;e.enable(e.BLEND),e.blendFuncSeparate(this.srcColorBlend,this.dstBlend,this.srcAlphaBlend,this.dstBlend)}},{key:"setBlendMode",value:function(t,e,i){this.srcColorBlend===t&&this.srcAlphaBlend===e&&this.dstBlend===i||(this.srcColorBlend=t,this.srcAlphaBlend=e,this.dstBlend=i,this.isDrawing&&(this.flush(),this.context.gl.blendFuncSeparate(t,i,e,i)))}},{key:"drawVerticesWithOffset",value:function(e,i,n,r){for(var s=[],o=0;o<r;o++)s[o]=i[o+n];this.drawVertices(e,s,t.QUAD_TRIANGLES)}},{key:"drawVertices",value:function(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.QUAD_TRIANGLES;e!==this.lastTexture?(this.flush(),this.lastTexture=e):(this.verticesLength+i.length>this.mesh.getVertices().length||this.indicesLength+n.length>this.mesh.getIndices().length)&&this.flush();var r=this.mesh.numVertices();this.mesh.getVertices().set(i,this.verticesLength),this.verticesLength+=i.length,this.mesh.setVerticesLength(this.verticesLength);for(var s=this.mesh.getIndices(),o=this.indicesLength,a=0;a<n.length;o++,a++)s[o]=n[a]+r;this.indicesLength+=n.length,this.mesh.setIndicesLength(this.indicesLength)}},{key:"flush",value:function(){0!==this.verticesLength&&(this.lastTexture.bind(),this.mesh.draw(this.shader,this.context.gl.TRIANGLES),this.verticesLength=0,this.indicesLength=0,this.mesh.setVerticesLength(0),this.mesh.setIndicesLength(0),this.drawCalls++)}},{key:"end",value:function(){if(!this.isDrawing)throw new Error("PolygonBatch is not drawing. Call PolygonBatch.begin() before calling PolygonBatch.end()");(this.verticesLength>0||this.indicesLength>0)&&this.flush(),this.shader.unbind(),this.lastTexture=null,this.isDrawing=!1;var t=this.context.gl;t.disable(t.BLEND)}},{key:"getDrawCalls",value:function(){return this.drawCalls}},{key:"dispose",value:function(){this.mesh.dispose()}},{key:"setYDown",value:function(t){this.yDown=t}},{key:"draw",value:function(e,i,n,r,s){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,h=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:1,g=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,_=arguments.length>11&&void 0!==arguments[11]?arguments[11]:1,f=arguments.length>12&&void 0!==arguments[12]?arguments[12]:1,d=arguments.length>13&&void 0!==arguments[13]?arguments[13]:0,p=arguments.length>14&&void 0!==arguments[14]&&arguments[14],v=this.color;if(this.yDown){var x=_;_=d,d=x}i=i||0,n=n||0;var y=-o,m=(r=0===r?r:r||e.width)-o,M=r-o,w=-o,b=-a,E=-a,C=(s=0===s?s:s||e.height)-a,k=s-a;if(1!==l&&(y*=l,m*=l,M*=l,w*=l),1!==c&&(b*=c,E*=c,C*=c,k*=c),0!==h){var P=Math.cos(h),S=Math.sin(h),L=P*y-S*b,T=S*y+P*b,V=P*m-S*E,A=S*m+P*E,F=P*M-S*C,O=S*M+P*C,R=P*w-S*k,I=S*w+P*k;y=L,m=V,M=F,w=R,b=T,E=A,C=O,k=I}y+=i+o,m+=i+o,M+=i+o,w+=i+o,b+=n+a,E+=n+a,C+=n+a,k+=n+a;var D=g,N=_,j=f,G=d,X=j,B=N,Y=D,W=G;p&&(this.yDown?(D=g,N=d,j=f,G=_,X=g,B=_,Y=f,W=d):(D=f,N=_,j=g,G=d,X=f,B=d,Y=g,W=_));var U=0;u[U++]=y,u[U++]=b,u[U++]=v.r,u[U++]=v.g,u[U++]=v.b,u[U++]=v.a,u[U++]=D,u[U++]=N,this.twoColorTint&&(u[U++]=0,u[U++]=0,u[U++]=0,u[U++]=0),u[U++]=m,u[U++]=E,u[U++]=v.r,u[U++]=v.g,u[U++]=v.b,u[U++]=v.a,u[U++]=X,u[U++]=B,this.twoColorTint&&(u[U++]=0,u[U++]=0,u[U++]=0,u[U++]=0),u[U++]=M,u[U++]=C,u[U++]=v.r,u[U++]=v.g,u[U++]=v.b,u[U++]=v.a,u[U++]=j,u[U++]=G,this.twoColorTint&&(u[U++]=0,u[U++]=0,u[U++]=0,u[U++]=0),u[U++]=w,u[U++]=k,u[U++]=v.r,u[U++]=v.g,u[U++]=v.b,u[U++]=v.a,u[U++]=Y,u[U++]=W,this.twoColorTint&&(u[U++]=0,u[U++]=0,u[U++]=0,u[U]=0),this.drawVertices(e,u,t.QUAD_TRIANGLES)}}]),t}();e.PolygonBatch=c,c.QUAD_TRIANGLES=[0,1,2,2,3,0]},6403:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Shader=void 0;var s=i(8077),o=function(){function t(e,i,r){n(this,t),this.vertexShader=i,this.fragmentShader=r,this.vs=null,this.fs=null,this.program=null,this.tmp2x2=new Float32Array(4),this.tmp3x3=new Float32Array(9),this.tmp4x4=new Float32Array(16),this.vsSource=i,this.fsSource=r,this.context=e instanceof s.ManagedWebGLRenderingContext?e:new s.ManagedWebGLRenderingContext(e),this.context.addRestorable(this),this.compile()}return r(t,[{key:"getProgram",value:function(){return this.program}},{key:"getVertexShader",value:function(){return this.vertexShader}},{key:"getFragmentShader",value:function(){return this.fragmentShader}},{key:"getVertexShaderSource",value:function(){return this.vsSource}},{key:"getFragmentSource",value:function(){return this.fsSource}},{key:"compile",value:function(){var t=this.context.gl;try{this.vs=this.compileShader(t.VERTEX_SHADER,this.vertexShader),this.fs=this.compileShader(t.FRAGMENT_SHADER,this.fragmentShader),this.program=this.compileProgram(this.vs,this.fs)}catch(e){throw this.dispose(),e}}},{key:"compileShader",value:function(t,e){var i=this.context.gl,n=i.createShader(t);if(i.shaderSource(n,e),i.compileShader(n),!i.getShaderParameter(n,i.COMPILE_STATUS)){var r="Couldn't compile shader: "+i.getShaderInfoLog(n);if(i.deleteShader(n),!i.isContextLost())throw new Error(r)}return n}},{key:"compileProgram",value:function(t,e){var i=this.context.gl,n=i.createProgram();if(i.attachShader(n,t),i.attachShader(n,e),i.linkProgram(n),!i.getProgramParameter(n,i.LINK_STATUS)){var r="Couldn't compile shader program: "+i.getProgramInfoLog(n);if(i.deleteProgram(n),!i.isContextLost())throw new Error(r)}return n}},{key:"restore",value:function(){this.compile()}},{key:"bind",value:function(){this.context.gl.useProgram(this.program)}},{key:"unbind",value:function(){this.context.gl.useProgram(null)}},{key:"setUniformi",value:function(t,e){this.context.gl.uniform1i(this.getUniformLocation(t),e)}},{key:"setUniformf",value:function(t,e){this.context.gl.uniform1f(this.getUniformLocation(t),e)}},{key:"setUniform2f",value:function(t,e,i){this.context.gl.uniform2f(this.getUniformLocation(t),e,i)}},{key:"setUniform3f",value:function(t,e,i,n){this.context.gl.uniform3f(this.getUniformLocation(t),e,i,n)}},{key:"setUniform4f",value:function(t,e,i,n,r){this.context.gl.uniform4f(this.getUniformLocation(t),e,i,n,r)}},{key:"setUniform2x2f",value:function(t,e){var i=this.context.gl;this.tmp2x2.set(e),i.uniformMatrix2fv(this.getUniformLocation(t),!1,this.tmp2x2)}},{key:"setUniform3x3f",value:function(t,e){var i=this.context.gl;this.tmp3x3.set(e),i.uniformMatrix3fv(this.getUniformLocation(t),!1,this.tmp3x3)}},{key:"setUniform4x4f",value:function(t,e){var i=this.context.gl;this.tmp4x4.set(e),i.uniformMatrix4fv(this.getUniformLocation(t),!1,this.tmp4x4)}},{key:"getUniformLocation",value:function(t){var e=this.context.gl,i=e.getUniformLocation(this.program,t);if(!i&&!e.isContextLost())throw new Error("Couldn't find location for uniform ".concat(t));return i}},{key:"getAttributeLocation",value:function(t){var e=this.context.gl,i=e.getAttribLocation(this.program,t);if(-1===i&&!e.isContextLost())throw new Error("Couldn't find location for attribute ".concat(t));return i}},{key:"dispose",value:function(){this.context.removeRestorable(this);var t=this.context.gl;this.vs&&(t.deleteShader(this.vs),this.vs=null),this.fs&&(t.deleteShader(this.fs),this.fs=null),this.program&&(t.deleteProgram(this.program),this.program=null)}}],[{key:"newColoredTextured",value:function(e){return new t(e,"\n         attribute vec4 ".concat(t.POSITION,";\n         attribute vec4 ").concat(t.COLOR,";\n         attribute vec2 ").concat(t.TEXCOORDS,";\n         uniform mat4 ").concat(t.MVP_MATRIX,";\n         varying vec4 v_color;\n         varying vec2 v_texCoords;\n \n         void main () {\n           v_color = ").concat(t.COLOR,";\n           v_texCoords = ").concat(t.TEXCOORDS,";\n           gl_Position = ").concat(t.MVP_MATRIX," * ").concat(t.POSITION,";\n         }\n       "),"\n         #ifdef GL_ES\n           #define LOWP lowp\n           precision mediump float;\n         #else\n           #define LOWP\n         #endif\n         varying LOWP vec4 v_color;\n         varying vec2 v_texCoords;\n         uniform sampler2D u_texture;\n \n         void main () {\n           gl_FragColor = v_color * texture2D(u_texture, v_texCoords);\n         }\n       ")}},{key:"newTwoColoredTextured",value:function(e){return new t(e,"\n         attribute vec4 ".concat(t.POSITION,";\n         attribute vec4 ").concat(t.COLOR,";\n         attribute vec4 ").concat(t.COLOR2,";\n         attribute vec2 ").concat(t.TEXCOORDS,";\n         uniform mat4 ").concat(t.MVP_MATRIX,";\n         varying vec4 v_light;\n         varying vec4 v_dark;\n         varying vec2 v_texCoords;\n \n         void main () {\n           v_light = ").concat(t.COLOR,";\n           v_dark = ").concat(t.COLOR2,";\n           v_texCoords = ").concat(t.TEXCOORDS,";\n           gl_Position = ").concat(t.MVP_MATRIX," * ").concat(t.POSITION,";\n         }\n       "),"\n         #ifdef GL_ES\n           #define LOWP lowp\n           precision mediump float;\n         #else\n           #define LOWP\n         #endif\n         varying LOWP vec4 v_light;\n         varying LOWP vec4 v_dark;\n         varying vec2 v_texCoords;\n         uniform sampler2D u_texture;\n \n         void main () {\n           vec4 texColor = texture2D(u_texture, v_texCoords);\n           gl_FragColor.a = texColor.a * v_light.a;\n           gl_FragColor.rgb = ((texColor.a - 1.0) * v_dark.a + 1.0 - texColor.rgb) * v_dark.rgb + texColor.rgb * v_light.rgb;\n         }\n       ")}},{key:"newColored",value:function(e){return new t(e,"\n         attribute vec4 ".concat(t.POSITION,";\n         attribute vec4 ").concat(t.COLOR,";\n         uniform mat4 ").concat(t.MVP_MATRIX,";\n         varying vec4 v_color;\n \n         void main () {\n           v_color = ").concat(t.COLOR,";\n           gl_Position = ").concat(t.MVP_MATRIX," * ").concat(t.POSITION,";\n         }\n       "),"\n         #ifdef GL_ES\n           #define LOWP lowp\n           precision mediump float;\n         #else\n           #define LOWP\n         #endif\n         varying LOWP vec4 v_color;\n \n         void main () {\n           gl_FragColor = v_color;\n         }\n       ")}}]),t}();e.Shader=o,o.MVP_MATRIX="u_projTrans",o.POSITION="a_position",o.COLOR="a_color",o.COLOR2="a_color2",o.TEXCOORDS="a_texCoords",o.SAMPLER="u_texture"},2438:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.ShapeRenderer=e.ShapeType=void 0;var s,o=i(4731),a=i(6403),h=i(8637),u=i(3192),l=i(8077);!function(t){t[t.Point=0]="Point",t[t.Line=1]="Line",t[t.Filled=4]="Filled"}(s=e.ShapeType||(e.ShapeType={}));var c=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10920;if(n(this,t),this.isDrawing=!1,this.shapeType=s.Filled,this.color=new h.Color(1,1,1,1),this.vertexIndex=0,this.tmp=new u.Vector2,this.projectionValues=new Float32Array(16),i>10920)throw new Error("Can't have more than 10920 triangles per batch: "+i);this.context=e instanceof l.ManagedWebGLRenderingContext?e:new l.ManagedWebGLRenderingContext(e),this.mesh=new o.Mesh(e,[new o.Position2Attribute,new o.ColorAttribute],i,0);var r=this.context.gl;this.srcColorBlend=r.SRC_ALPHA,this.srcAlphaBlend=r.ONE,this.dstBlend=r.ONE_MINUS_SRC_ALPHA,this.shader=a.Shader.newColored(r)}return r(t,[{key:"setProjection",value:function(t){this.projectionValues=t}},{key:"begin",value:function(){if(this.isDrawing)throw new Error("ShapeRenderer.begin() has already been called");this.vertexIndex=0,this.isDrawing=!0,this.shader.bind(),this.shader.setUniform4x4f(a.Shader.MVP_MATRIX,this.projectionValues);var t=this.context.gl;t.enable(t.BLEND),t.blendFuncSeparate(this.srcColorBlend,this.dstBlend,this.srcAlphaBlend,this.dstBlend)}},{key:"setBlendMode",value:function(t,e,i){(this.srcColorBlend=t,this.srcAlphaBlend=e,this.dstBlend=i,this.isDrawing)&&(this.flush(),this.context.gl.blendFuncSeparate(t,i,e,i))}},{key:"setColor",value:function(t){this.color.setFromColor(t)}},{key:"setColorWith",value:function(t,e,i,n){this.color.set(t,e,i,n)}},{key:"point",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.check(s.Point,1),null===i&&(i=this.color),this.vertex(t,e,i)}},{key:"line",value:function(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.check(s.Line,2),null===r&&(r=this.color),this.vertex(t,e,r),this.vertex(i,n,r)}},{key:"triangle",value:function(t,e,i,n,r,o,a){var h=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null;this.check(t?s.Filled:s.Line,3),null===h&&(h=this.color),null===u&&(u=this.color),null===l&&(l=this.color),t?(this.vertex(e,i,h),this.vertex(n,r,u),this.vertex(o,a,l)):(this.vertex(e,i,h),this.vertex(n,r,u),this.vertex(n,r,h),this.vertex(o,a,u),this.vertex(o,a,h),this.vertex(e,i,u))}},{key:"quad",value:function(t,e,i,n,r,o,a,h,u){var l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,c=arguments.length>10&&void 0!==arguments[10]?arguments[10]:null,g=arguments.length>11&&void 0!==arguments[11]?arguments[11]:null,_=arguments.length>12&&void 0!==arguments[12]?arguments[12]:null;this.check(t?s.Filled:s.Line,3),null===l&&(l=this.color),null===c&&(c=this.color),null===g&&(g=this.color),null===_&&(_=this.color),t?(this.vertex(e,i,l),this.vertex(n,r,c),this.vertex(o,a,g),this.vertex(o,a,g),this.vertex(h,u,_),this.vertex(e,i,l)):(this.vertex(e,i,l),this.vertex(n,r,c),this.vertex(n,r,c),this.vertex(o,a,g),this.vertex(o,a,g),this.vertex(h,u,_),this.vertex(h,u,_),this.vertex(e,i,l))}},{key:"rect",value:function(t,e,i,n,r){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;this.quad(t,e,i,e+n,i,e+n,i+r,e,i+r,s,s,s,s)}},{key:"rectLine",value:function(t,e,i,n,r,o){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.check(t?s.Filled:s.Line,8),null===a&&(a=this.color);var h=this.tmp.set(r-i,e-n);h.nor(),o*=.5;var u=h.x*o,l=h.y*o;t?(this.vertex(e+u,i+l,a),this.vertex(e-u,i-l,a),this.vertex(n+u,r+l,a),this.vertex(n-u,r-l,a),this.vertex(n+u,r+l,a),this.vertex(e-u,i-l,a)):(this.vertex(e+u,i+l,a),this.vertex(e-u,i-l,a),this.vertex(n+u,r+l,a),this.vertex(n-u,r-l,a),this.vertex(n+u,r+l,a),this.vertex(e+u,i+l,a),this.vertex(n-u,r-l,a),this.vertex(e-u,i-l,a))}},{key:"x",value:function(t,e,i){this.line(t-i,e-i,t+i,e+i),this.line(t-i,e+i,t+i,e-i)}},{key:"polygon",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(i<3)throw new Error("Polygon must contain at least 3 vertices");this.check(s.Line,2*i),null===n&&(n=this.color),i<<=1;for(var r=t[e<<=1],o=t[e+1],a=e+i,h=e,u=e+i-2;h<u;h+=2){var l=t[h],c=t[h+1],g=0,_=0;h+2>=a?(g=r,_=o):(g=t[h+2],_=t[h+3]),this.vertex(l,c,n),this.vertex(g,_,n)}}},{key:"circle",value:function(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(0===o&&(o=Math.max(1,6*h.MathUtils.cbrt(n)|0)),o<=0)throw new Error("segments must be > 0.");null===r&&(r=this.color);var a=2*h.MathUtils.PI/o,u=Math.cos(a),l=Math.sin(a),c=n,g=0;if(t){this.check(s.Filled,3*o+3),o--;for(var _=0;_<o;_++){this.vertex(e,i,r),this.vertex(e+c,i+g,r);var f=c;c=u*c-l*g,g=l*f+u*g,this.vertex(e+c,i+g,r)}this.vertex(e,i,r),this.vertex(e+c,i+g,r)}else{this.check(s.Line,2*o+2);for(var d=0;d<o;d++){this.vertex(e+c,i+g,r);var p=c;c=u*c-l*g,g=l*p+u*g,this.vertex(e+c,i+g,r)}this.vertex(e+c,i+g,r)}c=n,g=0,this.vertex(e+c,i+g,r)}},{key:"curve",value:function(t,e,i,n,r,o,a,h,u){var l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null;this.check(s.Line,2*u+2),null===l&&(l=this.color);for(var c=1/u,g=c*c,_=c*c*c,f=3*c,d=3*g,p=6*g,v=6*_,x=t-2*i+r,y=e-2*n+o,m=3*(i-r)-t+a,M=3*(n-o)-e+h,w=t,b=e,E=(i-t)*f+x*d+m*_,C=(n-e)*f+y*d+M*_,k=x*p+m*v,P=y*p+M*v,S=m*v,L=M*v;u-- >0;)this.vertex(w,b,l),w+=E,b+=C,E+=k,C+=P,k+=S,P+=L,this.vertex(w,b,l);this.vertex(w,b,l),this.vertex(a,h,l)}},{key:"vertex",value:function(t,e,i){var n=this.vertexIndex,r=this.mesh.getVertices();r[n++]=t,r[n++]=e,r[n++]=i.r,r[n++]=i.g,r[n++]=i.b,r[n++]=i.a,this.vertexIndex=n}},{key:"end",value:function(){if(!this.isDrawing)throw new Error("ShapeRenderer.begin() has not been called");this.flush();var t=this.context.gl;t.disable(t.BLEND),this.isDrawing=!1}},{key:"flush",value:function(){0!==this.vertexIndex&&(this.mesh.setVerticesLength(this.vertexIndex),this.mesh.draw(this.shader,this.shapeType),this.vertexIndex=0)}},{key:"check",value:function(t,e){if(!this.isDrawing)throw new Error("ShapeRenderer.begin() has not been called");if(this.shapeType===t){if(!(this.mesh.maxVertices()-this.mesh.numVertices()<e))return;this.flush()}else this.flush(),this.shapeType=t}},{key:"dispose",value:function(){this.mesh.dispose()}}]),t}();e.ShapeRenderer=c},9805:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Sprite=void 0;var s=i(8637),o=i(3192),a=function(){function t(e){n(this,t),this.region=e,this.dirty=!1,this.position=new o.Vector2(0,0),this.size=new o.Vector2(0,0),this.origin=new o.Vector2(0,0),this.scale=new o.Vector2(1,1),this.color=new s.Color(1,1,1,1),this.rotation=0,this.vertices=new Float32Array(48),this.bounds={x:0,y:0,width:0,height:0},this.setSize(e.width,e.height),this.setOrigin(e.width/2,e.height/2)}return r(t,[{key:"set",value:function(t){this.region=t.region,this.position.setVector(t.position),this.size.setVector(t.size),this.origin.setVector(t.origin),this.rotation=t.rotation,this.scale.setVector(t.scale),this.color.setFromColor(t.color),this.dirty=!0}},{key:"setBounds",value:function(t,e,i,n){this.setPosition(t,e),this.setSize(t,e),this.dirty=!0}},{key:"setSize",value:function(t,e){this.size.set(t,e),this.dirty=!0}},{key:"setPosition",value:function(t,e){this.position.set(t,e),this.dirty=!0}},{key:"setOriginBasedPosition",value:function(t,e){this.setPosition(t-this.origin.x,e-this.origin.y)}},{key:"setX",value:function(t){this.position.x=t,this.dirty=!0}},{key:"setY",value:function(t){this.position.y=t,this.dirty=!0}},{key:"setCenterX",value:function(t){this.setX(t-this.size.x/2)}},{key:"setCenterY",value:function(t){this.setY(t-this.size.y/2)}},{key:"setCenter",value:function(t,e){this.setPosition(t-this.size.x/2,e-this.size.y/2)}},{key:"translateX",value:function(t){this.translate(t,0)}},{key:"translateY",value:function(t){this.translate(0,t)}},{key:"translate",value:function(t,e){this.position.add(t,e),this.dirty=!0}},{key:"setColor",value:function(t){this.color.setFromColor(t),this.dirty=!0}},{key:"setAlpha",value:function(t){this.color.a=t,this.dirty=!0}},{key:"setOrigin",value:function(t,e){this.origin.set(t,e),this.dirty=!0}},{key:"setOriginCenter",value:function(){this.origin.set(this.size.x/2,this.size.y/2),this.dirty=!0}},{key:"setRotation",value:function(t){this.rotation=t,this.dirty=!0}},{key:"getRotation",value:function(){return this.rotation}},{key:"rotate",value:function(t){0!==t&&(this.rotation+=t,this.dirty=!0)}},{key:"setScale",value:function(t,e){this.scale.set(t,e),this.dirty=!0}},{key:"applyScale",value:function(t){this.scale.scale(t),this.dirty=!0}},{key:"getVertices",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.vertices,i=this.region;if(!this.dirty)return e;var n=this.position.x,r=this.position.y,s=this.size.x,o=this.size.y,a=this.origin.x,h=this.origin.y,u=this.rotation,l=this.scale.x,c=this.scale.y,g=i.u,_=i.v,f=i.u2,d=i.v2,p=this.color,v=i.rotated,x=s/i.originalWidth,y=o/i.originalHeight,m=i.width*x,M=i.height*y,w=n+i.offsetX*x;if(n=w,r=t?r+o-i.offsetY*y-M:r+i.offsetY*y,t){var b=_;_=d,d=b}var E=-a,C=(s=m)-a,k=s-a,P=-a,S=-h,L=-h,T=(o=M)-h,V=o-h;if(1!==l&&(E*=l,C*=l,k*=l,P*=l),1!==c&&(S*=c,L*=c,T*=c,V*=c),0!==u){var A=Math.cos(u),F=Math.sin(u),O=A*E-F*S,R=F*E+A*S,I=A*C-F*L,D=F*C+A*L,N=A*k-F*T,j=F*k+A*T,G=A*P-F*V,X=F*P+A*V;E=O,C=I,k=N,P=G,S=R,L=D,T=j,V=X}E+=n+a,C+=n+a,k+=n+a,P+=n+a,S+=r+h,L+=r+h,T+=r+h,V+=r+h;var B=g,Y=_,W=f,U=d,H=W,z=Y,q=B,K=U;v&&(t?(B=g,Y=d,W=f,U=_,H=g,z=_,q=f,K=d):(B=f,Y=_,W=g,U=d,H=f,z=d,q=g,K=_));var Z=0;return e[Z++]=E,e[Z++]=S,e[Z++]=p.r,e[Z++]=p.g,e[Z++]=p.b,e[Z++]=p.a,e[Z++]=B,e[Z++]=Y,e[Z++]=0,e[Z++]=0,e[Z++]=0,e[Z++]=0,e[Z++]=C,e[Z++]=L,e[Z++]=p.r,e[Z++]=p.g,e[Z++]=p.b,e[Z++]=p.a,e[Z++]=H,e[Z++]=z,e[Z++]=0,e[Z++]=0,e[Z++]=0,e[Z++]=0,e[Z++]=k,e[Z++]=T,e[Z++]=p.r,e[Z++]=p.g,e[Z++]=p.b,e[Z++]=p.a,e[Z++]=W,e[Z++]=U,e[Z++]=0,e[Z++]=0,e[Z++]=0,e[Z++]=0,e[Z++]=P,e[Z++]=V,e[Z++]=p.r,e[Z++]=p.g,e[Z++]=p.b,e[Z++]=p.a,e[Z++]=q,e[Z++]=K,e[Z++]=0,e[Z++]=0,e[Z++]=0,e[Z]=0,e}},{key:"getBoundingRectangle",value:function(){var t=this.vertices,e=t[0],i=t[1],n=t[0],r=t[1];return e=(e=(e=e>t[12]?t[12]:e)>t[24]?t[24]:e)>t[36]?t[36]:e,n=(n=(n=n<t[12]?t[12]:n)<t[24]?t[24]:n)<t[36]?t[36]:n,i=(i=(i=i>t[13]?t[13]:i)>t[25]?t[25]:i)>t[37]?t[37]:i,r=(r=(r=r<t[13]?t[13]:r)<t[25]?t[25]:r)<t[37]?t[37]:r,this.bounds.x=e,this.bounds.y=i,this.bounds.width=n-e,this.bounds.height=r-i,this.bounds}},{key:"draw",value:function(t){t.drawVertices(this.region.texture,this.getVertices(t.yDown))}},{key:"drawWithAlpha",value:function(t,e){var i=this.getColor().a;this.setAlpha(i*e),this.draw(t),this.setAlpha(i)}},{key:"getX",value:function(){return this.position.x}},{key:"getY",value:function(){return this.position.y}},{key:"getWidth",value:function(){return this.size.x}},{key:"getHeight",value:function(){return this.size.y}},{key:"getOriginX",value:function(){return this.origin.x}},{key:"getOriginY",value:function(){return this.origin.y}},{key:"getScaleX",value:function(){return this.scale.x}},{key:"getScaleY",value:function(){return this.scale.y}},{key:"getColor",value:function(){return this.color}}]),t}();e.Sprite=a},3432:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Texture=e.TextureWrap=e.TextureFilter=void 0;var s,o=i(8077);!function(t){t[t.Nearest=9728]="Nearest",t[t.Linear=9729]="Linear",t[t.MipMap=9987]="MipMap",t[t.MipMapNearestNearest=9984]="MipMapNearestNearest",t[t.MipMapLinearNearest=9985]="MipMapLinearNearest",t[t.MipMapNearestLinear=9986]="MipMapNearestLinear",t[t.MipMapLinearLinear=9987]="MipMapLinearLinear"}(s=e.TextureFilter||(e.TextureFilter={})),function(t){t[t.MirroredRepeat=33648]="MirroredRepeat",t[t.ClampToEdge=33071]="ClampToEdge",t[t.Repeat=10497]="Repeat"}(e.TextureWrap||(e.TextureWrap={}));var a=function(){function t(e,i){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n(this,t),this.texture=null,this.boundUnit=0,this.useMipMaps=!1,this.width=0,this.height=0,this._image=i,this.context=e instanceof o.ManagedWebGLRenderingContext?e:new o.ManagedWebGLRenderingContext(e),this.useMipMaps=r,this.restore(),this.context.addRestorable(this),this.width=i.width,this.height=i.height}return r(t,[{key:"getImage",value:function(){return this._image}},{key:"setFilters",value:function(e,i){var n=this.context.gl;this.bind(),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,t.validateMagFilter(i))}},{key:"setWraps",value:function(t,e){var i=this.context.gl;this.bind(),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,e)}},{key:"update",value:function(e){var i=this.context.gl;this.texture||(this.texture=this.context.gl.createTexture()),this.bind(),t.DISABLE_UNPACK_PREMULTIPLIED_ALPHA_WEBGL&&i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,this._image),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,e?i.LINEAR_MIPMAP_LINEAR:i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),e&&i.generateMipmap(i.TEXTURE_2D)}},{key:"restore",value:function(){this.texture=null,this.update(this.useMipMaps)}},{key:"bind",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.context.gl;this.boundUnit=t,e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,this.texture)}},{key:"unbind",value:function(){var t=this.context.gl;t.activeTexture(t.TEXTURE0+this.boundUnit),t.bindTexture(t.TEXTURE_2D,null)}},{key:"dispose",value:function(){this.context.removeRestorable(this),this.context.gl.deleteTexture(this.texture)}}],[{key:"load",value:function(e,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise((function(r){var s=new Image;s.onload=function(){r(new t(e,s,n))},s.src=i}))}},{key:"validateMagFilter",value:function(t){switch(t){case s.MipMap:case s.MipMapLinearLinear:case s.MipMapLinearNearest:case s.MipMapNearestLinear:case s.MipMapNearestNearest:return s.Linear;default:return t}}}]),t}();e.Texture=a,a.DISABLE_UNPACK_PREMULTIPLIED_ALPHA_WEBGL=!1},8143:function(t,e,i){"use strict";var n=i(7061).default,r=i(7424).default,s=i(4704).default,o=i(6690).default,a=i(9728).default,h=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function o(t){try{h(n.next(t))}catch(e){s(e)}}function a(t){try{h(n.throw(t))}catch(e){s(e)}}function h(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.TextureAtlas=void 0;var u=i(3432),l=i(8026);function c(t,e){for(var i=t.split("/"),n=e.split("/"),r=[],s=0,o=i.length;s<o;s++)if(".."===i[s])r.pop();else{if("."===i[s])continue;r.push(i[s])}for(var a=0,h=n.length;a<h;a++)if(".."===n[a])r.pop();else{if("."===n[a])continue;r.push(n[a])}return r.join("/")}var g=function(){function t(e,i){o(this,t),this.pages=e,this.regions=i}return a(t,[{key:"dispose",value:function(){var t,e=s(this.pages);try{for(e.s();!(t=e.n()).done;){t.value.dispose()}}catch(i){e.e(i)}finally{e.f()}}},{key:"getPages",value:function(){return this.pages}},{key:"getRegions",value:function(){return this.regions}},{key:"findRegion",value:function(t,e){for(var i=0;i<this.regions.length;i++){var n=this.regions[i];if(n.name===t&&(void 0===e||n.index===e))return n}return null}},{key:"findRegions",value:function(t){return this.regions.filter((function(e){return e.name===t})).sort((function(t,e){return t.index-e.index}))}}],[{key:"load",value:function(e,i,s){return h(this,void 0,void 0,n().mark((function o(){var a,h,g,_,f,d,p,v,x,y,m,M,w,b,E,C,k,P,S,L,T,V,A,F,O,R,I,D,N,j,G,X,B,Y,W,U,H,z,q,K,Z;return n().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch(i).then((function(t){return t.text()}));case 2:a=n.sent,h=[],g=[],_=[],d=a.split("\n"),p=0;case 8:if(void 0!==(x=d[p])){n.next=12;break}return n.abrupt("break",16);case 12:0===x.trim().length?f=null:null===f?(y=c(i,"../".concat(x)),p++,x=d[p],v=x.split(":")[1].split(",").map((function(t){return t.trim()})),m=parseInt(v[0],10),M=parseInt(v[1],10),p++,x=d[p],v=x.split(":")[1].split(",").map((function(t){return t.trim()})),w=v[0],p++,x=d[p],v=x.split(":")[1].split(",").map((function(t){return t.trim()})),b=r(v,2),E=b[0],C=b[1],p++,x=d[p],v=x.split(":")[1].split(",").map((function(t){return t.trim()})),k=v[0],P=u.TextureWrap.ClampToEdge,S=u.TextureWrap.ClampToEdge,"x"===k?P=u.TextureWrap.Repeat:"y"===k?S=u.TextureWrap.Repeat:"xy"===k&&(P=u.TextureWrap.Repeat,S=u.TextureWrap.Repeat),f={file:y,width:m,height:M,format:w,mipMaps:"Nearest"!==E&&"Linear"!==E,min:E,max:C,direction:k,repeatX:P,repeatY:S},h.push(f)):(L=x,p++,x=d[p],v=x.split(":")[1].split(",").map((function(t){return t.trim()})),T="true"===v[0],p++,x=d[p],v=x.split(":")[1].split(",").map((function(t){return t.trim()})),V=parseInt(v[0],10),A=parseInt(v[1],10),p++,x=d[p],v=x.split(":")[1].split(",").map((function(t){return t.trim()})),F=parseInt(v[0],10),O=parseInt(v[1],10),R={name:L,rotate:T,left:V,top:A,width:F,height:O,page:f},p++,x=d[p],4===(v=x.split(":")[1].split(",").map((function(t){return t.trim()}))).length&&(R.splits=v.map((function(t){return parseInt(t,10)})),p++,x=d[p],4===(v=x.split(":")[1].split(",").map((function(t){return t.trim()}))).length&&(R.pads=v.map((function(t){return parseInt(t,10)})),p++,x=d[p],v=x.split(":")[1].split(",").map((function(t){return t.trim()})))),R.originalWidth=parseInt(v[0],10),R.originalHeight=parseInt(v[1],10),p++,x=d[p],v=x.split(":")[1].split(",").map((function(t){return t.trim()})),R.offsetX=parseInt(v[0],10),R.offsetY=parseInt(v[1],10),p++,x=d[p],v=x.split(":")[1].split(",").map((function(t){return t.trim()})),R.index=parseInt(v[0],10),_.push(R)),p++,n.next=8;break;case 16:I=0,D=h;case 17:if(!(I<D.length)){n.next=27;break}return N=D[I],n.next=21,u.Texture.load(e,N.file,s);case 21:N.texture=n.sent,N.invTexWidth=1/N.texture.width,N.invTexHeight=1/N.texture.height;case 24:I++,n.next=17;break;case 27:for(j=[],G=0,X=_;G<X.length;G++)B=X[G],Y=B.left,W=B.top,U=B.rotate?B.height:B.width,H=B.rotate?B.width:B.height,z=B.page,q=z.texture,K=z.invTexWidth,Z=z.invTexHeight,j.push(new l.TextureRegion(q,Y,W,U,H,B,K,Z,B.rotate));return n.abrupt("return",new t(g,j));case 30:case"end":return n.stop()}}),o)})))}}]),t}();e.TextureAtlas=g},8026:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.TextureRegion=void 0;var s=function(){function t(e,i,r,s,o,a,h,u){var l=arguments.length>8&&void 0!==arguments[8]&&arguments[8];n(this,t),this.name=null,this.index=0,this.texture=null,this.regionX=0,this.regionY=0,this.width=0,this.height=0,this.invTexWidth=0,this.invTexHeight=0,this.originalWidth=0,this.originalHeight=0,this.offsetX=0,this.offsetY=0,this.u=0,this.v=0,this.u2=0,this.v2=0,this.rotated=!1,h&&u||(h=1/e.width,u=1/e.height);var c=i*h,g=(r+o)*u,_=(i+s)*h,f=r*u;for(var d in this.texture=e,this.regionX=i,this.regionY=r,this.width=s,this.height=o,this.originalWidth=s,this.originalHeight=o,this.offsetX=0,this.offsetY=0,this.u=c,this.v=g,this.u2=_,this.v2=f,this.rotated=l,a)this[d]=a[d]}return r(t,[{key:"draw",value:function(t,e,i,n,r){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:1,l=this.originalWidth,c=this.originalHeight,g=this.offsetX,_=this.offsetY,f=this.width,d=this.height,p=n/l,v=r/c,x=f*p,y=d*v,m=e+g*p,M=0;s-=m-e,o-=(M=t.yDown?i+r-_*v-y:i+_*v)-i,t.draw(this.texture,m,M,x,y,s,o,a,h,u,this.u,this.v,this.u2,this.v2,this.rotated)}}],[{key:"splitTexture",value:function(e,i,n){for(var r=e.width/i,s=e.height/n,o=[],a=0;a<n;a++)for(var h=0;h<i;h++)o.push(new t(e,h*r,a*s,r,s,{}));return o}}]),t}();e.TextureRegion=s},8637:function(t,e,i){"use strict";var n,r=i(1655).default,s=i(6389).default,o=i(6690).default,a=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.copyArray=e.createStage=e.pointInRect=e.resizeCanvas=e.createGameLoop=e.WindowedMean=e.TimeKeeper=e.Pools=e.Pool=e.Utils=e.PowOut=e.Pow=e.Interpolation=e.MathUtils=e.Color=e.StringSet=e.IntSet=e.Align=void 0;var h=function(){function t(){o(this,t)}return a(t,null,[{key:"isLeft",value:function(t){return 0!==(t&this.left)}},{key:"isRight",value:function(t){return 0!==(t&this.right)}},{key:"isTop",value:function(t){return 0!==(t&this.top)}},{key:"isBottom",value:function(t){return 0!==(t&this.bottom)}},{key:"isCenterVertical",value:function(t){return 0===(t&this.top)&&0===(t&this.bottom)}},{key:"isCenterHorizontal",value:function(t){return 0===(t&this.left)&&0===(t&this.right)}}]),t}();e.Align=h,n=h,h.center=1,h.top=2,h.bottom=4,h.left=8,h.right=16,h.topLeft=n.top|n.left,h.topRight=n.top|n.right,h.bottomLeft=n.bottom|n.left,h.bottomRight=n.bottom|n.right;var u=function(){function t(){o(this,t),this.array=new Array}return a(t,[{key:"add",value:function(t){var e=this.contains(t);return this.array[0|t]=0|t,!e}},{key:"contains",value:function(t){return void 0!==this.array[0|t]}},{key:"remove",value:function(t){this.array[0|t]=void 0}},{key:"clear",value:function(){this.array.length=0}}]),t}();e.IntSet=u;var l=function(){function t(){o(this,t),this.entries={},this.size=0}return a(t,[{key:"add",value:function(t){var e=this.entries[t];return this.entries[t]=!0,!e&&(this.size++,!0)}},{key:"addAll",value:function(t){for(var e=this.size,i=0,n=t.length;i<n;i++)this.add(t[i]);return e!==this.size}},{key:"contains",value:function(t){return this.entries[t]}},{key:"clear",value:function(){this.entries={},this.size=0}}]),t}();e.StringSet=l;var c=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;o(this,t),this.r=e,this.g=i,this.b=n,this.a=r}return a(t,[{key:"set",value:function(t,e,i,n){return this.r=t,this.g=e,this.b=i,this.a=n,this.clamp()}},{key:"setFromColor",value:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this}},{key:"setFromString",value:function(t){return t="#"===t.charAt(0)?t.substring(1):t,this.r=parseInt(t.substring(0,2),16)/255,this.g=parseInt(t.substring(2,4),16)/255,this.b=parseInt(t.substring(4,6),16)/255,this.a=8!==t.length?1:parseInt(t.substring(6,8),16)/255,this}},{key:"add",value:function(t,e,i,n){return this.r+=t,this.g+=e,this.b+=i,this.a+=n,this.clamp()}},{key:"clamp",value:function(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this}},{key:"toIntBits",value:function(){return 255*this.a<<24|255*this.b<<16|255*this.g<<8|255*this.r}}],[{key:"rgba8888ToColor",value:function(t,e){t.r=((4278190080&e)>>>24)/255,t.g=((16711680&e)>>>16)/255,t.b=((65280&e)>>>8)/255,t.a=(255&e)/255}},{key:"rgb888ToColor",value:function(t,e){t.r=((16711680&e)>>>16)/255,t.g=((65280&e)>>>8)/255,t.b=(255&e)/255}},{key:"fromString",value:function(e){return(new t).setFromString(e)}}]),t}();e.Color=c,c.WHITE=new c(1,1,1,1),c.RED=new c(1,0,0,1),c.GREEN=new c(0,1,0,1),c.BLUE=new c(0,0,1,1),c.MAGENTA=new c(1,0,1,1);var g=function(){function t(){o(this,t)}return a(t,null,[{key:"clamp",value:function(t,e,i){return t<e?e:t>i?i:t}},{key:"cosDeg",value:function(e){return Math.cos(e*t.degRad)}},{key:"sinDeg",value:function(e){return Math.sin(e*t.degRad)}},{key:"signum",value:function(t){return t>0?1:t<0?-1:0}},{key:"toInt",value:function(t){return t>0?Math.floor(t):Math.ceil(t)}},{key:"cbrt",value:function(t){var e=Math.pow(Math.abs(t),1/3);return t<0?-e:e}},{key:"randomTriangular",value:function(e,i){return t.randomTriangularWith(e,i,.5*(e+i))}},{key:"randomTriangularWith",value:function(t,e,i){var n=Math.random(),r=e-t;return n<=(i-t)/r?t+Math.sqrt(n*r*(i-t)):e-Math.sqrt((1-n)*r*(e-i))}},{key:"isPowerOfTwo",value:function(t){return t&&0===(t&t-1)}}]),t}();e.MathUtils=g,g.PI=3.1415927,g.PI2=2*g.PI,g.radiansToDegrees=180/g.PI,g.radDeg=g.radiansToDegrees,g.degreesToRadians=g.PI/180,g.degRad=g.degreesToRadians;var _=function(){function t(){o(this,t)}return a(t,[{key:"apply",value:function(t,e,i){return t+(e-t)*this.applyInternal(i)}}]),t}();e.Interpolation=_;var f=function(t){r(i,t);var e=s(i);function i(t){var n;return o(this,i),(n=e.call(this)).power=2,n.power=t,n}return a(i,[{key:"applyInternal",value:function(t){return t<=.5?Math.pow(2*t,this.power)/2:Math.pow(2*(t-1),this.power)/(this.power%2===0?-2:2)+1}}]),i}(_);e.Pow=f;var d=function(t){r(i,t);var e=s(i);function i(){return o(this,i),e.apply(this,arguments)}return a(i,[{key:"applyInternal",value:function(t){return Math.pow(t-1,this.power)*(this.power%2===0?-1:1)+1}}]),i}(f);e.PowOut=d;var p=function(){function t(){o(this,t)}return a(t,null,[{key:"arrayCopy",value:function(t,e,i,n,r){for(var s=e,o=n;s<e+r;s++,o++)i[o]=t[s]}},{key:"arrayFill",value:function(t,e,i,n){for(var r=e;r<i;r++)t[r]=n}},{key:"setArraySize",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=t.length;if(n===e)return t;if(t.length=e,n<e)for(var r=n;r<e;r++)t[r]=i;return t}},{key:"ensureArrayCapacity",value:function(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e.length>=i?e:t.setArraySize(e,i,n)}},{key:"newArray",value:function(t,e){for(var i=new Array(t),n=0;n<t;n++)i[n]=e;return i}},{key:"newFloatArray",value:function(e){if(t.SUPPORTS_TYPED_ARRAYS)return new Float32Array(e);for(var i=new Array(e),n=0;n<i.length;n++)i[n]=0;return i}},{key:"newShortArray",value:function(e){if(t.SUPPORTS_TYPED_ARRAYS)return new Int16Array(e);for(var i=new Array(e),n=0;n<i.length;n++)i[n]=0;return i}},{key:"toFloatArray",value:function(e){return t.SUPPORTS_TYPED_ARRAYS?new Float32Array(e):e}},{key:"toSinglePrecision",value:function(e){return t.SUPPORTS_TYPED_ARRAYS?Math.fround(e):e}},{key:"contains",value:function(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return!0;return!1}},{key:"enumValue",value:function(t,e){return t[e[0].toUpperCase()+e.slice(1)]}}]),t}();e.Utils=p,p.SUPPORTS_TYPED_ARRAYS="undefined"!==typeof Float32Array;var v=function(){function t(e){o(this,t),this.items=new Array,this.instantiator=e||function(){return{}}}return a(t,[{key:"obtain",value:function(){return this.items.length>0?this.items.pop():this.instantiator()}},{key:"free",value:function(t){(null===t||void 0===t?void 0:t.reset)&&t.reset(),this.items.push(t)}},{key:"freeAll",value:function(t){for(var e=0;e<t.length;e++)this.free(t[e])}},{key:"clear",value:function(){this.items.length=0}}]),t}();e.Pool=v;var x=function(){function t(){o(this,t)}return a(t,null,[{key:"free",value:function(t,e){this.pools[t]&&this.pools[t].free(e)}},{key:"freeAll",value:function(t,e){this.pools[t]&&this.pools[t].freeAll(e)}},{key:"get",value:function(t,e){return this.pools[t]||(this.pools[t]=new v(e)),this.pools[t]}},{key:"set",value:function(t,e){this.pools[t]=e}},{key:"obtain",value:function(t,e){return this.get(t,e).obtain()}}]),t}();e.Pools=x,x.pools={};var y=function(){function t(){o(this,t),this.maxDelta=.064,this.framesPerSecond=0,this.delta=0,this.totalTime=0,this.lastTime=Date.now()/1e3,this.frameCount=0,this.frameTime=0}return a(t,[{key:"update",value:function(){var t=Date.now()/1e3;this.delta=t-this.lastTime,this.frameTime+=this.delta,this.totalTime+=this.delta,this.delta>this.maxDelta&&(this.delta=this.maxDelta),this.lastTime=t,this.frameCount++,this.frameTime>1&&(this.framesPerSecond=this.frameCount/this.frameTime,this.frameTime=0,this.frameCount=0)}}]),t}();e.TimeKeeper=y;var m=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;o(this,t),this.addedValues=0,this.lastValue=0,this.mean=0,this.dirty=!0,this.values=new Array(e)}return a(t,[{key:"hasEnoughData",value:function(){return this.addedValues>=this.values.length}},{key:"addValue",value:function(t){this.addedValues<this.values.length&&this.addedValues++,this.values[this.lastValue++]=t,this.lastValue>this.values.length-1&&(this.lastValue=0),this.dirty=!0}},{key:"getMean",value:function(){if(this.hasEnoughData()){if(this.dirty){for(var t=0,e=0;e<this.values.length;e++)t+=this.values[e];this.mean=t/this.values.length,this.dirty=!1}return this.mean}return 0}}]),t}();e.WindowedMean=m;e.createGameLoop=function(t){var e,i=Date.now(),n=0,r=!0,s=0,o=0;function a(){if(r){var h=Date.now()-i;i=Date.now(),s++,(o+=h)>=1e3&&(n=s,s=0,o-=1e3),e=requestAnimationFrame(a),t(h/1e3)}}return a(),{isRunning:function(){return r},start:function(){r||(r=!0,a())},stop:function(){e&&cancelAnimationFrame(e),r=!1},getFps:function(){return n}}};e.resizeCanvas=function(t,e){var i=e||window.devicePixelRatio||1,n=t.clientWidth*i,r=t.clientHeight*i;return t.width===n&&t.height===r||(t.width=n,t.height=r),[n,r]};e.pointInRect=function(t,e,i,n,r,s){return t>i&&t<i+r&&e>n&&e<n+s};e.createStage=function(t){t=Object.assign(Object.assign({},{hidden:!1,info:!0}),t);var e=document.createElement("div");e.setAttribute("style","position:fixed;top:0;left:0;right:0;bottom:0;"),t.wrapperClassName&&(e.className=t.wrapperClassName),t.hidden&&(e.style.display="none");var i=document.createElement("canvas");i.setAttribute("style","width:100%;height:100%;");var n=document.createElement("div");return n.setAttribute("style","position:absolute;top:1em;left:1em;color:white"),t.info||(n.style.display="none"),e.appendChild(i),e.appendChild(n),document.body.appendChild(e),{getCanvas:function(){return i},getInfo:function(){return n},show:function(){return e.style.display="block"},hide:function(){return e.style.display="none"},cleanup:function(){return document.body.removeChild(e)}}};e.copyArray=function(t,e){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e.length,s=0;s<r;s++)e[i+s]=t[n+s]}},3192:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Vector2=void 0;var s=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;n(this,t),this.x=0,this.y=0,this.x=e,this.y=i}return r(t,[{key:"getX",value:function(){return this.x}},{key:"getY",value:function(){return this.y}},{key:"set",value:function(t,e){return this.x=t,this.y=e,this}},{key:"setVector",value:function(t){return this.set(t.x,t.y)}},{key:"add",value:function(t,e){return this.x+=t,this.y+=e,this}},{key:"addVector",value:function(t){return this.add(t.x,t.y)}},{key:"sub",value:function(t,e){return this.add(-t,-e)}},{key:"subVector",value:function(t){return this.sub(t.x,t.y)}},{key:"scale",value:function(t){return this.x*=t,this.y*=t,this}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y}},{key:"distanceSqr",value:function(t){var e=this.x-t.x,i=this.y-t.y;return e*e+i*i}},{key:"distance",value:function(t){return Math.sqrt(this.distanceSqr(t))}},{key:"angle",value:function(){return Math.atan2(this.y,this.x)}},{key:"len2",value:function(){return this.x*this.x+this.y*this.y}},{key:"len",value:function(){return Math.sqrt(this.len2())}},{key:"nor",value:function(){var t=this.len();return 0!==t&&(this.x/=t,this.y/=t),this}},{key:"rotateRad",value:function(t){var e=Math.cos(t),i=Math.sin(t),n=this.x*e-this.y*i,r=this.x*i+this.y*e;return this.x=n,this.y=r,this}},{key:"rotate",value:function(t){return this.rotateRad(t*Math.PI/180)}},{key:"cpy",value:function(){return new t(this.x,this.y)}}]),t}();e.Vector2=s},2668:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Vector3=void 0;var s=i(5474),o=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;n(this,t),this.x=0,this.y=0,this.z=0,this.x=e,this.y=i,this.z=r}return r(t,[{key:"setFrom",value:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}},{key:"set",value:function(t,e,i){return this.x=t,this.y=e,this.z=i,this}},{key:"add",value:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}},{key:"sub",value:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}},{key:"scale",value:function(t){return this.x*=t,this.y*=t,this.z*=t,this}},{key:"normalize",value:function(){var t=this.length();return 0===t||(t=1/t,this.x*=t,this.y*=t,this.z*=t),this}},{key:"cross",value:function(t){return this.set(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)}},{key:"multiply",value:function(t){var e=t.values;return this.set(this.x*e[s.M00]+this.y*e[s.M01]+this.z*e[s.M02]+e[s.M03],this.x*e[s.M10]+this.y*e[s.M11]+this.z*e[s.M12]+e[s.M13],this.x*e[s.M20]+this.y*e[s.M21]+this.z*e[s.M22]+e[s.M23])}},{key:"project",value:function(t){var e=t.values,i=1/(this.x*e[s.M30]+this.y*e[s.M31]+this.z*e[s.M32]+e[s.M33]);return this.set((this.x*e[s.M00]+this.y*e[s.M01]+this.z*e[s.M02]+e[s.M03])*i,(this.x*e[s.M10]+this.y*e[s.M11]+this.z*e[s.M12]+e[s.M13])*i,(this.x*e[s.M20]+this.y*e[s.M21]+this.z*e[s.M22]+e[s.M23])*i)}},{key:"unproject",value:function(t,e,i,n,r,s){var o=this.x,a=this.y,h=this.z;return o-=i,a=s-a-1,a-=n,t.set(2*o/r-1,2*a/s-1,2*h-1),t.project(e),t}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y+this.z*t.z}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"distance",value:function(t){var e=t.x-this.x,i=t.y-this.y,n=t.z-this.z;return Math.sqrt(e*e+i*i+n*n)}}]),t}();e.Vector3=o},7885:function(t,e,i){"use strict";var n=i(4704).default,r=i(7424).default;Object.defineProperty(e,"__esModule",{value:!0}),e.createViewport=void 0;var s=i(814),o=i(8637);e.createViewport=function(t,e,i,a){var h,u={autoUpdate:!0,pixelRatio:void 0,crop:!0};(a=Object.assign(Object.assign({},u),a)).disablePremultipliedAlpha&&(h={premultipliedAlpha:!1}),h=Object.assign(Object.assign({},h),a.contextOption);var l,c=t.getContext("webgl2",h),g=[],_=a,f=_.autoUpdate,d=_.pixelRatio,p=_.crop,v={pixelRatio:d=d||window.devicePixelRatio||1,x:0,y:0,width:e,height:i,worldWidth:e,worldHeight:i},x=(0,o.resizeCanvas)(t,d),y=r(x,2),m=y[0],M=y[1],w=new s.OrthoCamera(e,i,m,M);f&&(l=function(t){b.update()},window.addEventListener("resize",l));var b={getViewportInfo:function(){return v},getCamera:function(){return w},addCamera:function(t){g.push(t)},getContext:function(){return c},getCanvas:function(){return t},update:function(){var s=(0,o.resizeCanvas)(t,d),a=r(s,2),h=a[0],u=a[1],l=e/i,_=h/u;if(p){var f,x;l<_?(x=u,f=u*l):(f=h,x=h/l);var y=(h-f)/2,m=(u-x)/2;v.x=y,v.y=m,v.width=f,v.height=x,c.viewport(y,m,f,x),w.setPosition(e/2,i/2),w.resize(e,i,f,x);var M,b=n(g);try{for(b.s();!(M=b.n()).done;){var E=M.value;E.setPosition(e/2,i/2),E.resize(e,i,f,x)}}catch(A){b.e(A)}finally{b.f()}}else{var C,k,P,S;v.x=0,v.y=0,v.width=h,v.height=u,c.viewport(0,0,h,u),l<_?(P=-((C=(k=i)*_)-e)/2,S=0):(P=0,S=-((k=(C=e)/_)-i)/2),w.setPosition(P+C/2,S+k/2),w.resize(C,k,h,u);var L,T=n(g);try{for(T.s();!(L=T.n()).done;){var V=L.value;V.setPosition(P+C/2,S+k/2),V.resize(C,k,h,u)}}catch(A){T.e(A)}finally{T.f()}}},cleanUp:function(){l&&window.removeEventListener("resize",l)}};return f&&b.update(),b}},4634:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.ViewportInputHandler=void 0;var s=i(3233),o=i(3192),a=function(){function t(e){n(this,t),this.screenCoord=new o.Vector2,this.worldCoord=new o.Vector2,this.viewport=e,this.canvas=e.getCanvas(),this.inputHandler=new s.InputHandler(this.canvas)}return r(t,[{key:"isTouched",value:function(){return this.inputHandler.isTouched()}},{key:"cleanup",value:function(){this.inputHandler.cleanup()}},{key:"addEventListener",value:function(t,e){var i,n;this.inputHandler.addEventListener(t,(i=e,n=this.viewport,function(t,e){var r=n.getViewportInfo(),s=r.x,o=r.y,a=r.pixelRatio;i(t=t*a-s,e=e*a-o)}))}},{key:"getX",value:function(){var t=this.viewport.getViewportInfo(),e=t.x,i=t.pixelRatio;return this.inputHandler.getX()*i-e}},{key:"getY",value:function(){var t=this.viewport.getViewportInfo(),e=t.y,i=t.pixelRatio;return this.inputHandler.getY()*i-e}},{key:"getTouchedWorldCoord",value:function(t){return t||(t=this.viewport.getCamera()),this.screenCoord.set(this.getX(),this.getY()),t.unprojectVector2(this.worldCoord,this.screenCoord),this.worldCoord}}]),t}();e.ViewportInputHandler=a},8077:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.ManagedWebGLRenderingContext=void 0;var s=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{alpha:"true"};n(this,t),this.restorables=new Array,e instanceof WebGLRenderingContext||"undefined"!==typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext?(this.gl=e,this.canvas=this.gl.canvas):this.setupCanvas(e,i)}return r(t,[{key:"setupCanvas",value:function(t,e){var i=this;this.gl=t.getContext("webgl2",e)||t.getContext("webgl",e),this.canvas=t,t.addEventListener("webglcontextlost",(function(t){t&&t.preventDefault()})),t.addEventListener("webglcontextrestored",(function(t){for(var e=0,n=i.restorables.length;e<n;e++)i.restorables[e].restore()}))}},{key:"addRestorable",value:function(t){this.restorables.push(t)}},{key:"removeRestorable",value:function(t){var e=this.restorables.indexOf(t);e>-1&&this.restorables.splice(e,1)}}]),t}();e.ManagedWebGLRenderingContext=s},5547:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(e,i);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,r)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),r=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||n(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),r(i(9054),e),r(i(5283),e),r(i(6735),e),r(i(909),e),r(i(814),e),r(i(2229),e),r(i(5508),e),r(i(417),e),r(i(1013),e),r(i(3233),e),r(i(5474),e),r(i(4731),e),r(i(2226),e),r(i(2991),e),r(i(6403),e),r(i(9805),e),r(i(2438),e),r(i(3432),e),r(i(8143),e),r(i(8026),e),r(i(8637),e),r(i(3192),e),r(i(2668),e),r(i(7885),e),r(i(4634),e),r(i(8077),e)},9743:function(t,e,i){!function(t,e){"use strict";t.wings=t.wings||{},t.wings.jsCanvas=t.wings.jsCanvas||{},t.wings.core=t.wings.core||{},t.hxPixels=t.hxPixels||{},t.hxPixels._Pixels=t.hxPixels._Pixels||{},t.hxDaedalus=t.hxDaedalus||{},t.hxDaedalus.view=t.hxDaedalus.view||{},t.hxDaedalus.iterators=t.hxDaedalus.iterators||{},t.hxDaedalus.factories=t.hxDaedalus.factories||{},t.hxDaedalus.data=t.hxDaedalus.data||{},t.hxDaedalus.data.math=t.hxDaedalus.data.math||{},t.hxDaedalus.data.graph=t.hxDaedalus.data.graph||{},t.hxDaedalus.ai=t.hxDaedalus.ai||{},t.hxDaedalus.ai.trajectory=t.hxDaedalus.ai.trajectory||{};var i=function(){return rt.__string_rec(this,"")};var n=function(){};n.__name__=!0,n.cca=function(t,e){var i=t.charCodeAt(e);if(i==i)return i},n.substr=function(t,e,i){if(null==i)i=t.length;else if(i<0){if(0!=e)return"";i=t.length+i}return t.substr(e,i)},Math.__name__=!0;var r=function(){};r.__name__=!0,r.string=function(t){return rt.__string_rec(t,"")},r.parseInt=function(t){var e=parseInt(t,10);return 0!=e||120!=n.cca(t,1)&&88!=n.cca(t,1)||(e=parseInt(t)),isNaN(e)?null:e};var s=function(){};s.__name__=!0,s.hex=function(t,e){for(var i="";i="0123456789ABCDEF".charAt(15&t)+i,(t>>>=4)>0;);if(null!=e)for(;i.length<e;)i="0"+i;return i};var o=function(){};o.__name__=!0;var a=function(){this.h={__keys__:{}}};a.__name__=!0,a.__interfaces__=[o],a.prototype={set:function(t,e){var i=t.__id__||(t.__id__=++a.count);this.h[i]=e,this.h.__keys__[i]=t},__class__:a};var h=function(){this.h={}};h.__name__=!0,h.__interfaces__=[o],h.prototype={setReserved:function(t,e){null==this.rh&&(this.rh={}),this.rh["$"+t]=e},getReserved:function(t){return null==this.rh?null:this.rh["$"+t]},__class__:h};var u=function(t){this.length=t.byteLength,this.b=new bt(t),this.b.bufferValue=t,t.hxBytes=this,t.bytes=this.b};u.__name__=!0,u.prototype={blit:function(t,e,i,n){if(t<0||i<0||n<0||t+n>this.length||i+n>e.length)throw new nt(l.OutsideBounds);0==i&&n==e.b.byteLength?this.b.set(e.b,t):this.b.set(e.b.subarray(i,i+n),t)},__class__:u};var l={__ename__:!0,__constructs__:["Blocked","Overflow","OutsideBounds","Custom"],Blocked:["Blocked",0]};l.Blocked.toString=i,l.Blocked.__enum__=l,l.Overflow=["Overflow",1],l.Overflow.toString=i,l.Overflow.__enum__=l,l.OutsideBounds=["OutsideBounds",2],l.OutsideBounds.toString=i,l.OutsideBounds.__enum__=l,l.Custom=function(t){var e=["Custom",3,t];return e.__enum__=l,e.toString=i,e};var c=t.hxDaedalus.ai.AStar=function(){this.iterEdge=new Y};c.__name__=!0,c.prototype={dispose:function(){this._mesh=null,this.closedFaces=null,this.sortedOpenedFaces=null,this.openedFaces=null,this.entryEdges=null,this.entryX=null,this.entryY=null,this.scoreF=null,this.scoreG=null,this.scoreH=null,this.predecessor=null},get_radius:function(){return this._radius},set_radius:function(t){return this._radius=t,this.radiusSquared=this._radius*this._radius,this.diameter=2*this._radius,this.diameterSquared=this.diameter*this.diameter,t},set_mesh:function(t){return this._mesh=t,t},findPath:function(t,e,i,n,r,s){var o,h,u;switch(this.closedFaces=new a,this.sortedOpenedFaces=[],this.openedFaces=new a,this.entryEdges=new a,this.entryX=new a,this.entryY=new a,this.scoreF=new a,this.scoreG=new a,this.scoreH=new a,this.predecessor=new a,(o=V.locatePosition(t,e,this._mesh))[1]){case 0:return void(u=o[2]);case 1:if((h=o[2]).get_isConstrained())return;this.fromFace=h.get_leftFace();break;case 2:var l=o[2];this.fromFace=l}switch((o=V.locatePosition(i,n,this._mesh))[1]){case 0:u=o[2],this.toFace=u.get_edge().get_leftFace();break;case 1:h=o[2],this.toFace=h.get_leftFace();break;case 2:var c=o[2];this.toFace=c}this.sortedOpenedFaces.push(this.fromFace),this.entryEdges.set(this.fromFace,null),this.entryX.set(this.fromFace,t),this.entryY.set(this.fromFace,e),this.scoreG.set(this.fromFace,0);var g,_,f,d,p,v=Math.sqrt((i-t)*(i-t)+(n-e)*(n-e));this.scoreH.set(this.fromFace,v),this.scoreF.set(this.fromFace,v);for(var x,y=new T,m=new T,M=new T;;){if(0==this.sortedOpenedFaces.length){this.curFace=null;break}if(this.curFace=this.sortedOpenedFaces.pop(),this.curFace==this.toFace)break;for(this.iterEdge.set_fromFace(this.curFace);null!=(g=this.iterEdge.next());)if(!g.get_isConstrained()&&(_=g.get_rightFace(),!this.closedFaces.h[_.__id__])){if(this.curFace!=this.fromFace&&this._radius>0&&!this.isWalkableByRadius(this.entryEdges.h[this.curFace.__id__],this.curFace,g))continue;if(y.x=this.entryX.h[this.curFace.__id__],y.y=this.entryY.h[this.curFace.__id__],m.x=(g.get_originVertex().get_pos().x+g.get_destinationVertex().get_pos().x)/2,m.y=(g.get_originVertex().get_pos().y+g.get_destinationVertex().get_pos().y)/2,M.x=m.x-i,M.y=m.y-n,p=M.get_length(),M.x=y.x-m.x,M.y=y.y-m.y,f=p+(d=this.scoreG.h[this.curFace.__id__]+M.get_length()),x=!1,null!=this.openedFaces.h[_.__id__]&&this.openedFaces.h[_.__id__]?this.scoreF.h[_.__id__]>f&&(x=!0):(this.sortedOpenedFaces.push(_),this.openedFaces.set(_,!0),x=!0),x){this.entryEdges.set(_,g);var w=m.x;this.entryX.set(_,w);var b=m.y;this.entryY.set(_,b),this.scoreF.set(_,f),this.scoreG.set(_,d),this.scoreH.set(_,p);var E=this.curFace;this.predecessor.set(_,E)}}this.openedFaces.set(this.curFace,!1),this.closedFaces.set(this.curFace,!0),this.sortedOpenedFaces.sort(ft(this,this.sortingFaces))}if(null!=this.curFace)for(r.push(this.curFace);this.curFace!=this.fromFace;)s.unshift(this.entryEdges.h[this.curFace.__id__]),this.curFace=this.predecessor.h[this.curFace.__id__],r.unshift(this.curFace)},sortingFaces:function(t,e){return this.scoreF.h[t.__id__]==this.scoreF.h[e.__id__]?0:this.scoreF.h[t.__id__]<this.scoreF.h[e.__id__]?1:-1},isWalkableByRadius:function(t,e,i){var n,r=null,s=null,o=null;if(t.get_originVertex()==i.get_originVertex()?(r=t.get_destinationVertex(),s=i.get_destinationVertex(),o=t.get_originVertex()):t.get_destinationVertex()==i.get_destinationVertex()?(r=t.get_originVertex(),s=i.get_originVertex(),o=t.get_destinationVertex()):t.get_originVertex()==i.get_destinationVertex()?(r=t.get_destinationVertex(),s=i.get_originVertex(),o=t.get_originVertex()):t.get_destinationVertex()==i.get_originVertex()&&(r=t.get_originVertex(),s=i.get_destinationVertex(),o=t.get_destinationVertex()),(o.get_pos().x-r.get_pos().x)*(s.get_pos().x-r.get_pos().x)+(o.get_pos().y-r.get_pos().y)*(s.get_pos().y-r.get_pos().y)<=0)return(o.get_pos().x-r.get_pos().x)*(o.get_pos().x-r.get_pos().x)+(o.get_pos().y-r.get_pos().y)*(o.get_pos().y-r.get_pos().y)>=this.diameterSquared;if((o.get_pos().x-s.get_pos().x)*(r.get_pos().x-s.get_pos().x)+(o.get_pos().y-s.get_pos().y)*(r.get_pos().y-s.get_pos().y)<=0)return(o.get_pos().x-s.get_pos().x)*(o.get_pos().x-s.get_pos().x)+(o.get_pos().y-s.get_pos().y)*(o.get_pos().y-s.get_pos().y)>=this.diameterSquared;if((n=e.get_edge()!=t&&e.get_edge().get_oppositeEdge()!=t&&e.get_edge()!=i&&e.get_edge().get_oppositeEdge()!=i?e.get_edge():e.get_edge().get_nextLeftEdge()!=t&&e.get_edge().get_nextLeftEdge().get_oppositeEdge()!=t&&e.get_edge().get_nextLeftEdge()!=i&&e.get_edge().get_nextLeftEdge().get_oppositeEdge()!=i?e.get_edge().get_nextLeftEdge():e.get_edge().get_prevLeftEdge()).get_isConstrained()){var h=new T(o.get_pos().x,o.get_pos().y);return V.projectOrthogonaly(h,n),(h.x-o.get_pos().x)*(h.x-o.get_pos().x)+(h.y-o.get_pos().y)*(h.y-o.get_pos().y)>=this.diameterSquared}var u=(o.get_pos().x-r.get_pos().x)*(o.get_pos().x-r.get_pos().x)+(o.get_pos().y-r.get_pos().y)*(o.get_pos().y-r.get_pos().y),l=(o.get_pos().x-s.get_pos().x)*(o.get_pos().x-s.get_pos().x)+(o.get_pos().y-s.get_pos().y)*(o.get_pos().y-s.get_pos().y);if(u<this.diameterSquared||l<this.diameterSquared)return!1;var c,g,_,f,d,p,v=[],x=[],y=new a;for(x.push(n),n.get_leftFace()==e?(v.push(n.get_rightFace()),y.set(n.get_rightFace(),!0)):(v.push(n.get_leftFace()),y.set(n.get_leftFace(),!0));v.length>0;){if(c=v.shift(),g=x.shift(),c.get_edge()==g||c.get_edge()==g.get_oppositeEdge()?(_=c.get_edge().get_nextLeftEdge(),d=c.get_edge().get_nextLeftEdge().get_nextLeftEdge()):c.get_edge().get_nextLeftEdge()==g||c.get_edge().get_nextLeftEdge()==g.get_oppositeEdge()?(_=c.get_edge(),d=c.get_edge().get_nextLeftEdge().get_nextLeftEdge()):(_=c.get_edge(),d=c.get_edge().get_nextLeftEdge()),f=_.get_leftFace()==c?_.get_rightFace():_.get_leftFace(),p=d.get_leftFace()==c?d.get_rightFace():d.get_leftFace(),!y.h[f.__id__]&&V.distanceSquaredVertexToEdge(o,_)<this.diameterSquared){if(_.get_isConstrained())return!1;v.push(f),x.push(_),y.set(f,!0)}if(!y.h[p.__id__]&&V.distanceSquaredVertexToEdge(o,d)<this.diameterSquared){if(d.get_isConstrained())return!1;v.push(p),x.push(d),y.set(p,!0)}}return!0},__class__:c};var g=t.hxDaedalus.ai.EntityAI=function(){this._radius=10,this.x=this.y=0,this.dirNormX=1,this.dirNormY=0};g.__name__=!0,g.prototype={buildApproximation:function(){this._approximateObject=new b,this._approximateObject.get_matrix().translate(this.x,this.y);var t=[];if(this._approximateObject.set_coordinates(t),0!=this._radius)for(var e=0;e<6;){var i=e++;t.push(this._radius*Math.cos(2*Math.PI*i/6)),t.push(this._radius*Math.sin(2*Math.PI*i/6)),t.push(this._radius*Math.cos(2*Math.PI*(i+1)/6)),t.push(this._radius*Math.sin(2*Math.PI*(i+1)/6))}},get_approximateObject:function(){return this._approximateObject.get_matrix().identity(),this._approximateObject.get_matrix().translate(this.x,this.y),this._approximateObject},get_radius:function(){return this._radius},get_radiusSquared:function(){return this._radiusSquared},set_radius:function(t){return this._radius=t,this._radiusSquared=this._radius*this._radius,t},__class__:g};var _=t.hxDaedalus.ai.Funnel=function(){this._currPoolPointsIndex=0,this._poolPointsSize=3e3,this._numSamplesCircle=16,this._radiusSquared=0,this._radius=0,this._poolPoints=[];for(var t=0,e=this._poolPointsSize;t<e;){t++;this._poolPoints.push(new T)}};_.__name__=!0,_.prototype={dispose:function(){this._sampleCircle=null},getPoint:function(t,e){return null==e&&(e=0),null==t&&(t=0),this.__point=this._poolPoints[this._currPoolPointsIndex],this.__point.setXY(t,e),this._currPoolPointsIndex++,this._currPoolPointsIndex==this._poolPointsSize&&(this._poolPoints.push(new T),this._poolPointsSize++),this.__point},getCopyPoint:function(t){return this.getPoint(t.x,t.y)},get_radius:function(){return this._radius},set_radius:function(t){if(this._radius=Math.max(0,t),this._radiusSquared=this._radius*this._radius,this._sampleCircle=[],0==this.get_radius())return 0;for(var e=0,i=this._numSamplesCircle;e<i;){var n=e++;this._sampleCircle.push(new T(this._radius*Math.cos(-2*Math.PI*n/this._numSamplesCircle),this._radius*Math.sin(-2*Math.PI*n/this._numSamplesCircle)))}return this._sampleCircleDistanceSquared=(this._sampleCircle[0].x-this._sampleCircle[1].x)*(this._sampleCircle[0].x-this._sampleCircle[1].x)+(this._sampleCircle[0].y-this._sampleCircle[1].y)*(this._sampleCircle[0].y-this._sampleCircle[1].y),this._radius},findPath:function(t,e,i,n,r,s,o){if(this._currPoolPointsIndex=0,this._radius>0){var h,u,l,c,g,_=r[0];l=_.get_edge().get_originVertex().get_pos(),c=_.get_edge().get_destinationVertex().get_pos(),g=_.get_edge().get_nextLeftEdge().get_destinationVertex().get_pos(),(h=(l.x-t)*(l.x-t)+(l.y-e)*(l.y-e))<=this._radiusSquared?(u=Math.sqrt(h),t=1.01*this._radius*((t-l.x)/u)+l.x,e=1.01*this._radius*((e-l.y)/u)+l.y):(h=(c.x-t)*(c.x-t)+(c.y-e)*(c.y-e))<=this._radiusSquared?(u=Math.sqrt(h),t=1.01*this._radius*((t-c.x)/u)+c.x,e=1.01*this._radius*((e-c.y)/u)+c.y):(h=(g.x-t)*(g.x-t)+(g.y-e)*(g.y-e))<=this._radiusSquared&&(u=Math.sqrt(h),t=1.01*this._radius*((t-g.x)/u)+g.x,e=1.01*this._radius*((e-g.y)/u)+g.y),l=(_=r[r.length-1]).get_edge().get_originVertex().get_pos(),c=_.get_edge().get_destinationVertex().get_pos(),g=_.get_edge().get_nextLeftEdge().get_destinationVertex().get_pos(),(h=(l.x-i)*(l.x-i)+(l.y-n)*(l.y-n))<=this._radiusSquared?(u=Math.sqrt(h),i=1.01*this._radius*((i-l.x)/u)+l.x,n=1.01*this._radius*((n-l.y)/u)+l.y):(h=(c.x-i)*(c.x-i)+(c.y-n)*(c.y-n))<=this._radiusSquared?(u=Math.sqrt(h),i=1.01*this._radius*((i-c.x)/u)+c.x,n=1.01*this._radius*((n-c.y)/u)+c.y):(h=(g.x-i)*(g.x-i)+(g.y-n)*(g.y-n))<=this._radiusSquared&&(u=Math.sqrt(h),i=1.01*this._radius*((i-g.x)/u)+g.x,n=1.01*this._radius*((n-g.y)/u)+g.y)}var f,d,p,v;if(f=new T(t,e),d=new T(i,n),1==r.length)return o.push(f.x),o.push(f.y),o.push(d.x),void o.push(d.y);var x,y=null,m=null,M=V.isInFace(t,e,r[0]);if(1==M[1]){var w=M[2];s[0]==w&&(s.shift(),r.shift())}var b=[],E=[];b.push(f),E.push(f);var C=new a,k=[],P=new a,S=new a;P.set(f,0),y=s[0];var L,A,F,O=V.getRelativePosition2(t,e,y);A=this.getCopyPoint(y.get_destinationVertex().get_pos()),F=this.getCopyPoint(y.get_originVertex().get_pos()),k.push(A),k.push(F),S.set(f,A),S.set(A,F),L=F,1==O?(P.set(A,1),P.set(F,-1),C.set(y.get_destinationVertex(),1),C.set(y.get_originVertex(),-1)):-1==O&&(P.set(A,-1),P.set(F,1),C.set(y.get_destinationVertex(),-1),C.set(y.get_originVertex(),1));for(var R=s[0].get_originVertex(),I=s[0].get_destinationVertex(),D=1,N=s.length;D<N;){(y=s[D++]).get_originVertex()==R?m=y.get_destinationVertex():y.get_destinationVertex()==R?m=y.get_originVertex():y.get_originVertex()==I?(m=y.get_destinationVertex(),R=I):y.get_destinationVertex()==I&&(m=y.get_originVertex(),R=I),A=this.getCopyPoint(m.get_pos()),k.push(A),x=-C.h[R.__id__],P.set(A,x),S.set(L,A),C.set(m,x),L=A,I=R,R=m}S.set(L,d),P.set(d,0);var j,G=[],X=new a;G.push(f),X.set(f,0);for(var B=0,Y=k.length;B<Y;){if(j=k[B++],-1==P.h[j.__id__]){for(v=b.length-2;v>=0;){if(-1!=(x=V.getDirection(b[v].x,b[v].y,b[v+1].x,b[v+1].y,j.x,j.y))){b.shift();for(var W=0,U=v;W<U;){W++;G.push(b[0]),X.set(b[0],1),b.shift()}G.push(b[0]),X.set(b[0],1),E.splice(0,E.length),E.push(b[0]),E.push(j);break}--v}for(E.push(j),v=E.length-3;v>=0&&-1!=(x=V.getDirection(E[v].x,E[v].y,E[v+1].x,E[v+1].y,j.x,j.y));)E.splice(v+1,1),--v}else{for(v=E.length-2;v>=0;){if(1!=(x=V.getDirection(E[v].x,E[v].y,E[v+1].x,E[v+1].y,j.x,j.y))){E.shift();for(var H=0,z=v;H<z;){H++;G.push(E[0]),X.set(E[0],-1),E.shift()}G.push(E[0]),X.set(E[0],-1),b.splice(0,b.length),b.push(E[0]),b.push(j);break}--v}for(b.push(j),v=b.length-3;v>=0&&1!=(x=V.getDirection(b[v].x,b[v].y,b[v+1].x,b[v+1].y,j.x,j.y));)b.splice(v+1,1),--v}}var q=!1;for(v=E.length-2;v>=0;){if(1!=(x=V.getDirection(E[v].x,E[v].y,E[v+1].x,E[v+1].y,i,n))){E.shift();for(var K=0,Z=v+1;K<Z;){K++;G.push(E[0]),X.set(E[0],-1),E.shift()}G.push(d),X.set(d,0),q=!0;break}--v}if(!q)for(v=b.length-2;v>=0;){if(-1!=(x=V.getDirection(b[v].x,b[v].y,b[v+1].x,b[v+1].y,i,n))){b.shift();for(var Q=0,$=v+1;Q<$;){Q++;G.push(b[0]),X.set(b[0],1),b.shift()}G.push(d),X.set(d,0),q=!0;break}--v}q||(G.push(d),X.set(d,0),q=!0);var J=[];if(this.get_radius()>0){var tt=[];if(2==G.length)this.adjustWithTangents(G[0],!1,G[1],!1,P,S,tt,J);else if(G.length>2){if(this.adjustWithTangents(G[0],!1,G[1],!0,P,S,tt,J),G.length>3)for(var et=1,it=G.length-3+1;et<it;){var nt=et++;this.adjustWithTangents(G[nt],!0,G[nt+1],!0,P,S,tt,J)}var rt=G.length;this.adjustWithTangents(G[rt-2],!0,G[rt-1],!1,P,S,tt,J)}tt.push(d),this.checkAdjustedPath(tt,J,P);var st=[];for(p=tt.length-2;p>=1;){for(this.smoothAngle(J[2*p-1],tt[p],J[2*p],P.h[tt[p].__id__],st);0!=st.length;){var ot=2*p;J.splice(ot,0);var at=st.pop();J.splice(ot,0,at)}--p}}else J=G;for(var ht=0,ut=J.length;ht<ut;){var lt=ht++;o.push(J[lt].x),o.push(J[lt].y)}},adjustWithTangents:function(t,e,i,n,r,s,o,a){var h=[],u=r.h[t.__id__],l=r.h[i.__id__],c=null,g=null;if(e||n)if(e)if(n)if(1==u&&1==l)V.tangentsParalCircleToCircle(this._radius,t.x,t.y,i.x,i.y,h),c=this.getPoint(h[2],h[3]),g=this.getPoint(h[4],h[5]);else if(-1==u&&-1==l)V.tangentsParalCircleToCircle(this._radius,t.x,t.y,i.x,i.y,h),c=this.getPoint(h[0],h[1]),g=this.getPoint(h[6],h[7]);else if(1==u&&-1==l){if(!V.tangentsCrossCircleToCircle(this._radius,t.x,t.y,i.x,i.y,h))return;c=this.getPoint(h[2],h[3]),g=this.getPoint(h[6],h[7])}else{if(!V.tangentsCrossCircleToCircle(this._radius,t.x,t.y,i.x,i.y,h))return;c=this.getPoint(h[0],h[1]),g=this.getPoint(h[4],h[5])}else{if(!V.tangentsPointToCircle(i.x,i.y,t.x,t.y,this._radius,h))return;h.length>0&&(1==u?(c=this.getPoint(h[0],h[1]),g=i):(c=this.getPoint(h[2],h[3]),g=i))}else{if(!V.tangentsPointToCircle(t.x,t.y,i.x,i.y,this._radius,h))return;1==l?(c=t,g=this.getPoint(h[2],h[3])):(c=t,g=this.getPoint(h[0],h[1]))}else c=t,g=i;for(var _=s.h[t.__id__];_!=i;){if(V.distanceSquaredPointToSegment(_.x,_.y,c.x,c.y,g.x,g.y)<this._radiusSquared)return this.adjustWithTangents(t,e,_,!0,r,s,o,a),void this.adjustWithTangents(_,!0,i,n,r,s,o,a);_=s.h[_.__id__]}a.push(c),a.push(g),o.push(t)},checkAdjustedPath:function(t,e,i){for(var n,r,s,o,a,h,u,l,c,g=!0,_=[],f=null,d=null;g;){g=!1;for(var p=2;p<t.length;){if(a=t[p],h=i.h[a.__id__],s=t[p-1],o=i.h[s.__id__],n=t[p-2],r=i.h[n.__id__],o==h&&(u=e[2*(p-2)],l=e[2*(p-1)-1],c=e[2*(p-1)],(u.x-l.x)*(c.x-l.x)+(u.y-l.y)*(c.y-l.y)>0)){2==p?(V.tangentsPointToCircle(n.x,n.y,a.x,a.y,this._radius,_),1==h?(f=n,d=this.getPoint(_[2],_[3])):(f=n,d=this.getPoint(_[0],_[1]))):p==t.length-1?(V.tangentsPointToCircle(a.x,a.y,n.x,n.y,this._radius,_),1==r?(f=this.getPoint(_[0],_[1]),d=a):(f=this.getPoint(_[2],_[3]),d=a)):1==r&&-1==h?(V.tangentsCrossCircleToCircle(this._radius,n.x,n.y,a.x,a.y,_),f=this.getPoint(_[2],_[3]),d=this.getPoint(_[6],_[7])):-1==r&&1==h?(V.tangentsCrossCircleToCircle(this._radius,n.x,n.y,a.x,a.y,_),f=this.getPoint(_[0],_[1]),d=this.getPoint(_[4],_[5])):1==r&&1==h?(V.tangentsParalCircleToCircle(this._radius,n.x,n.y,a.x,a.y,_),f=this.getPoint(_[2],_[3]),d=this.getPoint(_[4],_[5])):-1==r&&-1==h&&(V.tangentsParalCircleToCircle(this._radius,n.x,n.y,a.x,a.y,_),f=this.getPoint(_[0],_[1]),d=this.getPoint(_[6],_[7]));var v=2*(p-2);e.splice(v,1),e.splice(v,0,f),v=2*p-1,e.splice(v,1),e.splice(v,0,d),t.splice(p-1,1),e.splice(2*(p-1)-1,2),_.splice(0,_.length),--p}++p}}},smoothAngle:function(t,e,i,n,r){var s=V.getDirection(t.x,t.y,e.x,e.y,i.x,i.y);if(!((t.x-i.x)*(t.x-i.x)+(t.y-i.y)*(t.y-i.y)<=this._sampleCircleDistanceSquared)){for(var o,a,h,u,l,c=0,g=0,_=this._numSamplesCircle;g<_;){var f=g++;if(h=!1,u=e.x+this._sampleCircle[f].x,l=e.y+this._sampleCircle[f].y,o=V.getDirection(t.x,t.y,e.x,e.y,u,l),a=V.getDirection(e.x,e.y,i.x,i.y,u,l),1==n?-1==s?-1==o&&-1==a&&(h=!0):-1!=o&&-1!=a||(h=!0):1==s?1==o&&1==a&&(h=!0):1!=o&&1!=a||(h=!0),h){r.splice(c,0);var d=new T(u,l);r.splice(c,0,d),++c}else c=0}-1==n&&r.reverse()}},__class__:_};var f=t.hxDaedalus.ai.PathFinder=function(){this.astar=new c,this.funnel=new _,this.listFaces=[],this.listEdges=[]};f.__name__=!0,f.prototype={dispose:function(){this._mesh=null,this.astar.dispose(),this.astar=null,this.funnel.dispose(),this.funnel=null,this.listEdges=null,this.listFaces=null},get_mesh:function(){return this._mesh},set_mesh:function(t){return this._mesh=t,this.astar.set_mesh(this._mesh),t},findPath:function(t,e,i){i.splice(0,i.length);this._mesh,this.entity;V.isCircleIntersectingAnyConstraint(t,e,this.entity.get_radius(),this._mesh)||(this.astar.set_radius(this.entity.get_radius()),this.funnel.set_radius(this.entity.get_radius()),this.listFaces.splice(0,this.listFaces.length),this.listEdges.splice(0,this.listEdges.length),this.astar.findPath(this.entity.x,this.entity.y,t,e,this.listFaces,this.listEdges),0!=this.listFaces.length&&this.funnel.findPath(this.entity.x,this.entity.y,t,e,this.listFaces,this.listEdges,i))},__class__:f};var d=t.hxDaedalus.ai.trajectory.LinearPathSampler=function(){this._samplingDistanceSquared=1,this._samplingDistance=1,this._preCompX=[],this._preCompY=[]};d.__name__=!0,d.pythag=function(t,e){return Math.sqrt(t*t+e*e)},d.prototype={dispose:function(){this.entity=null,this._path=null,this._preCompX=null,this._preCompY=null},get_x:function(){return this._currentX},get_y:function(){return this._currentY},get_hasPrev:function(){return this._hasPrev},get_hasNext:function(){return this._hasNext},get_count:function(){return this._count},set_count:function(t){return this._count=t,this._count<0&&(this._count=0),this._count>this.get_countMax()-1&&(this._count=this.get_countMax()-1),this._hasPrev=0!=this._count,this._hasNext=this._count!=this.get_countMax()-1,this._currentX=this._preCompX[this._count],this._currentY=this._preCompY[this._count],this.updateEntity(),this._count},get_countMax:function(){return this._preCompX.length-1},get_samplingDistance:function(){return this._samplingDistance},set_samplingDistance:function(t){return this._samplingDistance=t,this._samplingDistanceSquared=this._samplingDistance*this._samplingDistance,t},set_path:function(t){return this._path=t,this._preComputed=!1,this.reset(),t},reset:function(){if(this._path.length>0){this._path.length;this._currentX=this._path[0],this._currentY=this._path[1],this._iPrev=0,this._iNext=2,this._hasPrev=!1,this._hasNext=!0,this._count=0,this.updateEntity()}else this._hasPrev=!1,this._hasNext=!1,this._count=0},preCompute:function(){for(this._preCompX.splice(0,this._preCompX.length),this._preCompY.splice(0,this._preCompY.length),this._count=0,this._preCompX.push(this._currentX),this._preCompY.push(this._currentY),this._preComputed=!1;this.next();)this._preCompX.push(this._currentX),this._preCompY.push(this._currentY);this.reset(),this._preComputed=!0},prev:function(){if(!this._hasPrev)return!1;if(this._hasNext=!0,this._preComputed)return this._count--,0==this._count&&(this._hasPrev=!1),this._currentX=this._preCompX[this._count],this._currentY=this._preCompY[this._count],this.updateEntity(),!0;for(var t=this._samplingDistance,e=0;;){var i=this._path[this._iPrev],n=this._path[this._iPrev+1],r=this._currentX-i,s=this._currentY-n;if(!((e=Math.sqrt(r*r+s*s))<t))break;if(t-=e,this._iPrev-=2,this._iNext-=2,0==this._iNext)break}return 0==this._iNext?(this._currentX=this._path[0],this._currentY=this._path[1],this._hasPrev=!1,this._iNext=2,this._iPrev=0,this.updateEntity(),!0):(this._currentX+=(this._path[this._iPrev]-this._currentX)*t/e,this._currentY+=(this._path[this._iPrev+1]-this._currentY)*t/e,this.updateEntity(),!0)},next:function(){if(!this._hasNext)return!1;if(this._hasPrev=!0,this._preComputed)return this._count++,this._count==this._preCompX.length-1&&(this._hasNext=!1),this._currentX=this._preCompX[this._count],this._currentY=this._preCompY[this._count],this.updateEntity(),!0;for(var t=this._samplingDistance,e=0;;){var i=this._path[this._iNext],n=this._path[this._iNext+1],r=this._currentX-i,s=this._currentY-n;if(!((e=Math.sqrt(r*r+s*s))<t))break;if(t-=e,this._currentX=this._path[this._iNext],this._currentY=this._path[this._iNext+1],this._iPrev+=2,this._iNext+=2,this._iNext==this._path.length)break}return this._iNext==this._path.length?(this._currentX=this._path[this._iPrev],this._currentY=this._path[this._iPrev+1],this._hasNext=!1,this._iNext=this._path.length-2,this._iPrev=this._iNext-2,this.updateEntity(),!0):(this._currentX+=(this._path[this._iNext]-this._currentX)*t/e,this._currentY+=(this._path[this._iNext+1]-this._currentY)*t/e,this.updateEntity(),!0)},updateEntity:function(){if(null!=this.entity){isNaN(this._currentX)&&isNaN(this._currentY);this.entity.x=this._currentX,this.entity.y=this._currentY}},__class__:d};var p=t.hxDaedalus.ai.trajectory.PathIterator=function(){};p.__name__=!0,p.prototype={get_entity:function(){return this._entity},set_entity:function(t){return this._entity=t,t},get_x:function(){return this._currentX},get_y:function(){return this._currentY},get_hasPrev:function(){return this._hasPrev},get_hasNext:function(){return this._hasNext},get_count:function(){return this._count},get_countMax:function(){return this._countMax},set_path:function(t){return this._path=t,this._countMax=this._path.length/2|0,this.reset(),t},reset:function(){this._count=0,this._currentX=this._path[this._count],this._currentY=this._path[this._count+1],this.updateEntity(),this._hasPrev=!1,this._hasNext=this._path.length>2},prev:function(){return!!this._hasPrev&&(this._hasNext=!0,this._count--,this._currentX=this._path[2*this._count],this._currentY=this._path[2*this._count+1],this.updateEntity(),0==this._count&&(this._hasPrev=!1),!0)},next:function(){return!!this._hasNext&&(this._hasPrev=!0,this._count++,this._currentX=this._path[2*this._count],this._currentY=this._path[2*this._count+1],this.updateEntity(),2*(this._count+1)==this._path.length&&(this._hasNext=!1),!0)},updateEntity:function(){null!=this._entity&&(this._entity.x=this._currentX,this._entity.y=this._currentY)},__class__:p};var v=t.hxDaedalus.data.Constants=function(){};v.__name__=!0;var x=t.hxDaedalus.data.ConstraintSegment=function(){this._id=x.INC,x.INC++,this._edges=[]};x.__name__=!0,x.prototype={get_id:function(){return this._id},addEdge:function(t){-1==this._edges.indexOf(t)&&-1==this._edges.indexOf(t.get_oppositeEdge())&&this._edges.push(t)},removeEdge:function(t){var e=this._edges.indexOf(t);-1==e&&(e=this._edges.indexOf(t.get_oppositeEdge())),-1!=e&&this._edges.splice(e,1)},get_edges:function(){return this._edges},dispose:function(){this._edges=null,this.fromShape=null},toString:function(){return"seg_id "+this._id},__class__:x};var y=t.hxDaedalus.data.ConstraintShape=function(){this._id=y.INC,y.INC++,this.segments=[]};y.__name__=!0,y.prototype={get_id:function(){return this._id},dispose:function(){for(;this.segments.length>0;)this.segments.pop().dispose();this.segments=null},__class__:y};var m=t.hxDaedalus.data.Edge=function(){this.colorDebug=-1,this._id=m.INC,m.INC++,this.fromConstraintSegments=[]};m.__name__=!0,m.prototype={get_id:function(){return this._id},get_isReal:function(){return this._isReal},get_isConstrained:function(){return this._isConstrained},setDatas:function(t,e,i,n,r,s){null==s&&(s=!1),null==r&&(r=!0),this._isConstrained=s,this._isReal=r,this._originVertex=t,this._oppositeEdge=e,this._nextLeftEdge=i,this._leftFace=n},addFromConstraintSegment:function(t){-1==this.fromConstraintSegments.indexOf(t)&&this.fromConstraintSegments.push(t)},removeFromConstraintSegment:function(t){var e=this.fromConstraintSegments.indexOf(t);-1!=e&&this.fromConstraintSegments.splice(e,1)},set_originVertex:function(t){return this._originVertex=t,t},set_nextLeftEdge:function(t){return this._nextLeftEdge=t,t},set_leftFace:function(t){return this._leftFace=t,t},set_isConstrained:function(t){return this._isConstrained=t,t},dispose:function(){this._originVertex=null,this._oppositeEdge=null,this._nextLeftEdge=null,this._leftFace=null,this.fromConstraintSegments=null},get_originVertex:function(){return this._originVertex},get_destinationVertex:function(){return this.get_oppositeEdge().get_originVertex()},get_oppositeEdge:function(){return this._oppositeEdge},get_nextLeftEdge:function(){return this._nextLeftEdge},get_prevLeftEdge:function(){return this._nextLeftEdge.get_nextLeftEdge()},get_nextRightEdge:function(){return this._oppositeEdge.get_nextLeftEdge().get_nextLeftEdge().get_oppositeEdge()},get_prevRightEdge:function(){return this._oppositeEdge.get_nextLeftEdge().get_oppositeEdge()},get_rotLeftEdge:function(){return this._nextLeftEdge.get_nextLeftEdge().get_oppositeEdge()},get_rotRightEdge:function(){return this._oppositeEdge.get_nextLeftEdge()},get_leftFace:function(){return this._leftFace},get_rightFace:function(){return this._oppositeEdge.get_leftFace()},toString:function(){return"edge "+this.get_originVertex().get_id()+" - "+this.get_destinationVertex().get_id()},__class__:m};var M=t.hxDaedalus.data.Face=function(){this.colorDebug=-1,this._id=M.INC,M.INC++};M.__name__=!0,M.prototype={get_id:function(){return this._id},get_isReal:function(){return this._isReal},set_datas:function(t){this._isReal=!0,this._edge=t},setDatas:function(t,e){null==e&&(e=!0),this._isReal=e,this._edge=t},dispose:function(){this._edge=null},get_edge:function(){return this._edge},__class__:M};var w=t.hxDaedalus.data.Mesh=function(t,e){this.__objectsUpdateInProgress=!1,this.__edgesToCheck=null,this.__centerVertex=null,this._objects=null,this._constraintShapes=null,this._faces=null,this._edges=null,this._vertices=null,this._clipping=!1,this._height=0,this._width=0,this._id=w.INC,w.INC++,this._width=t,this._height=e,this._clipping=!0,this._vertices=[],this._edges=[],this._faces=[],this._constraintShapes=[],this._objects=[],this.__edgesToCheck=[]};w.__name__=!0,w.prototype={get_height:function(){return this._height},get_width:function(){return this._width},get_clipping:function(){return this._clipping},set_clipping:function(t){return this._clipping=t,t},get_id:function(){return this._id},dispose:function(){for(;this._vertices.length>0;)this._vertices.pop().dispose();for(this._vertices=null;this._edges.length>0;)this._edges.pop().dispose();for(this._edges=null;this._faces.length>0;)this._faces.pop().dispose();for(this._faces=null;this._constraintShapes.length>0;)this._constraintShapes.pop().dispose();for(this._constraintShapes=null;this._objects.length>0;)this._objects.pop().dispose();this._objects=null,this.__edgesToCheck=null,this.__centerVertex=null},get___constraintShapes:function(){return this._constraintShapes},buildFromRecord:function(t){for(var e=t.split(";"),i=0;i<e.length;)this.insertConstraintSegment(parseFloat(e[i]),parseFloat(e[i+1]),parseFloat(e[i+2]),parseFloat(e[i+3])),i+=4},insertObject:function(t){null!=t.get_constraintShape()&&this.deleteObject(t);var e,i,n,r,s,o,a,h,u,l=new y,c=t.get_coordinates(),g=t.get_matrix();t.updateMatrixFromValues();for(var _=0;_<c.length;)i=c[_],n=c[_+1],r=c[_+2],s=c[_+3],o=g.transformX(i,n),a=g.transformY(i,n),h=g.transformX(r,s),u=g.transformY(r,s),null!=(e=this.insertConstraintSegment(o,a,h,u))&&(e.fromShape=l,l.segments.push(e)),_+=4;this._constraintShapes.push(l),t.set_constraintShape(l),this.__objectsUpdateInProgress||this._objects.push(t)},deleteObject:function(t){if(null!=t.get_constraintShape()&&(this.deleteConstraintShape(t.get_constraintShape()),t.set_constraintShape(null),!this.__objectsUpdateInProgress)){var e=this._objects.indexOf(t);this._objects.splice(e,1)}},updateObjects:function(){this.__objectsUpdateInProgress=!0;for(var t=0,e=this._objects.length;t<e;){var i=t++;this._objects[i].get_hasChanged()&&(this.deleteObject(this._objects[i]),this.insertObject(this._objects[i]),this._objects[i].set_hasChanged(!1))}this.__objectsUpdateInProgress=!1},insertConstraintShape:function(t){for(var e=new y,i=null,n=0;n<t.length;)null!=(i=this.insertConstraintSegment(t[n],t[n+1],t[n+2],t[n+3]))&&(i.fromShape=e,e.segments.push(i)),n+=4;return this._constraintShapes.push(e),e},deleteConstraintShape:function(t){for(var e=0,i=t.segments.length;e<i;){var n=e++;this.deleteConstraintSegment(t.segments[n])}t.dispose(),this._constraintShapes.splice(this._constraintShapes.indexOf(t),1)},insertConstraintSegment:function(t,e,i,n){var r=this.findPositionFromBounds(t,e),s=this.findPositionFromBounds(i,n),o=t,a=e,h=i,u=n;if(this._clipping&&(0!=r||0!=s)){var l=new T;if(0!=r&&0!=s){if(t<=0&&i<=0||t>=this._width&&i>=this._width||e<=0&&n<=0||e>=this._height&&n>=this._height)return null;if(8==r&&4==s||4==r&&8==s)V.intersections2segments(t,e,i,n,0,0,0,this._height,l),o=l.x,a=l.y,V.intersections2segments(t,e,i,n,this._width,0,this._width,this._height,l),h=l.x,u=l.y;else if(2==r&&6==s||6==r&&2==s)V.intersections2segments(t,e,i,n,0,0,this._width,0,l),o=l.x,a=l.y,V.intersections2segments(t,e,i,n,0,this._height,this._width,this._height,l),h=l.x,u=l.y;else if(2==r&&8==s||8==r&&2==s){if(!V.intersections2segments(t,e,i,n,0,0,this._width,0,l))return null;o=l.x,a=l.y,V.intersections2segments(t,e,i,n,0,0,0,this._height,l),h=l.x,u=l.y}else if(2==r&&4==s||4==r&&2==s){if(!V.intersections2segments(t,e,i,n,0,0,this._width,0,l))return null;o=l.x,a=l.y,V.intersections2segments(t,e,i,n,this._width,0,this._width,this._height,l),h=l.x,u=l.y}else if(6==r&&4==s||4==r&&6==s){if(!V.intersections2segments(t,e,i,n,0,this._height,this._width,this._height,l))return null;o=l.x,a=l.y,V.intersections2segments(t,e,i,n,this._width,0,this._width,this._height,l),h=l.x,u=l.y}else if(8==r&&6==s||6==r&&8==s){if(!V.intersections2segments(t,e,i,n,0,this._height,this._width,this._height,l))return null;o=l.x,a=l.y,V.intersections2segments(t,e,i,n,0,0,0,this._height,l),h=l.x,u=l.y}else{var c=!1,g=!1;if(V.intersections2segments(t,e,i,n,0,0,this._width,0,l)&&(o=l.x,a=l.y,c=!0),V.intersections2segments(t,e,i,n,this._width,0,this._width,this._height,l)&&(c?(h=l.x,u=l.y,g=!0):(o=l.x,a=l.y,c=!0)),!g&&V.intersections2segments(t,e,i,n,0,this._height,this._width,this._height,l)&&(c?(h=l.x,u=l.y,g=!0):(o=l.x,a=l.y,c=!0)),!g&&V.intersections2segments(t,e,i,n,0,0,0,this._height,l)&&(h=l.x,u=l.y),!c)return null}}else 2==r||2==s?V.intersections2segments(t,e,i,n,0,0,this._width,0,l):4==r||4==s?V.intersections2segments(t,e,i,n,this._width,0,this._width,this._height,l):6==r||6==s?V.intersections2segments(t,e,i,n,0,this._height,this._width,this._height,l):8==r||8==s?V.intersections2segments(t,e,i,n,0,0,0,this._height,l):V.intersections2segments(t,e,i,n,0,0,this._width,0,l)||V.intersections2segments(t,e,i,n,this._width,0,this._width,this._height,l)||V.intersections2segments(t,e,i,n,0,this._height,this._width,this._height,l)||V.intersections2segments(t,e,i,n,0,0,0,this._height,l),0==r?(o=t,a=e):(o=i,a=n),h=l.x,u=l.y}var _=this.insertVertex(o,a);if(null==_)return null;var f=this.insertVertex(h,u);if(null==f)return null;if(_==f)return null;var d,p,v=new Q,y=new x,M=new m,w=new m;M.setDatas(_,w,null,null,!0,!0),w.setDatas(f,M,null,null,!0,!0);var b,E,C,k,P,S=[],A=[],F=[],O=new T;for(d=_,b=L.EVertex(d);;)switch(P=!1,b[1]){case 0:for(d=b[2],v.set_fromVertex(d);null!=(p=v.next());){if(p.get_destinationVertex()==f)return p.get_isConstrained()||(p.set_isConstrained(!0),p.get_oppositeEdge().set_isConstrained(!0)),p.addFromConstraintSegment(y),p.get_oppositeEdge().fromConstraintSegments=p.fromConstraintSegments,_.addFromConstraintSegment(y),f.addFromConstraintSegment(y),y.addEdge(p),y;if(V.distanceSquaredVertexToEdge(p.get_destinationVertex(),M)<=1e-4){p.get_isConstrained()||(p.set_isConstrained(!0),p.get_oppositeEdge().set_isConstrained(!0)),p.addFromConstraintSegment(y),p.get_oppositeEdge().fromConstraintSegments=p.fromConstraintSegments,_.addFromConstraintSegment(y),y.addEdge(p),_=p.get_destinationVertex(),M.set_originVertex(_),b=L.EVertex(_),P=!0;break}}if(P)continue;for(v.set_fromVertex(d);null!=(p=v.next());)if(p=p.get_nextLeftEdge(),V.intersections2edges(p,M,O)){if(p.get_isConstrained()){for(_=this.splitEdge(p,O.x,O.y),v.set_fromVertex(d);null!=(p=v.next());)if(p.get_destinationVertex()==_){p.set_isConstrained(!0),p.get_oppositeEdge().set_isConstrained(!0),p.addFromConstraintSegment(y),p.get_oppositeEdge().fromConstraintSegments=p.fromConstraintSegments,y.addEdge(p);break}d.addFromConstraintSegment(y),M.set_originVertex(_),b=L.EVertex(_)}else S.push(p),A.unshift(p.get_nextLeftEdge()),F.push(p.get_prevLeftEdge()),p=p.get_oppositeEdge(),b=L.EEdge(p);break}break;case 1:if((E=(p=b[2]).get_nextLeftEdge()).get_destinationVertex()==f)return A.unshift(E.get_nextLeftEdge()),F.push(E),C=new m,k=new m,C.setDatas(_,k,null,null,!0,!0),k.setDatas(f,C,null,null,!0,!0),A.push(C),F.push(k),this.insertNewConstrainedEdge(y,C,S,A,F),y;if(V.distanceSquaredVertexToEdge(E.get_destinationVertex(),M)<=1e-4)A.unshift(E.get_nextLeftEdge()),F.push(E),C=new m,k=new m,C.setDatas(_,k,null,null,!0,!0),k.setDatas(E.get_destinationVertex(),C,null,null,!0,!0),A.push(C),F.push(k),this.insertNewConstrainedEdge(y,C,S,A,F),S.splice(0,S.length),A.splice(0,A.length),F.splice(0,F.length),_=E.get_destinationVertex(),M.set_originVertex(_),b=L.EVertex(_);else if(V.intersections2edges(E,M,O))if(E.get_isConstrained()){for(d=this.splitEdge(E,O.x,O.y),v.set_fromVertex(d);null!=(p=v.next());)p.get_destinationVertex()==A[0].get_originVertex()&&A.unshift(p),p.get_destinationVertex()==F[F.length-1].get_destinationVertex()&&F.push(p.get_oppositeEdge());C=new m,k=new m,C.setDatas(_,k,null,null,!0,!0),k.setDatas(d,C,null,null,!0,!0),A.push(C),F.push(k),this.insertNewConstrainedEdge(y,C,S,A,F),S.splice(0,S.length),A.splice(0,A.length),F.splice(0,F.length),_=d,M.set_originVertex(_),b=L.EVertex(_)}else S.push(E),A.unshift(E.get_nextLeftEdge()),p=E.get_oppositeEdge(),b=L.EEdge(p);else if(E=E.get_nextLeftEdge(),V.intersections2edges(E,M,O),E.get_isConstrained()){for(d=this.splitEdge(E,O.x,O.y),v.set_fromVertex(d);null!=(p=v.next());)p.get_destinationVertex()==A[0].get_originVertex()&&A.unshift(p),p.get_destinationVertex()==F[F.length-1].get_destinationVertex()&&F.push(p.get_oppositeEdge());C=new m,k=new m,C.setDatas(_,k,null,null,!0,!0),k.setDatas(d,C,null,null,!0,!0),A.push(C),F.push(k),this.insertNewConstrainedEdge(y,C,S,A,F),S.splice(0,S.length),A.splice(0,A.length),F.splice(0,F.length),_=d,M.set_originVertex(_),b=L.EVertex(_)}else S.push(E),F.push(E.get_prevLeftEdge()),p=E.get_oppositeEdge(),b=L.EEdge(p);break;case 2:b[2]}},insertNewConstrainedEdge:function(t,e,i,n,r){this._edges.push(e),this._edges.push(e.get_oppositeEdge()),e.addFromConstraintSegment(t),e.get_oppositeEdge().fromConstraintSegments=e.fromConstraintSegments,t.addEdge(e),e.get_originVertex().addFromConstraintSegment(t),e.get_destinationVertex().addFromConstraintSegment(t),this.untriangulate(i),this.triangulate(n,!0),this.triangulate(r,!0)},deleteConstraintSegment:function(t){for(var e,i=[],n=null,r=0,s=t.get_edges().length;r<s;){var o=r++;(n=t.get_edges()[o]).removeFromConstraintSegment(t),0==n.fromConstraintSegments.length&&(n.set_isConstrained(!1),n.get_oppositeEdge().set_isConstrained(!1)),(e=n.get_originVertex()).removeFromConstraintSegment(t),i.push(e)}(e=n.get_destinationVertex()).removeFromConstraintSegment(t),i.push(e);for(var a=0,h=i.length;a<h;){var u=a++;this.deleteVertex(i[u])}t.dispose()},check:function(){for(var t=0,e=this._edges.length;t<e;){var i=t++;if(null==this._edges[i].get_nextLeftEdge())return}},insertVertex:function(t,e){if(t<0||e<0||t>this._width||e>this._height)return null;this.__edgesToCheck.splice(0,this.__edgesToCheck.length);var i=V.locatePosition(t,e,this),n=null;switch(i[1]){case 0:n=i[2];break;case 1:var r=i[2];n=this.splitEdge(r,t,e);break;case 2:var s=i[2];n=this.splitFace(s,t,e)}return this.restoreAsDelaunay(),n},flipEdge:function(t){var e=t,i=t.get_oppositeEdge(),n=new m,r=new m,s=e.get_nextLeftEdge(),o=s.get_nextLeftEdge(),a=i.get_nextLeftEdge(),h=a.get_nextLeftEdge(),u=e.get_originVertex(),l=i.get_originVertex(),c=o.get_originVertex(),g=h.get_originVertex(),_=e.get_leftFace(),f=i.get_leftFace(),d=new M,p=new M;return this._edges.push(n),this._edges.push(r),this._faces.push(p),this._faces.push(d),n.setDatas(c,r,h,p,t.get_isReal(),t.get_isConstrained()),r.setDatas(g,n,o,d,t.get_isReal(),t.get_isConstrained()),p.setDatas(n),d.setDatas(r),l.get_edge()==i&&l.setDatas(s),u.get_edge()==e&&u.setDatas(a),s.set_nextLeftEdge(n),s.set_leftFace(p),o.set_nextLeftEdge(a),o.set_leftFace(d),a.set_nextLeftEdge(r),a.set_leftFace(d),h.set_nextLeftEdge(s),h.set_leftFace(p),e.dispose(),i.dispose(),this._edges.splice(this._edges.indexOf(e),1),this._edges.splice(this._edges.indexOf(i),1),_.dispose(),f.dispose(),this._faces.splice(this._faces.indexOf(_),1),this._faces.splice(this._faces.indexOf(f),1),r},splitEdge:function(t,e,i){this.__edgesToCheck.splice(0,this.__edgesToCheck.length);var n=t,r=n.get_oppositeEdge(),s=n.get_nextLeftEdge(),o=s.get_nextLeftEdge(),a=r.get_nextLeftEdge(),h=a.get_nextLeftEdge(),u=o.get_originVertex(),l=n.get_originVertex(),c=h.get_originVertex(),g=r.get_originVertex(),_=n.get_leftFace(),f=r.get_leftFace();if((l.get_pos().x-e)*(l.get_pos().x-e)+(l.get_pos().y-i)*(l.get_pos().y-i)<=1e-4)return l;if((g.get_pos().x-e)*(g.get_pos().x-e)+(g.get_pos().y-i)*(g.get_pos().y-i)<=1e-4)return g;var d=new E,p=new m,v=new m,x=new m,y=new m,w=new m,b=new m,C=new m,k=new m,P=new M,S=new M,L=new M,T=new M;if(this._vertices.push(d),this._edges.push(v),this._edges.push(p),this._edges.push(b),this._edges.push(w),this._edges.push(y),this._edges.push(x),this._edges.push(k),this._edges.push(C),this._faces.push(T),this._faces.push(L),this._faces.push(S),this._faces.push(P),d.setDatas(_.get_isReal()?v:y),d.get_pos().x=e,d.get_pos().y=i,V.projectOrthogonaly(d.get_pos(),n),v.setDatas(d,p,o,P,_.get_isReal()),p.setDatas(u,v,k,T,_.get_isReal()),b.setDatas(d,w,a,S,t.get_isReal(),t.get_isConstrained()),w.setDatas(l,b,v,P,t.get_isReal(),t.get_isConstrained()),y.setDatas(d,x,h,L,f.get_isReal()),x.setDatas(c,y,b,S,f.get_isReal()),k.setDatas(d,C,s,T,t.get_isReal(),t.get_isConstrained()),C.setDatas(g,k,y,L,t.get_isReal(),t.get_isConstrained()),P.setDatas(v,_.get_isReal()),S.setDatas(b,f.get_isReal()),L.setDatas(y,f.get_isReal()),T.setDatas(k,_.get_isReal()),l.get_edge()==n&&l.setDatas(w),g.get_edge()==r&&g.setDatas(C),o.set_nextLeftEdge(w),o.set_leftFace(P),a.set_nextLeftEdge(x),a.set_leftFace(S),h.set_nextLeftEdge(C),h.set_leftFace(L),s.set_nextLeftEdge(p),s.set_leftFace(T),n.get_isConstrained()){var A,F,O=n.fromConstraintSegments;w.fromConstraintSegments=O.slice(0),b.fromConstraintSegments=w.fromConstraintSegments,k.fromConstraintSegments=O.slice(0),C.fromConstraintSegments=k.fromConstraintSegments;for(var R=0,I=n.fromConstraintSegments.length;R<I;){var D=R++;-1!=(F=(A=n.fromConstraintSegments[D].get_edges()).indexOf(n))?(A.splice(F,1),A.splice(F,0,w),A.splice(F+1,0,k)):(F=A.indexOf(r),A.splice(F,1),A.splice(F,0,C),A.splice(F+1,0,b))}d.set_fromConstraintSegments(O.slice(0))}return n.dispose(),r.dispose(),this._edges.splice(this._edges.indexOf(n),1),this._edges.splice(this._edges.indexOf(r),1),_.dispose(),f.dispose(),this._faces.splice(this._faces.indexOf(_),1),this._faces.splice(this._faces.indexOf(f),1),this.__centerVertex=d,this.__edgesToCheck.push(o),this.__edgesToCheck.push(a),this.__edgesToCheck.push(h),this.__edgesToCheck.push(s),d},splitFace:function(t,e,i){this.__edgesToCheck.splice(0,this.__edgesToCheck.length);var n=t.get_edge(),r=n.get_nextLeftEdge(),s=r.get_nextLeftEdge(),o=n.get_originVertex(),a=r.get_originVertex(),h=s.get_originVertex(),u=new E,l=new m,c=new m,g=new m,_=new m,f=new m,d=new m,p=new M,v=new M,x=new M;return this._vertices.push(u),this._edges.push(l),this._edges.push(c),this._edges.push(g),this._edges.push(_),this._edges.push(f),this._edges.push(d),this._faces.push(p),this._faces.push(v),this._faces.push(x),u.setDatas(c),u.get_pos().x=e,u.get_pos().y=i,l.setDatas(o,c,d,x),c.setDatas(u,l,n,p),g.setDatas(a,_,c,p),_.setDatas(u,g,r,v),f.setDatas(h,d,_,v),d.setDatas(u,f,s,x),p.setDatas(c),v.setDatas(_),x.setDatas(d),n.set_nextLeftEdge(g),n.set_leftFace(p),r.set_nextLeftEdge(f),r.set_leftFace(v),s.set_nextLeftEdge(l),s.set_leftFace(x),t.dispose(),this._faces.splice(this._faces.indexOf(t),1),this.__centerVertex=u,this.__edgesToCheck.push(n),this.__edgesToCheck.push(r),this.__edgesToCheck.push(s),u},restoreAsDelaunay:function(){for(var t;this.__edgesToCheck.length>0;)!(t=this.__edgesToCheck.shift()).get_isReal()||t.get_isConstrained()||V.isDelaunay(t)||(t.get_nextLeftEdge().get_destinationVertex()==this.__centerVertex?(this.__edgesToCheck.push(t.get_nextRightEdge()),this.__edgesToCheck.push(t.get_prevRightEdge())):(this.__edgesToCheck.push(t.get_nextLeftEdge()),this.__edgesToCheck.push(t.get_prevLeftEdge())),this.flipEdge(t))},deleteVertex:function(t){var e,i,n=new Q;n.set_fromVertex(t),n.realEdgesOnly=!1;var r,s=[],o=[],a=!1,h=!1,u=[],l=[];if(e=0==t.get_fromConstraintSegments().length)for(;null!=(i=n.next());)s.push(i),o.push(i.get_nextLeftEdge());else{for(var c,g=0,_=t.get_fromConstraintSegments().length;g<_;){var f=g++;if((c=t.get_fromConstraintSegments()[f].get_edges())[0].get_originVertex()==t||c[c.length-1].get_destinationVertex()==t)return!1}for(var d=0;null!=(i=n.next());)if(s.push(i),i.get_isConstrained()&&++d>2)return!1;u=[],l=[];var p=null,v=null,x=new m,y=new m;this._edges.push(x),this._edges.push(y);for(var M,w=0,b=s.length;w<b;){(i=s[w++]).get_isConstrained()?null==p?(y.setDatas(i.get_destinationVertex(),x,null,null,!0,!0),u.push(x),u.push(i.get_nextLeftEdge()),l.push(y),p=i):null==v&&(x.setDatas(i.get_destinationVertex(),y,null,null,!0,!0),l.push(i.get_nextLeftEdge()),v=i):null==p?l.push(i.get_nextLeftEdge()):null==v?u.push(i.get_nextLeftEdge()):l.push(i.get_nextLeftEdge())}a=p.get_leftFace().get_isReal(),h=v.get_leftFace().get_isReal(),x.fromConstraintSegments=p.fromConstraintSegments.slice(0),y.fromConstraintSegments=x.fromConstraintSegments;for(var E=0,C=t.get_fromConstraintSegments().length;E<C;){var k=E++;if(-1!=(M=(c=t.get_fromConstraintSegments()[k].get_edges()).indexOf(p)))c.splice(M-1,2),c.splice(M-1,0,x);else{var P=c.indexOf(v)-1;c.splice(P,2),c.splice(P,0,y)}}}for(var S=0,L=s.length;S<L;){r=(i=s[S++]).get_leftFace(),this._faces.splice(this._faces.indexOf(r),1),r.dispose(),i.get_destinationVertex().set_edge(i.get_nextLeftEdge()),this._edges.splice(this._edges.indexOf(i.get_oppositeEdge()),1),i.get_oppositeEdge().dispose(),this._edges.splice(this._edges.indexOf(i),1),i.dispose()}return this._vertices.splice(this._vertices.indexOf(t),1),t.dispose(),e?this.triangulate(o,!0):(this.triangulate(u,a),this.triangulate(l,h)),!0},untriangulate:function(t){for(var e,i=new a,n=0,r=t.length;n<r;){var s=n++,o=(e=t[s]).get_originVertex();null==i.h[o.__id__]&&(e.get_originVertex().set_edge(e.get_prevLeftEdge().get_oppositeEdge()),i.set(e.get_originVertex(),!0));var h=e.get_destinationVertex();null==i.h[h.__id__]&&(e.get_destinationVertex().set_edge(e.get_nextLeftEdge()),i.set(e.get_destinationVertex(),!0)),this._faces.splice(this._faces.indexOf(e.get_leftFace()),1),e.get_leftFace().dispose(),s==t.length-1&&(this._faces.splice(this._faces.indexOf(e.get_rightFace()),1),e.get_rightFace().dispose())}for(var u=0,l=t.length;u<l;){e=t[u++],this._edges.splice(this._edges.indexOf(e.get_oppositeEdge()),1),this._edges.splice(this._edges.indexOf(e),1),e.get_oppositeEdge().dispose(),e.dispose()}},triangulate:function(t,e){if(!(t.length<2))if(2!=t.length)if(3==t.length){var i=new M;i.setDatas(t[0],e),this._faces.push(i),t[0].set_leftFace(i),t[1].set_leftFace(i),t[2].set_leftFace(i),t[0].set_nextLeftEdge(t[1]),t[1].set_nextLeftEdge(t[2]),t[2].set_nextLeftEdge(t[0])}else{for(var n,r,s,o=t[0],a=o.get_originVertex(),h=o.get_destinationVertex(),u=new T,l=!1,c=0,g=2,_=t.length;g<_;){var f=g++;if(n=t[f].get_originVertex(),1==V.getRelativePosition2(n.get_pos().x,n.get_pos().y,o)){c=f,l=!0,V.getCircumcenter(a.get_pos().x,a.get_pos().y,h.get_pos().x,h.get_pos().y,n.get_pos().x,n.get_pos().y,u),s=(a.get_pos().x-u.x)*(a.get_pos().x-u.x)+(a.get_pos().y-u.y)*(a.get_pos().y-u.y),s-=1e-4;for(var d=2,p=t.length;d<p;){var v=d++;if(v!=f&&((r=t[v].get_originVertex()).get_pos().x-u.x)*(r.get_pos().x-u.x)+(r.get_pos().y-u.y)*(r.get_pos().y-u.y)<s){l=!1;break}}if(l)break}}if(!l){for(var x=0,y=t.length;x<y;){var w=x++;t[w].get_originVertex().get_pos().x+" , ",t[w].get_originVertex().get_pos().y+" , ",t[w].get_destinationVertex().get_pos().x+" , ",t[w].get_destinationVertex().get_pos().y+" , "}c=2}var b,E,C,k,P=null,S=null,L=null;c<t.length-1&&(P=new m,S=new m,this._edges.push(P),this._edges.push(S),P.setDatas(a,S,null,null,e,!1),S.setDatas(t[c].get_originVertex(),P,null,null,e,!1),(E=t.slice(c)).push(P),this.triangulate(E,e)),c>2&&(L=new m,b=new m,this._edges.push(L),this._edges.push(b),L.setDatas(t[1].get_originVertex(),b,null,null,e,!1),b.setDatas(t[c].get_originVertex(),L,null,null,e,!1),(k=t.slice(1,c)).push(b),this.triangulate(k,e)),C=2==c?[o,t[1],S]:c==t.length-1?[o,L,t[c]]:[o,L,S],this.triangulate(C,e)}else t[0].get_originVertex().get_id(),t[0].get_destinationVertex().get_id(),t[1].get_originVertex().get_id(),t[1].get_destinationVertex().get_id()},findPositionFromBounds:function(t,e){return t<=0?e<=0?1:e>=this._height?7:8:t>=this._width?e<=0?3:e>=this._height?5:4:e<=0?2:e>=this._height?6:0},debug:function(){for(var t=0,e=this._vertices.length;t<e;){var i=t++;this._vertices[i].get_id(),this._vertices[i].get_edge().get_id(),r.string(this._vertices[i].get_edge()),r.string(this._vertices[i].get_edge().get_isReal())}for(var n=0,s=this._edges.length;n<s;){var o=n++;r.string(this._edges[o]),this._edges[o].get_id(),r.string(this._edges[o].get_isReal()),r.string(this._edges[o].get_nextLeftEdge()),r.string(this._edges[o].get_oppositeEdge())}},getVerticesAndEdges:function(){var t,e,i={vertices:[],edges:[]},n=new z;n.set_fromMesh(this);for(var r=new K,s=new a;null!=(t=n.next());)if(s.set(t,!0),!(t.get_pos().x<0||t.get_pos().x>this.get_width()||t.get_pos().y<0||t.get_pos().y>this.get_height()))for(i.vertices.push(t),r.set_fromVertex(t);null!=(e=r.next());){var o=e.get_originVertex();s.h[o.__id__]||i.edges.push(e)}return i},vertexIsInsideAABB:function(t,e){return!(t.get_pos().x<0||t.get_pos().x>e.get_width()||t.get_pos().y<0||t.get_pos().y>e.get_height())},__class__:w};var b=t.hxDaedalus.data.Object=function(){this._id=b.INC,b.INC++,this._pivotX=0,this._pivotY=0,this._matrix=new A,this._scaleX=1,this._scaleY=1,this._rotation=0,this._x=0,this._y=0,this._coordinates=[],this._hasChanged=!1};b.__name__=!0,b.prototype={get_id:function(){return this._id},dispose:function(){this._matrix=null,this._coordinates=null,this._constraintShape=null},updateValuesFromMatrix:function(){},updateMatrixFromValues:function(){this._matrix.identity(),this._matrix.translate(-this._pivotX,-this._pivotY),this._matrix.scale(this._scaleX,this._scaleY),this._matrix.rotate(this._rotation),this._matrix.translate(this._x,this._y)},get_pivotX:function(){return this._pivotX},set_pivotX:function(t){return this._pivotX=t,this._hasChanged=!0,t},get_pivotY:function(){return this._pivotY},set_pivotY:function(t){return this._pivotY=t,this._hasChanged=!0,t},get_scaleX:function(){return this._scaleX},set_scaleX:function(t){return this._scaleX!=t&&(this._scaleX=t,this._hasChanged=!0),t},get_scaleY:function(){return this._scaleY},set_scaleY:function(t){return this._scaleY!=t&&(this._scaleY=t,this._hasChanged=!0),t},get_rotation:function(){return this._rotation},set_rotation:function(t){return this._rotation!=t&&(this._rotation=t,this._hasChanged=!0),t},get_x:function(){return this._x},set_x:function(t){return this._x!=t&&(this._x=t,this._hasChanged=!0),t},get_y:function(){return this._y},set_y:function(t){return this._y!=t&&(this._y=t,this._hasChanged=!0),t},get_matrix:function(){return this._matrix},set_matrix:function(t){return this._matrix=t,this._hasChanged=!0,t},get_coordinates:function(){return this._coordinates},set_coordinates:function(t){return this._coordinates=t,this._hasChanged=!0,t},get_constraintShape:function(){return this._constraintShape},set_constraintShape:function(t){return this._constraintShape=t,this._hasChanged=!0,t},get_hasChanged:function(){return this._hasChanged},set_hasChanged:function(t){return this._hasChanged=t,t},get_edges:function(){for(var t=[],e=this._constraintShape.segments,i=0,n=e.length;i<n;)for(var r=i++,s=0,o=e[r].get_edges().length;s<o;){var a=s++;t.push(e[r].get_edges()[a])}return t},__class__:b};var E=t.hxDaedalus.data.Vertex=function(){this.colorDebug=-1,this._id=E.INC,E.INC++,this._pos=new T,this._fromConstraintSegments=[]};E.__name__=!0,E.prototype={get_id:function(){return this._id},get_isReal:function(){return this._isReal},get_pos:function(){return this._pos},get_fromConstraintSegments:function(){return this._fromConstraintSegments},set_fromConstraintSegments:function(t){return this._fromConstraintSegments=t},setDatas:function(t,e){null==e&&(e=!0),this._isReal=e,this._edge=t},addFromConstraintSegment:function(t){-1==this._fromConstraintSegments.indexOf(t)&&this._fromConstraintSegments.push(t)},removeFromConstraintSegment:function(t){var e=this._fromConstraintSegments.indexOf(t);-1!=e&&this._fromConstraintSegments.splice(e,1)},dispose:function(){this._pos=null,this._edge=null,this._fromConstraintSegments=null},get_edge:function(){return this._edge},set_edge:function(t){return this._edge=t},toString:function(){return"ver_id "+this._id},__class__:E};var C=t.hxDaedalus.data.graph.Graph=function(){this._id=C.INC,C.INC++};C.__name__=!0,C.prototype={get_id:function(){return this._id},get_edge:function(){return this._edge},get_node:function(){return this._node},dispose:function(){for(;null!=this._node;)this.deleteNode(this._node)},insertNode:function(){var t=new P;return null!=this._node&&(t.set_next(this._node),this._node.set_prev(t)),this._node=t,t},deleteNode:function(t){for(;null!=t.get_outgoingEdge();)null!=t.get_outgoingEdge().get_oppositeEdge()&&this.deleteEdge(t.get_outgoingEdge().get_oppositeEdge()),this.deleteEdge(t.get_outgoingEdge());for(var e,i=this._node;null!=i;)null!=(e=i.get_successorNodes().h[t.__id__])&&this.deleteEdge(e),i=i.get_next();this._node==t?null!=t.get_next()?(t.get_next().set_prev(null),this._node=t.get_next()):this._node=null:null!=t.get_next()?(t.get_prev().set_next(t.get_next()),t.get_next().set_prev(t.get_prev())):t.get_prev().set_next(null),t.dispose()},insertEdge:function(t,e){if(null!=t.get_successorNodes().h[e.__id__])return null;var i=new k;null!=this._edge&&(this._edge.set_prev(i),i.set_next(this._edge)),this._edge=i,i.set_sourceNode(t),i.set_destinationNode(e),t.get_successorNodes().set(e,i),null!=t.get_outgoingEdge()?(t.get_outgoingEdge().set_rotPrevEdge(i),i.set_rotNextEdge(t.get_outgoingEdge()),t.set_outgoingEdge(i)):t.set_outgoingEdge(i);var n=e.get_successorNodes().h[t.__id__];return null!=n&&(i.set_oppositeEdge(n),n.set_oppositeEdge(i)),i},deleteEdge:function(t){this._edge==t?null!=t.get_next()?(t.get_next().set_prev(null),this._edge=t.get_next()):this._edge=null:null!=t.get_next()?(t.get_prev().set_next(t.get_next()),t.get_next().set_prev(t.get_prev())):t.get_prev().set_next(null),t.get_sourceNode().get_outgoingEdge()==t?null!=t.get_rotNextEdge()?(t.get_rotNextEdge().set_rotPrevEdge(null),t.get_sourceNode().set_outgoingEdge(t.get_rotNextEdge())):t.get_sourceNode().set_outgoingEdge(null):null!=t.get_rotNextEdge()?(t.get_rotPrevEdge().set_rotNextEdge(t.get_rotNextEdge()),t.get_rotNextEdge().set_rotPrevEdge(t.get_rotPrevEdge())):t.get_rotPrevEdge().set_rotNextEdge(null),t.dispose()},__class__:C};var k=t.hxDaedalus.data.graph.GraphEdge=function(){this._id=k.INC,k.INC++};k.__name__=!0,k.prototype={get_id:function(){return this._id},dispose:function(){},get_prev:function(){return this._prev},set_prev:function(t){return this._prev=t,t},get_next:function(){return this._next},set_next:function(t){return this._next=t,t},get_rotPrevEdge:function(){return this._rotPrevEdge},set_rotPrevEdge:function(t){return this._rotPrevEdge=t,t},get_rotNextEdge:function(){return this._rotNextEdge},set_rotNextEdge:function(t){return this._rotNextEdge=t,t},get_oppositeEdge:function(){return this._oppositeEdge},set_oppositeEdge:function(t){return this._oppositeEdge=t,t},get_sourceNode:function(){return this._sourceNode},set_sourceNode:function(t){return this._sourceNode=t,t},get_destinationNode:function(){return this._destinationNode},set_destinationNode:function(t){return this._destinationNode=t,t},get_data:function(){return this._data},set_data:function(t){return this._data=t,t},__class__:k};var P=t.hxDaedalus.data.graph.GraphNode=function(){this._id=P.INC,P.INC++,this._successorNodes=new a};P.__name__=!0,P.prototype={get_id:function(){return this._id},dispose:function(){this._prev=null,this._next=null,this._outgoingEdge=null,this._successorNodes=null,this._data=null},get_prev:function(){return this._prev},set_prev:function(t){return this._prev=t,t},get_next:function(){return this._next},set_next:function(t){return this._next=t,t},get_outgoingEdge:function(){return this._outgoingEdge},set_outgoingEdge:function(t){return this._outgoingEdge=t,t},get_successorNodes:function(){return this._successorNodes},set_successorNodes:function(t){return this._successorNodes=t,t},get_data:function(){return this._data},set_data:function(t){return this._data=t,t},__class__:P};var S=t.hxDaedalus.data.math.EdgeData=function(){};S.__name__=!0,S.prototype={__class__:S};var L={__ename__:!0,__constructs__:["EVertex","EEdge","EFace","ENull"],EVertex:function(t){var e=["EVertex",0,t];return e.__enum__=L,e.toString=i,e},EEdge:function(t){var e=["EEdge",1,t];return e.__enum__=L,e.toString=i,e},EFace:function(t){var e=["EFace",2,t];return e.__enum__=L,e.toString=i,e},ENull:["ENull",3]};L.ENull.toString=i,L.ENull.__enum__=L;var T=t.hxDaedalus.data.math.Point2D=function(t,e){null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e};T.__name__=!0,T.prototype={transform:function(t){t.tranform(this)},setXY:function(t,e){this.x=t,this.y=e},clone:function(){return new T(this.x,this.y)},substract:function(t){this.x-=t.x,this.y-=t.y},get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){var t=this.get_length();this.x/=t,this.y/=t},scale:function(t){this.x*=t,this.y*=t},distanceTo:function(t){var e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)},__class__:T};var V=t.hxDaedalus.data.math.Geom2D=function(){};V.__name__=!0,V.locatePosition=function(t,e,i){null==V._randGen&&(V._randGen=new R),V._randGen.set_seed(10*t+4*e|0),V.__samples.splice(0,V.__samples.length);var n=0|Math.pow(i._vertices.length,.3333333333333333);V._randGen.rangeMin=0,V._randGen.rangeMax=i._vertices.length-1;for(var r,s,o,h=0,u=n;h<u;){h++;var l=V._randGen.next();l<0||i._vertices.length,i._vertices,i._vertices.length;V.__samples.push(i._vertices[l])}for(var c,g=1/0,_=null,f=0,d=n;f<d;){var p=f++;(o=((s=(r=V.__samples[p]).get_pos()).x-t)*(s.x-t)+(s.y-e)*(s.y-e))<g&&(g=o,_=r)}var v=new q;v.set_fromVertex(_),c=v.next();for(var x,y,m=new a,M=new Y,w=L.ENull,b=0;;){var E;if(m.h[c.__id__])E=!0;else E=3==(w=V.isInFace(t,e,c))[1];if(!E)break;++b;for(M.set_fromFace(c);;){if(null==(x=M.next()))return L.ENull;if(1!=(y=V.getRelativePosition(t,e,x))&&0!=y)break}c=x.get_rightFace()}return w},V.isCircleIntersectingAnyConstraint=function(t,e,i,n){if(t<=0||t>=n.get_width()||e<=0||e>=n.get_height())return!0;var r,s=V.locatePosition(t,e,n);switch(s[1]){case 0:r=s[2].get_edge().get_leftFace();break;case 1:r=s[2].get_leftFace();break;case 2:r=s[2];break;case 3:r=null}var o,h=i*i;if(((o=r.get_edge().get_originVertex().get_pos()).x-t)*(o.x-t)+(o.y-e)*(o.y-e)<=h)return!0;if(((o=r.get_edge().get_nextLeftEdge().get_originVertex().get_pos()).x-t)*(o.x-t)+(o.y-e)*(o.y-e)<=h)return!0;if(((o=r.get_edge().get_nextLeftEdge().get_nextLeftEdge().get_originVertex().get_pos()).x-t)*(o.x-t)+(o.y-e)*(o.y-e)<=h)return!0;var u,l,c,g=[];g.push(r.get_edge()),g.push(r.get_edge().get_nextLeftEdge()),g.push(r.get_edge().get_nextLeftEdge().get_nextLeftEdge());for(var _=new a;g.length>0;)if(u=g.pop(),_.set(u,!0),l=u.get_originVertex().get_pos(),c=u.get_destinationVertex().get_pos(),V.intersectionsSegmentCircle(l.x,l.y,c.x,c.y,t,e,i)){if(u.get_isConstrained())return!0;var f,d;if(u=u.get_oppositeEdge().get_nextLeftEdge(),_.h[u.__id__])f=!1;else{var p=u.get_oppositeEdge();f=!_.h[p.__id__]}if(!!(!!f&&-1==g.indexOf(u))&&-1==g.indexOf(u.get_oppositeEdge())&&g.push(u),u=u.get_nextLeftEdge(),_.h[u.__id__])d=!1;else{var v=u.get_oppositeEdge();d=!_.h[v.__id__]}!!(!!d&&-1==g.indexOf(u))&&-1==g.indexOf(u.get_oppositeEdge())&&g.push(u)}return!1},V.getDirection=function(t,e,i,n,r,s){var o=(r-t)*(n-e)+(s-e)*(-i+t);return 0==o?0:o>0?1:-1},V.getDirection2=function(t,e,i,n,r,s){var o=(r-t)*(n-e)+(s-e)*(-i+t);return 0==o?0:o>0?V.distanceSquaredPointToLine(r,s,t,e,i,n)<=1e-4?0:1:V.distanceSquaredPointToLine(r,s,t,e,i,n)<=1e-4?0:-1},V.getRelativePosition=function(t,e,i){return V.getDirection(i.get_originVertex().get_pos().x,i.get_originVertex().get_pos().y,i.get_destinationVertex().get_pos().x,i.get_destinationVertex().get_pos().y,t,e)},V.getRelativePosition2=function(t,e,i){return V.getDirection2(i.get_originVertex().get_pos().x,i.get_originVertex().get_pos().y,i.get_destinationVertex().get_pos().x,i.get_destinationVertex().get_pos().y,t,e)},V.isInFace=function(t,e,i){var n=L.ENull,r=i.get_edge(),s=r.get_nextLeftEdge(),o=s.get_nextLeftEdge();if(V.getRelativePosition(t,e,r)>=0&&V.getRelativePosition(t,e,s)>=0&&V.getRelativePosition(t,e,o)>=0){var a=r.get_originVertex(),h=s.get_originVertex(),u=o.get_originVertex(),l=a.get_pos().x,c=a.get_pos().y,g=h.get_pos().x,_=h.get_pos().y,f=u.get_pos().x,d=u.get_pos().y,p=(t-l)*(g-l)+(e-c)*(_-c),v=(t-g)*(f-g)+(e-_)*(d-_),x=(t-f)*(l-f)+(e-d)*(c-d),y=(g-t)*(g-t)+(_-e)*(_-e)-v*v/((f-g)*(f-g)+(d-_)*(d-_))<=1e-4,m=(f-t)*(f-t)+(d-e)*(d-e)-x*x/((l-f)*(l-f)+(c-d)*(c-d))<=1e-4;n=(l-t)*(l-t)+(c-e)*(c-e)-p*p/((g-l)*(g-l)+(_-c)*(_-c))<=1e-4?m?L.EVertex(a):y?L.EVertex(h):L.EEdge(r):y?m?L.EVertex(u):L.EEdge(s):m?L.EEdge(o):L.EFace(i)}return n},V.clipSegmentByTriangle=function(t,e,i,n,r,s,o,a,h,u,l,c){var g,_,f,d,p,v;if(g=V.getDirection(r,s,o,a,t,e),_=V.getDirection(r,s,o,a,i,n),g<=0&&_<=0)return!1;if(f=V.getDirection(o,a,h,u,t,e),d=V.getDirection(o,a,h,u,i,n),f<=0&&d<=0)return!1;if(p=V.getDirection(h,u,r,s,t,e),v=V.getDirection(h,u,r,s,i,n),p<=0&&v<=0)return!1;if(g>=0&&f>=0&&p>=0&&_>=0&&d>=0&&v>=0)return l.x=t,l.y=e,c.x=i,c.y=n,!0;var x=0;return V.intersections2segments(t,e,i,n,r,s,o,a,l,null)&&++x,0==x?V.intersections2segments(t,e,i,n,o,a,h,u,l,null)&&++x:V.intersections2segments(t,e,i,n,o,a,h,u,c,null)&&(-.01>l.x-c.x||l.x-c.x>.01||-.01>l.y-c.y||l.y-c.y>.01)&&++x,0==x?V.intersections2segments(t,e,i,n,h,u,r,s,l,null)&&++x:1==x&&V.intersections2segments(t,e,i,n,h,u,r,s,c,null)&&(-.01>l.x-c.x||l.x-c.x>.01||-.01>l.y-c.y||l.y-c.y>.01)&&++x,1==x&&(g>=0&&f>=0&&p>=0?(c.x=t,c.y=e):_>=0&&d>=0&&v>=0?(c.x=i,c.y=n):x=0),x>0},V.isSegmentIntersectingTriangle=function(t,e,i,n,r,s,o,a,h,u){var l,c,g,_,f,d,p,v;return l=V.getDirection(r,s,o,a,t,e),c=V.getDirection(r,s,o,a,i,n),!(l<=0&&c<=0)&&(g=V.getDirection(o,a,h,u,t,e),_=V.getDirection(o,a,h,u,i,n),!(g<=0&&_<=0)&&(f=V.getDirection(h,u,r,s,t,e),d=V.getDirection(h,u,r,s,i,n),!(f<=0&&d<=0)&&(1==l&&1==g&&1==f||(1==l&&1==g&&1==f||((1==l&&c<=0||l<=0&&1==c)&&(p=V.getDirection(t,e,i,n,r,s),v=V.getDirection(t,e,i,n,o,a),1==p&&v<=0||p<=0&&1==v)||((1==g&&_<=0||g<=0&&1==_)&&(p=V.getDirection(t,e,i,n,o,a),v=V.getDirection(t,e,i,n,h,u),1==p&&v<=0||p<=0&&1==v)||(1==f&&d<=0||f<=0&&1==d)&&(p=V.getDirection(t,e,i,n,h,u),v=V.getDirection(t,e,i,n,r,s),1==p&&v<=0||p<=0&&1==v)))))))},V.isDelaunay=function(t){var e=t.get_originVertex(),i=t.get_destinationVertex(),n=t.get_nextLeftEdge().get_destinationVertex(),r=t.get_nextRightEdge().get_destinationVertex();V.getCircumcenter(n.get_pos().x,n.get_pos().y,e.get_pos().x,e.get_pos().y,i.get_pos().x,i.get_pos().y,V.__circumcenter);var s=(n.get_pos().x-V.__circumcenter.x)*(n.get_pos().x-V.__circumcenter.x)+(n.get_pos().y-V.__circumcenter.y)*(n.get_pos().y-V.__circumcenter.y);return(r.get_pos().x-V.__circumcenter.x)*(r.get_pos().x-V.__circumcenter.x)+(r.get_pos().y-V.__circumcenter.y)*(r.get_pos().y-V.__circumcenter.y)>=s},V.getCircumcenter=function(t,e,i,n,r,s,o){null==o&&(o=new T);var a=(t+i)/2,h=(e+n)/2,u=(a*(t-r)+(h-(e+s)/2)*(e-s)+(t+r)/2*(r-t))/(t*(s-n)+i*(e-s)+r*(n-e));return o.x=a+u*(n-e),o.y=h-u*(i-t),o},V.intersections2segments=function(t,e,i,n,r,s,o,a,h,u,l){null==l&&(l=!1);var c,g=0,_=0,f=(t-i)*(s-a)+(n-e)*(r-o);return 0==f?c=!1:(c=!0,l&&null==h&&null==u||(g=(t*(s-a)+e*(o-r)+r*a-s*o)/f,_=(t*(s-n)+e*(i-r)-i*s+n*r)/f,l||0<=g&&g<=1&&0<=_&&_<=1||(c=!1))),c&&(null!=h&&(h.x=t+g*(i-t),h.y=e+g*(n-e)),null!=u&&(u.push(g),u.push(_))),c},V.intersections2edges=function(t,e,i,n,r){return null==r&&(r=!1),V.intersections2segments(t.get_originVertex().get_pos().x,t.get_originVertex().get_pos().y,t.get_destinationVertex().get_pos().x,t.get_destinationVertex().get_pos().y,e.get_originVertex().get_pos().x,e.get_originVertex().get_pos().y,e.get_destinationVertex().get_pos().x,e.get_destinationVertex().get_pos().y,i,n,r)},V.isConvex=function(t){var e,i,n=!0;return e=t.get_nextLeftEdge().get_oppositeEdge(),i=t.get_nextRightEdge().get_destinationVertex(),-1!=V.getRelativePosition(i.get_pos().x,i.get_pos().y,e)?n=!1:(e=t.get_prevRightEdge(),i=t.get_prevLeftEdge().get_originVertex(),-1!=V.getRelativePosition(i.get_pos().x,i.get_pos().y,e)&&(n=!1)),n},V.projectOrthogonaly=function(t,e){var i=e.get_originVertex().get_pos().x,n=e.get_originVertex().get_pos().y,r=e.get_destinationVertex().get_pos().x,s=e.get_destinationVertex().get_pos().y,o=t.x,a=t.y,h=(i*i-i*r-i*o+n*n-n*s-n*a+r*o+s*a)/(i*i-2*i*r+n*n-2*n*s+r*r+s*s);t.x=i+h*(r-i),t.y=n+h*(s-n)},V.intersections2Circles=function(t,e,i,n,r,s,o){var a=(n-t)*(n-t)+(r-e)*(r-e);if((t!=n||e!=r)&&a<=(i+s)*(i+s)&&a>=(i-s)*(i-s)){var h=Math.sqrt(((i+s)*(i+s)-a)*(a-(s-i)*(s-i))),u=(t+n)/2+(n-t)*(i*i-s*s)/(2*a),l=(e+r)/2+(r-e)*(i*i-s*s)/(2*a),c=(r-e)/(2*a),g=(n-t)/(2*a);if(null!=o)for(var _=0,f=[u+c*h,l-g*h,u-c*h,l+g*h];_<f.length;){var d=f[_];++_,o.push(d)}return!0}return!1},V.intersectionsSegmentCircle=function(t,e,i,n,r,s,o,a){var h,u,l,c=t*t,g=e*e,_=n*n-2*n*e+g+i*i-2*i*t+c,f=2*e*s-2*c+2*n*e-2*g+2*i*t-2*i*r+2*t*r-2*n*s,d=f*f-4*_*(g+s*s+r*r-2*e*s-2*t*r+c-o*o);if(d<0)return!1;if(0==d){if((u=-f/(2*_))<0||u>1)return!1;if(null!=a)for(var p=0,v=[t+u*(i-t),e+u*(n-e),u];p<v.length;){var x=v[p];++p,a.push(x)}return!0}l=(-f-(h=Math.sqrt(d)))/(2*_);var y=!1;if(0<=(u=(-f+h)/(2*_))&&u<=1){if(null!=a)for(var m=0,M=[t+u*(i-t),e+u*(n-e),u];m<M.length;){var w=M[m];++m,a.push(w)}y=!0}if(0<=l&&l<=1){if(null!=a)for(var b=0,E=[t+l*(i-t),e+l*(n-e),l];b<E.length;){var C=E[b];++b,a.push(C)}y=!0}return y},V.intersectionsLineCircle=function(t,e,i,n,r,s,o,a){var h,u,l,c=t*t,g=e*e,_=n*n-2*n*e+g+i*i-2*i*t+c,f=2*e*s-2*c+2*n*e-2*g+2*i*t-2*i*r+2*t*r-2*n*s,d=f*f-4*_*(g+s*s+r*r-2*e*s-2*t*r+c-o*o);if(d<0)return!1;if(0==d)for(var p=0,v=[t+(u=-f/(2*_))*(i-t),e+u*(n-e),u];p<v.length;){var x=v[p];++p,a.push(x)}else if(d>0)for(var y=0,m=[t+(u=(-f+(h=Math.sqrt(d)))/(2*_))*(i-t),e+u*(n-e),u,t+(l=(-f-h)/(2*_))*(i-t),e+l*(n-e),l];y<m.length;){var M=m[y];++y,a.push(M)}return!0},V.tangentsPointToCircle=function(t,e,i,n,r,s){var o=(t+i)/2,a=(e+n)/2,h=.5*Math.sqrt((t-i)*(t-i)+(e-n)*(e-n));return V.intersections2Circles(o,a,h,i,n,r,s)},V.tangentsCrossCircleToCircle=function(t,e,i,n,r,s){var o=Math.sqrt((e-n)*(e-n)+(i-r)*(i-r)),a=o/4,h=e+(n-e)/4,u=i+(r-i)/4;if(V.intersections2Circles(e,i,t,h,u,a,s)){for(var l=s[0],c=s[1],g=(e+n)/2,_=(i+r)/2,f=((l-g)*(r-i)+(c-_)*(-n+e))/(o*o),d=2*(g+f*(r-i))-l,p=2*(_-f*(n-e))-c,v=0,x=[d+s[2]-l,s[3]+p-c,d,p];v<x.length;){var y=x[v];++v,s.push(y)}return!0}return!1},V.tangentsParalCircleToCircle=function(t,e,i,n,r,s){for(var o=Math.sqrt((e-n)*(e-n)+(i-r)*(i-r)),a=e+t*(r-i)/o,h=i+t*(-n+e)/o,u=2*e-a,l=2*i-h,c=0,g=[a,h,u,l,u+n-e,l+r-i,a+n-e,h+r-i];c<g.length;){var _=g[c];++c,s.push(_)}},V.distanceSquaredPointToLine=function(t,e,i,n,r,s){var o=(t-i)*(r-i)+(e-n)*(s-n);return(i-t)*(i-t)+(n-e)*(n-e)-o*o/((r-i)*(r-i)+(s-n)*(s-n))},V.distanceSquaredPointToSegment=function(t,e,i,n,r,s){var o=(r-i)*(r-i)+(s-n)*(s-n),a=((t-i)*(r-i)+(e-n)*(s-n))/o;return a<0?(t-i)*(t-i)+(e-n)*(e-n):a<=1?(i-t)*(i-t)+(n-e)*(n-e)-a*a*o:(t-r)*(t-r)+(e-s)*(e-s)},V.distanceSquaredVertexToEdge=function(t,e){return V.distanceSquaredPointToSegment(t.get_pos().x,t.get_pos().y,e.get_originVertex().get_pos().x,e.get_originVertex().get_pos().y,e.get_destinationVertex().get_pos().x,e.get_destinationVertex().get_pos().y)},V.pathLength=function(t){for(var e,i,n,r,s=0,o=t[0],a=t[1],h=2;h<t.length;)n=(e=t[h])-o,r=(i=t[h+1])-a,s+=Math.sqrt(n*n+r*r),o=e,a=i,h+=2;return s},V.prototype={__class__:V};var A=t.hxDaedalus.data.math.Matrix2D=function(t,e,i,n,r,s){null==s&&(s=0),null==r&&(r=0),null==n&&(n=1),null==i&&(i=0),null==e&&(e=0),null==t&&(t=1),this.a=t,this.b=e,this.c=i,this.d=n,this.e=r,this.f=s};A.__name__=!0,A.prototype={identity:function(){this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0},translate:function(t,e){this.e+=t,this.f+=e},scale:function(t,e){this.a*=t,this.b*=e,this.c*=t,this.d*=e,this.e*=t,this.f*=e},rotate:function(t){var e=Math.cos(t),i=Math.sin(t),n=this.a*e+this.b*-i,r=this.a*i+this.b*e,s=this.c*e+this.d*-i,o=this.c*i+this.d*e,a=this.e*e+this.f*-i,h=this.e*i+this.f*e;this.a=n,this.b=r,this.c=s,this.d=o,this.e=a,this.f=h},clone:function(){return new A(this.a,this.b,this.c,this.d,this.e,this.f)},tranform:function(t){var e=this.a*t.x+this.c*t.y+this.e,i=this.b*t.x+this.d*t.y+this.f;t.x=e,t.y=i},transformX:function(t,e){return this.a*t+this.c*e+this.e},transformY:function(t,e){return this.b*t+this.d*e+this.f},concat:function(t){var e=this.a*t.a+this.b*t.c,i=this.a*t.b+this.b*t.d,n=this.c*t.a+this.d*t.c,r=this.c*t.b+this.d*t.d,s=this.e*t.a+this.f*t.c+t.e,o=this.e*t.b+this.f*t.d+t.f;this.a=e,this.b=i,this.c=n,this.d=r,this.e=s,this.f=o},__class__:A};var F=t.hxDaedalus.data.math.NodeData=function(){};F.__name__=!0,F.prototype={__class__:F};var O=t.hxDaedalus.data.math.Potrace=function(){};O.__name__=!0,O.buildShapes=function(t,e,i){for(var n=[],r=new h,s=1,o=t.height-1;s<o;)for(var a=s++,u=0,l=t.width-1;u<l;){var c=u++;if(16777215==J.getPixel(t,c,a)&&J.getPixel(t,c+1,a)<16777215){var g=c+1+"_"+a;(null!=Mt[g]?r.getReserved(g):r.h[g])||n.push(O.buildShape(t,a,c+1,r,e,i))}}return n},O.buildShape=function(t,e,i,n,r,s){var o=i,a=e,h=[o,a],u=o+"_"+a;null!=Mt[u]?n.setReserved(u,!0):n.h[u]=!0;for(var l,c,g=new T(0,1),_=new T,f=-1;null!=r&&J.setPixel32(r,i,e,-65536),l=e+g.x+g.y|0,c=i+g.x-g.y|0,J.getPixel(t,c,l)<16777215?(_.x=-g.y,_.y=g.x):(l=e+g.y|0,c=i+g.x|0,J.getPixel(t,c,l)<16777215?(_.x=g.x,_.y=g.y):(l=e,c=i,_.x=g.y,_.y=-g.x)),o+=g.x,a+=g.y,o!=h[0]||a!=h[1];){h.push(o),h.push(a);var d=o+"_"+a;if(null!=Mt[d]?n.setReserved(d,!0):n.h[d]=!0,e=l,i=c,g.x=_.x,g.y=_.y,0==--f)break}if(null!=s){s.graphics.lineStyle(.5,65280,1),s.graphics.moveTo(h[0],h[1]);for(var p=2;p<h.length;)s.graphics.lineTo(h[p],h[p+1]),p+=2;s.graphics.lineTo(h[0],h[1])}return h},O.buildGraph=function(t){var e,i,n,r,s,o,a,h,u,l,c,g=new C;for(e=0;e<t.length;){(i=g.insertNode()).set_data(new F),i.get_data().index=e;var _=t[e],f=t[e+1];i.get_data().point=new T(_,f),e+=2}for(n=g.get_node();null!=n;){for(r=null!=n.get_next()?n.get_next():g.get_node();r!=n;){for(u=!0,s=null!=n.get_next()?n.get_next():g.get_node(),h=2,a=0;s!=r;){if((o=V.distanceSquaredPointToSegment(s.get_data().point.x,s.get_data().point.y,n.get_data().point.x,n.get_data().point.y,r.get_data().point.x,r.get_data().point.y))<0&&(o=0),o>=O.maxDistance){u=!1;break}++h,a+=o,s=null!=s.get_next()?s.get_next():g.get_node()}if(!u)break;l=g.insertEdge(n,r),(c=new S).sumDistancesSquared=a,c.length=n.get_data().point.distanceTo(r.get_data().point),c.nodesCount=h,l.set_data(c),r=null!=r.get_next()?r.get_next():g.get_node()}n=n.get_next()}return g},O.buildPolygon=function(t,e){var i,n,r,s,o=[],a=2147483647,h=null;for(i=t.get_node();i.get_data().index<a;){for(a=i.get_data().index,o.push(i.get_data().point.x),o.push(i.get_data().point.y),s=0,n=i.get_outgoingEdge();null!=n;)(r=n.get_data().nodesCount-n.get_data().length*Math.sqrt(n.get_data().sumDistancesSquared/n.get_data().nodesCount))>s&&(s=r,h=n),n=n.get_rotNextEdge();i=h.get_destinationNode()}if(0==V.getDirection(o[o.length-2],o[o.length-1],o[0],o[1],o[2],o[3])&&(o.shift(),o.shift()),null!=e){e.graphics.lineStyle(.5,255),e.graphics.moveTo(o[0],o[1]);for(var u=2;u<o.length;)e.graphics.lineTo(o[u],o[u+1]),u+=2;e.graphics.lineTo(o[0],o[1])}return o},O.prototype={__class__:O};var R=t.hxDaedalus.data.math.RandGenerator=function(t,e,i){null==i&&(i=1),null==e&&(e=0),null==t&&(t=1234),this._originalSeed=this._currSeed=t,this.rangeMin=e,this.rangeMax=i,this._numIter=0};R.__name__=!0,R.prototype={set_seed:function(t){return this._originalSeed=this._currSeed=t,t},get_seed:function(){return this._originalSeed},reset:function(){this._currSeed=this._originalSeed,this._numIter=0},next:function(){var t=1*this._currSeed;for(this._tempString=r.string(t*t);this._tempString.length<8;)this._tempString="0"+this._tempString;this._currSeed=r.parseInt(n.substr(this._tempString,1,5));var e=Math.round(this.rangeMin+this._currSeed/99999*(this.rangeMax-this.rangeMin));return 0==this._currSeed&&(this._currSeed=this._originalSeed+this._numIter),this._numIter++,200==this._numIter&&this.reset(),e},nextInRange:function(t,e){return this.rangeMin=t,this.rangeMax=e,this.next()},shuffle:function(t){for(var e=t.length;e>0;){var i=this.nextInRange(0,e-1),n=t[--e];t[e]=t[i],t[i]=n}},__class__:R};var I=t.hxDaedalus.data.math.ShapeSimplifier=function(){};I.__name__=!0,I.simplify=function(t,e){null==e&&(e=1);var i=t.length;if(i<=4||e<1)return[].concat(t);for(var n=t[0],r=t[1],s=t[i-2],o=t[i-1],a=-1,h=0,u=1,l=i>>1;u<l;){var c=u++,g=V.distanceSquaredPointToSegment(t[c<<1],t[1+(c<<1)],n,r,s,o);g>h&&(h=g,a=c)}if(h>e*e){var _=t.slice(0,2+(a<<1)),f=t.slice(a<<1),d=I.simplify(_,e),p=I.simplify(f,e);return d.slice(0,d.length-2).concat(p)}return[n,r,s,o]};var D=t.hxDaedalus.data.math.Tools=function(){};D.__name__=!0,D.extractMeshFromBitmap=function(t,e,i){var n=O.buildShapes(t);return D.extractMeshFromShapes(n,t.width,t.height,e,i)},D.extractMeshFromShapes=function(t,e,i,n,r,s){null==s&&(s=!1);for(var o=[],h=0,u=t.length;h<u;){var l=h++;o.push(O.buildGraph(t[l]))}for(var c=[],g=0,_=o.length;g<_;){var f=g++;c.push(O.buildPolygon(o[f]))}for(var d,p=X.buildRectangle(e,i),v=[],x=0,y=c.length;x<y;){for(var m=x++,M=0;M<c[m].length-2;)d=p.insertConstraintSegment(c[m][M],c[m][M+1],c[m][M+2],c[m][M+3]),0==M&&(d.get_edges()[0].get_originVertex().get_pos().x==c[m][M]&&d.get_edges()[0].get_originVertex().get_pos().y==c[m][M+1]?s?v.push(d.get_edges()[0].get_oppositeEdge()):v.push(d.get_edges()[0]):s?v.push(d.get_edges()[0]):v.push(d.get_edges()[0].get_oppositeEdge())),M+=2;p.insertConstraintSegment(c[m][0],c[m][1],c[m][M],c[m][M+1])}for(var w,b,E=new a,C=0,k=p._vertices.length;C<k;){var P=C++;if((w=p._vertices[P]).get_isReal()&&w.get_pos().x>0&&w.get_pos().x<e&&w.get_pos().y>0&&w.get_pos().y<i){b=new T(w.get_pos().x,w.get_pos().y),n.push(b);var S=n.length-1;E.set(w,S)}}for(var L,V=new a,A=[],F=0,R=v.length;F<R;){var I=F++;A.push(v[I].get_rightFace())}for(;A.length>0;)if(L=A.pop(),!V.h[L.__id__]){var D=L.get_edge().get_originVertex();r.push(E.h[D.__id__]);var N=L.get_edge().get_nextLeftEdge().get_originVertex();r.push(E.h[N.__id__]);var j=L.get_edge().get_nextLeftEdge().get_destinationVertex();r.push(E.h[j.__id__]),L.get_edge().get_isConstrained()||A.push(L.get_edge().get_rightFace()),L.get_edge().get_nextLeftEdge().get_isConstrained()||A.push(L.get_edge().get_nextLeftEdge().get_rightFace()),L.get_edge().get_prevLeftEdge().get_isConstrained()||A.push(L.get_edge().get_prevLeftEdge().get_rightFace()),V.set(L,!0)}return p};var N=function(){};N.__name__=!0,N.assertTrue=function(t,e,i){},N.assertFalse=function(t,e,i){},N.assertEquals=function(t,e,i,n){},N.trace=function(t,e){};var j=t.hxDaedalus.factories.BitmapMesh=function(){};j.__name__=!0,j.buildFromBmpData=function(t,e,i){for(var n,r=O.buildShapes(t,e,i),s=[],o=0,a=r.length;o<a;){var h=o++;s.push(O.buildGraph(r[h]))}for(var u=[],l=0,c=s.length;l<c;){var g=l++;u.push(O.buildPolygon(s[g],i))}for(var _=X.buildRectangle(t.width,t.height),f=0,d=u.length;f<d;){var p=f++;for(n=0;n<u[p].length-2;)_.insertConstraintSegment(u[p][n],u[p][n+1],u[p][n+2],u[p][n+3]),n+=2;_.insertConstraintSegment(u[p][0],u[p][1],u[p][n],u[p][n+1])}return _},j.prototype={__class__:j};var G=t.hxDaedalus.factories.BitmapObject=function(){};G.__name__=!0,G.buildFromBmpData=function(t,e,i,n){var r;null==e&&(e=1);t.width>0&&t.height,t.width,t.height;var s=O.buildShapes(t,i,n);if(e>=1)for(var o=0,a=s.length;o<a;){var h=o++;s[h]=I.simplify(s[h],e)}for(var u=[],l=0,c=s.length;l<c;){var g=l++;u.push(O.buildGraph(s[g]))}for(var _=[],f=0,d=u.length;f<d;){var p=f++;_.push(O.buildPolygon(u[p],n))}for(var v=new b,x=0,y=_.length;x<y;){var m=x++;for(r=0;r<_[m].length-2;)v.get_coordinates().push(_[m][r]),v.get_coordinates().push(_[m][r+1]),v.get_coordinates().push(_[m][r+2]),v.get_coordinates().push(_[m][r+3]),r+=2;v.get_coordinates().push(_[m][0]),v.get_coordinates().push(_[m][1]),v.get_coordinates().push(_[m][r]),v.get_coordinates().push(_[m][r+1])}return v},G.prototype={__class__:G};var X=t.hxDaedalus.factories.RectMesh=function(){};X.__name__=!0,X.buildRectangle=function(t,e){var i=new E,n=new E,r=new E,s=new E,o=new m,a=new m,h=new m,u=new m,l=new m,c=new m,g=new m,_=new m,f=new m,d=new m,p=new m,v=new m,b=new M,C=new M,k=new M,P=new M,S=new y,L=new x,T=new x,V=new x,A=new x,F=new w(t,e),O=10;i.get_pos().setXY(-10,-10),n.get_pos().setXY(t+O,-10),r.get_pos().setXY(t+O,e+O),s.get_pos().setXY(-10,e+O),i.setDatas(o),n.setDatas(h),r.setDatas(l),s.setDatas(g),o.setDatas(i,a,h,P,!0,!0),a.setDatas(n,o,_,b,!0,!0),h.setDatas(n,u,v,P,!0,!0),u.setDatas(r,h,f,C,!0,!0),l.setDatas(r,c,g,k,!0,!0),c.setDatas(s,l,u,C,!0,!0),g.setDatas(s,_,p,k,!0,!0),_.setDatas(i,g,d,b,!0,!0),f.setDatas(n,d,c,C,!0,!1),d.setDatas(s,f,a,b,!0,!1),p.setDatas(i,v,l,k,!1,!1),v.setDatas(r,p,o,P,!1,!1),b.setDatas(d),C.setDatas(f),k.setDatas(l,!1),P.setDatas(h,!1),i.set_fromConstraintSegments([L,A]),n.set_fromConstraintSegments([L,T]),r.set_fromConstraintSegments([T,V]),s.set_fromConstraintSegments([V,A]),o.fromConstraintSegments.push(L),a.fromConstraintSegments.push(L),h.fromConstraintSegments.push(T),u.fromConstraintSegments.push(T),l.fromConstraintSegments.push(V),c.fromConstraintSegments.push(V),g.fromConstraintSegments.push(A),_.fromConstraintSegments.push(A),L.get_edges().push(o),T.get_edges().push(h),V.get_edges().push(l),A.get_edges().push(g),L.fromShape=S,T.fromShape=S,V.fromShape=S,A.fromShape=S;for(var R=0,I=[L,T,V,A];R<I.length;){var D=I[R];++R,S.segments.push(D)}for(var N=0,j=[i,n,r,s];N<j.length;){var G=j[N];++N,F._vertices.push(G)}for(var X=0,B=[o,a,h,u,l,c,g,_,f,d,p,v];X<B.length;){var Y=B[X];++X,F._edges.push(Y)}for(var W=0,U=[b,C,k,P];W<U.length;){var H=U[W];++W,F._faces.push(H)}F.get___constraintShapes().push(S);for(var z=[],q=0,K=[0,0,t,0];q<K.length;){var Z=K[q];++q,z.push(Z)}for(var Q=0,$=[t,0,t,e];Q<$.length;){var J=$[Q];++Q,z.push(J)}for(var tt=0,et=[t,e,0,e];tt<et.length;){var it=et[tt];++tt,z.push(it)}for(var nt=0,rt=[0,e,0,0];nt<rt.length;){var st=rt[nt];++nt,z.push(st)}return F.set_clipping(!1),F.insertConstraintShape(z),F.set_clipping(!0),F},X.prototype={__class__:X};var B=t.hxDaedalus.iterators.FromEdgeToRotatedEdges=function(){};B.__name__=!0,B.prototype={__class__:B};var Y=t.hxDaedalus.iterators.FromFaceToInnerEdges=function(){};Y.__name__=!0,Y.prototype={set_fromFace:function(t){return this._fromFace=t,this._nextEdge=this._fromFace.get_edge(),t},next:function(){return null!=this._nextEdge?(this._resultEdge=this._nextEdge,this._nextEdge=this._nextEdge.get_nextLeftEdge(),this._nextEdge==this._fromFace.get_edge()&&(this._nextEdge=null)):this._resultEdge=null,this._resultEdge},__class__:Y};var W=t.hxDaedalus.iterators.FromFaceToInnerVertices=function(){};W.__name__=!0,W.prototype={set_fromFace:function(t){return this._fromFace=t,this._nextEdge=this._fromFace.get_edge(),t},next:function(){return null!=this._nextEdge?(this._resultVertex=this._nextEdge.get_originVertex(),this._nextEdge=this._nextEdge.get_nextLeftEdge(),this._nextEdge==this._fromFace.get_edge()&&(this._nextEdge=null)):this._resultVertex=null,this._resultVertex},__class__:W};var U=t.hxDaedalus.iterators.FromFaceToNeighbourFaces=function(){};U.__name__=!0,U.prototype={set_fromFace:function(t){return this._fromFace=t,this._nextEdge=this._fromFace.get_edge(),t},next:function(){if(null!=this._nextEdge)for(;;){if(this._resultFace=this._nextEdge.get_rightFace(),this._nextEdge=this._nextEdge.get_nextLeftEdge(),this._nextEdge==this._fromFace.get_edge()){this._nextEdge=null,this._resultFace.get_isReal()||(this._resultFace=null);break}if(this._resultFace.get_isReal())break}else this._resultFace=null;return this._resultFace},__class__:U};var H=t.hxDaedalus.iterators.FromMeshToFaces=function(){};H.__name__=!0,H.prototype={set_fromMesh:function(t){return this._fromMesh=t,this._currIndex=0,t},next:function(){for(;;){if(!(this._currIndex<this._fromMesh._faces.length)){this._resultFace=null;break}if(this._resultFace=this._fromMesh._faces[this._currIndex],this._currIndex++,this._resultFace.get_isReal())break}return this._resultFace},__class__:H};var z=t.hxDaedalus.iterators.FromMeshToVertices=function(){};z.__name__=!0,z.prototype={set_fromMesh:function(t){return this._fromMesh=t,this._currIndex=0,t},next:function(){for(;;){if(!(this._currIndex<this._fromMesh._vertices.length)){this._resultVertex=null;break}if(this._resultVertex=this._fromMesh._vertices[this._currIndex],this._currIndex++,this._resultVertex.get_isReal())break}return this._resultVertex},__class__:z};var q=t.hxDaedalus.iterators.FromVertexToHoldingFaces=function(){};q.__name__=!0,q.prototype={set_fromVertex:function(t){return this._fromVertex=t,this._nextEdge=this._fromVertex.get_edge(),t},next:function(){if(null!=this._nextEdge)for(;;){if(this._resultFace=this._nextEdge.get_leftFace(),this._nextEdge=this._nextEdge.get_rotLeftEdge(),this._nextEdge==this._fromVertex.get_edge()){this._nextEdge=null,this._resultFace.get_isReal()||(this._resultFace=null);break}if(this._resultFace.get_isReal())break}else this._resultFace=null;return this._resultFace},__class__:q};var K=t.hxDaedalus.iterators.FromVertexToIncomingEdges=function(){};K.__name__=!0,K.prototype={set_fromVertex:function(t){for(this._fromVertex=t,this._nextEdge=this._fromVertex.get_edge();!this._nextEdge.get_isReal();)this._nextEdge=this._nextEdge.get_rotLeftEdge();return t},next:function(){if(null!=this._nextEdge)for(this._resultEdge=this._nextEdge.get_oppositeEdge();;){if(this._nextEdge=this._nextEdge.get_rotLeftEdge(),this._nextEdge==this._fromVertex.get_edge()){this._nextEdge=null;break}if(this._nextEdge.get_isReal())break}else this._resultEdge=null;return this._resultEdge},__class__:K};var Z=t.hxDaedalus.iterators.FromVertexToNeighbourVertices=function(){};Z.__name__=!0,Z.prototype={set_fromVertex:function(t){return this._fromVertex=t,this._nextEdge=this._fromVertex.get_edge(),t},next:function(){if(null!=this._nextEdge){for(this._resultVertex=this._nextEdge.get_oppositeEdge().get_originVertex();this._nextEdge=this._nextEdge.get_rotLeftEdge(),!this._nextEdge.get_isReal(););this._nextEdge==this._fromVertex.get_edge()&&(this._nextEdge=null)}else this._resultVertex=null;return this._resultVertex},__class__:Z};var Q=t.hxDaedalus.iterators.FromVertexToOutgoingEdges=function(){this.realEdgesOnly=!0};Q.__name__=!0,Q.prototype={set_fromVertex:function(t){for(this._fromVertex=t,this._nextEdge=this._fromVertex.get_edge();this.realEdgesOnly&&!this._nextEdge.get_isReal();)this._nextEdge=this._nextEdge.get_rotLeftEdge();return t},next:function(){if(null!=this._nextEdge)for(this._resultEdge=this._nextEdge;;){if(this._nextEdge=this._nextEdge.get_rotLeftEdge(),this._nextEdge==this._fromVertex.get_edge()){this._nextEdge=null;break}if(!this.realEdgesOnly||this._nextEdge.get_isReal())break}else this._resultEdge=null;return this._resultEdge},__class__:Q};var $=t.hxDaedalus.view.SimpleView=function(t){this.faceToEdgeIter=new Y,this.faceAlpha=.5,this.faceWidth=1,this.faceColor=16711935,this.entitiesAlpha=.75,this.entitiesWidth=1,this.entitiesColor=65280,this.pathsAlpha=.75,this.pathsWidth=1.5,this.pathsColor=16760848,this.verticesAlpha=.25,this.verticesRadius=.5,this.verticesColor=255,this.constraintsAlpha=1,this.constraintsWidth=2,this.constraintsColor=16711680,this.edgesAlpha=.25,this.edgesWidth=1,this.edgesColor=10066329,this.graphics=new gt(t)};$.__name__=!0,$.prototype={drawVertex:function(t){this.graphics.graphics.lineStyle(this.verticesRadius,this.verticesColor,this.verticesAlpha),this.graphics.graphics.beginFill(this.verticesColor,this.verticesAlpha);var e=this.graphics,i=t.get_pos().x,n=t.get_pos().y;e.graphics.drawCircle(i,n,this.verticesRadius),this.graphics.graphics.endFill()},drawFace:function(t){this.faceToEdgeIter.set_fromFace(t),this.graphics.graphics.beginFill(this.faceColor,this.faceAlpha),this.graphics.graphics.lineStyle(this.faceWidth,this.faceColor,this.faceAlpha);for(var e,i=0;null!=(e=this.faceToEdgeIter.next());){if(0==i){var n=this.graphics,r=e.get_originVertex().get_pos().x,s=e.get_originVertex().get_pos().y;n.graphics.moveTo(r,s)}var o=this.graphics,a=e.get_destinationVertex().get_pos().x,h=e.get_destinationVertex().get_pos().y;o.graphics.lineTo(a,h),++i}this.graphics.graphics.endFill()},drawEdge:function(t){if(t.get_isConstrained()){this.graphics.graphics.lineStyle(this.constraintsWidth,this.constraintsColor,this.constraintsAlpha);var e=this.graphics,i=t.get_originVertex().get_pos().x,n=t.get_originVertex().get_pos().y;e.graphics.moveTo(i,n);var r=this.graphics,s=t.get_destinationVertex().get_pos().x,o=t.get_destinationVertex().get_pos().y;r.graphics.lineTo(s,o)}else{this.graphics.graphics.lineStyle(this.edgesWidth,this.edgesColor,this.edgesAlpha);var a=this.graphics,h=t.get_originVertex().get_pos().x,u=t.get_originVertex().get_pos().y;a.graphics.moveTo(h,u);var l=this.graphics,c=t.get_destinationVertex().get_pos().x,g=t.get_destinationVertex().get_pos().y;l.graphics.lineTo(c,g)}},drawMesh:function(t,e){null==e&&(e=!1),e&&this.graphics.graphics.clear();for(var i=t.getVerticesAndEdges(),n=0,r=i.vertices;n<r.length;){var s=r[n];++n,this.drawVertex(s)}for(var o=0,a=i.edges;o<a.length;){var h=a[o];++o,this.drawEdge(h)}},drawEntity:function(t,e){null==e&&(e=!1),e&&this.graphics.graphics.clear(),this.graphics.graphics.lineStyle(this.entitiesWidth,this.entitiesColor,this.entitiesAlpha),this.graphics.graphics.beginFill(this.entitiesColor,this.entitiesAlpha);var i=this.graphics,n=t.x,r=t.y,s=t.get_radius();i.graphics.drawCircle(n,r,s),this.graphics.graphics.endFill()},drawEntities:function(t,e){null==e&&(e=!1),e&&this.graphics.graphics.clear();for(var i=0,n=t.length;i<n;){var r=i++;this.drawEntity(t[r],!1)}},drawPath:function(t,e){if(null==e&&(e=!1),e&&this.graphics.graphics.clear(),0!=t.length){this.graphics.graphics.lineStyle(this.pathsWidth,this.pathsColor,this.pathsAlpha),this.graphics.graphics.moveTo(t[0],t[1]);for(var i=2;i<t.length;)this.graphics.graphics.lineTo(t[i],t[i+1]),this.graphics.graphics.moveTo(t[i],t[i+1]),i+=2}},__class__:$};var J=t.hxPixels._Pixels.Pixels_Impl_={};J.__name__=!0,J._new=function(t,e,i){return null==i&&(i=!0),new tt(t,e,i)},J.getByte=function(t,e){return t.bytes.b[(-4&e)+t.format.channelMap[3&e]]},J.getPixel=function(t,e,i){var n=i*t.width+e<<2;return t.bytes.b[n+t.format.ch1]<<16|t.bytes.b[n+t.format.ch2]<<8|t.bytes.b[n+t.format.ch3]},J.getPixel32=function(t,e,i){var n=i*t.width+e<<2;return t.bytes.b[n+t.format.ch0]<<24|t.bytes.b[n+t.format.ch1]<<16|t.bytes.b[n+t.format.ch2]<<8|t.bytes.b[n+t.format.ch3]},J.setByte=function(t,e,i){t.bytes.b[(-4&e)+t.format.channelMap[3&e]]=255&i},J.setPixel=function(t,e,i,n){var r=i*t.width+e<<2,s=n>>16&255,o=n>>8&255,a=255&n;t.bytes.b[r+t.format.ch1]=255&s,t.bytes.b[r+t.format.ch2]=255&o,t.bytes.b[r+t.format.ch3]=255&a},J.setPixel32=function(t,e,i,n){var r=i*t.width+e<<2,s=n>>24&255,o=n>>16&255,a=n>>8&255,h=255&n;t.bytes.b[r+t.format.ch0]=255&s,t.bytes.b[r+t.format.ch1]=255&o,t.bytes.b[r+t.format.ch2]=255&a,t.bytes.b[r+t.format.ch3]=255&h},J.fillRect=function(t,e,i,n,r,s){var o=i*t.width+e<<2,a=new tt(n,1,!0);a.format=t.format;for(var h=n<<2,u=0,l=n;u<l;){var c=u++;J.setPixel32(a,c,0,s)}for(var g=0,_=r;g<_;){g++;t.bytes.blit(o,a.bytes,0,h),o+=t.width<<2}},J.clone=function(t){var e=new tt(t.width,t.height,!0);return e.bytes.blit(0,t.bytes,0,t.bytes.length),e.format=t.format,e},J.fromBytes=function(t,e,i,n){var r=new tt(e,i,!1);return null==n&&(n=et.ARGB),r.bytes=t,r},J.convertTo=function(t,e){return J.convert(t,e,!0)},J.convert=function(t,e,i){null==i&&(i=!1);var n=i?t:J.clone(t);if(e==t.format)return n;var r=0,s=0;if(t.format==et.BGRA&&e==et.RGBA||t.format==et.RGBA&&e==et.BGRA)for(;r<t.count;){var o=s+1,a=t.bytes.b[(-4&o)+t.format.channelMap[3&o]],h=s+3,u=t.bytes.b[(-4&h)+t.format.channelMap[3&h]];n.bytes.b[s+e.ch1]=255&a,n.bytes.b[s+e.ch3]=255&u,++r,s+=4}else for(;r<t.count;){var l=t.bytes.b[(-4&s)+t.format.channelMap[3&s]],c=s+1,g=t.bytes.b[(-4&c)+t.format.channelMap[3&c]],_=s+2,f=t.bytes.b[(-4&_)+t.format.channelMap[3&_]],d=s+3,p=t.bytes.b[(-4&d)+t.format.channelMap[3&d]];n.bytes.b[s+e.ch0]=255&l,n.bytes.b[s+e.ch1]=255&g,n.bytes.b[s+e.ch2]=255&f,n.bytes.b[s+e.ch3]=255&p,++r,s+=4}return n.format=e,n},J.fromImageData=function(t){var e=new tt(t.width,t.height,!0);e.format=et.ARGB;for(var i=t.data,n=0,r=i.byteLength;n<r;){var s=n++;e.bytes.b[s]=255&i[s]}return e};var tt=function(t,e,i,n){null==i&&(i=!0),this.count=t*e,i&&(this.bytes=new u(new wt(this.count<<2))),this.width=t,this.height=e,this.format=null!=n?n:et.ARGB};tt.__name__=!0,tt.prototype={__class__:tt};var et=t.hxPixels.PixelFormat=function(t,e,i,n,r){null==r&&(r="PixelFormat"),this.channelMap=[t,e,i,n],this.ch0=t,this.ch1=e,this.ch2=i,this.ch3=n,this.name=r};et.__name__=!0,et.prototype={get_A:function(){return this.ch0},get_R:function(){return this.ch1},get_G:function(){return this.ch2},get_B:function(){return this.ch3},toString:function(){return this.name},__class__:et};var it=t.hxPixels._Pixels.Pixel_Impl_={};it.__name__=!0,it.get_A=function(t){return t>>24&255},it.set_A=function(t,e){return t=16777215&t|(e&=255)<<24,e},it.get_R=function(t){return t>>16&255},it.set_R=function(t,e){return t=-16711681&t|(e&=255)<<16,e},it.get_G=function(t){return t>>8&255},it.set_G=function(t,e){return t=-65281&t|(e&=255)<<8,e},it.get_B=function(t){return 255&t},it.set_B=function(t,e){return t=-256&t|(e&=255),e};var nt=function t(e){Error.call(this),this.val=e,this.message=String(e),Error.captureStackTrace&&Error.captureStackTrace(this,t)};nt.__name__=!0,nt.wrap=function(t){return t instanceof Error?t:new nt(t)},nt.__super__=Error,nt.prototype=function(t,e){function i(){}i.prototype=t;var n=new i;for(var r in e)n[r]=e[r];return e.toString!==Object.prototype.toString&&(n.toString=e.toString),n}(Error.prototype,{__class__:nt});var rt=function(){};rt.__name__=!0,rt.getClass=function(t){if(t instanceof Array&&null==t.__enum__)return Array;var e=t.__class__;if(null!=e)return e;var i=rt.__nativeClassName(t);return null!=i?rt.__resolveNativeClass(i):null},rt.__string_rec=function(t,e){if(null==t)return"null";if(e.length>=5)return"<...>";var i=typeof t;switch("function"==i&&(t.__name__||t.__ename__)&&(i="object"),i){case"function":return"<function>";case"object":if(t instanceof Array){if(t.__enum__){if(2==t.length)return t[0];var n=t[0]+"(";e+="\t";for(var r=2,s=t.length;r<s;){var o=r++;n+=2!=o?","+rt.__string_rec(t[o],e):rt.__string_rec(t[o],e)}return n+")"}var a="[";e+="\t";for(var h=0,u=t.length;h<u;){var l=h++;a+=(l>0?",":"")+rt.__string_rec(t[l],e)}return a+="]"}var c;try{c=t.toString}catch(p){return"???"}if(null!=c&&c!=Object.toString&&"function"==typeof c){var g=t.toString();if("[object Object]"!=g)return g}var _=null,f="{\n";e+="\t";var d=null!=t.hasOwnProperty;for(var _ in t)d&&!t.hasOwnProperty(_)||"prototype"!=_&&"__class__"!=_&&"__super__"!=_&&"__interfaces__"!=_&&"__properties__"!=_&&(2!=f.length&&(f+=", \n"),f+=e+_+" : "+rt.__string_rec(t[_],e));return f+="\n"+(e=e.substring(1))+"}";case"string":return t;default:return String(t)}},rt.__interfLoop=function(t,e){if(null==t)return!1;if(t==e)return!0;var i=t.__interfaces__;if(null!=i)for(var n=0,r=i.length;n<r;){var s=i[n++];if(s==e||rt.__interfLoop(s,e))return!0}return rt.__interfLoop(t.__super__,e)},rt.__instanceof=function(t,e){if(null==e)return!1;switch(e){case Array:return t instanceof Array&&null==t.__enum__;case xt:return"boolean"==typeof t;case pt:return!0;case vt:return"number"==typeof t;case dt:return"number"==typeof t&&(0|t)===t;case String:return"string"==typeof t;default:if(null==t)return!1;if("function"==typeof e){if(t instanceof e)return!0;if(rt.__interfLoop(rt.getClass(t),e))return!0}else if("object"==typeof e&&rt.__isNativeObj(e)&&t instanceof e)return!0;return e==yt&&null!=t.__name__||(e==mt&&null!=t.__ename__||t.__enum__==e)}},rt.__nativeClassName=function(t){var e=rt.__toStr.call(t).slice(8,-1);return"Object"==e||"Function"==e||"Math"==e||"JSON"==e?null:e},rt.__isNativeObj=function(t){return null!=rt.__nativeClassName(t)},rt.__resolveNativeClass=function(t){return e[t]};var st=function(t){if(t instanceof Array&&null==t.__enum__)this.a=t,this.byteLength=t.length;else{var e=t;this.a=[];for(var i=0,n=e;i<n;){var r=i++;this.a[r]=0}this.byteLength=e}};st.__name__=!0,st.sliceImpl=function(t,e){var i=new bt(this,t,null==e?null:e-t),n=new wt(i.byteLength);return new bt(n).set(i),n},st.prototype={slice:function(t,e){return new st(this.a.slice(t,e))},__class__:st};var ot=function(){};ot.__name__=!0,ot._new=function(t,e,i){var n;if("number"==typeof t){n=[];for(var s=0,o=t;s<o;){n[s++]=0}n.byteLength=n.length,n.byteOffset=0,n.buffer=new st(n)}else if(rt.__instanceof(t,st)){var a=t;null==e&&(e=0),null==i&&(i=a.byteLength-e),(n=0==e?a.a:a.a.slice(e,e+i)).byteLength=n.length,n.byteOffset=e,n.buffer=a}else{if(!(t instanceof Array&&null==t.__enum__))throw new nt("TODO "+r.string(t));(n=t.slice()).byteLength=n.length,n.byteOffset=0,n.buffer=new st(n)}return n.subarray=ot._subarray,n.set=ot._set,n},ot._set=function(t,e){if(rt.__instanceof(t.buffer,st)){var i=t;if(t.byteLength+e>this.byteLength)throw new nt("set() outside of range");for(var n=0,r=t.byteLength;n<r;){var s=n++;this[s+e]=i[s]}}else{if(!(t instanceof Array&&null==t.__enum__))throw new nt("TODO");var o=t;if(o.length+e>this.byteLength)throw new nt("set() outside of range");for(var a=0,h=o.length;a<h;){var u=a++;this[u+e]=o[u]}}},ot._subarray=function(t,e){var i=ot._new(this.slice(t,e));return i.byteOffset=t,i};var at=t.wings.core.ISimpleDrawingContext=function(){};at.__name__=!0,at.prototype={__class__:at};var ht=t.wings.jsCanvas.BasicCanvas=function(){this.canvas=window.document.createElement("canvas"),this.dom=this.canvas,this.body=window.document.body,this.surface=this.canvas.getContext("2d",null),this.style=this.dom.style,this.header=new ut,this.canvas.width=this.header.width,this.canvas.height=this.header.height,this.style.paddingLeft="0px",this.style.paddingTop="0px",this.style.left=r.string("0px"),this.style.top=r.string("0px"),this.style.position="absolute",this.style.backgroundColor=this.header.bgColor,this.surface.fillStyle=this.header.bgColor,this.image=this.dom;var t=window.document.createElement("style");t.innerHTML="@keyframes spin { from { transform:rotate( 0deg ); } to { transform:rotate( 360deg ); } }",window.document.getElementsByTagName("head")[0].appendChild(t),t.animation="spin 1s linear infinite",this.loop(this.header.frameRate),window.document.body.appendChild(this.dom)};ht.__name__=!0,ht.prototype={loop:function(t){return window.requestAnimationFrame(ft(this,this.loop)),null!=this.onEnterFrame&&this.onEnterFrame(),!0},clear:function(){this.surface.clearRect(0,0,this.header.width,this.header.height)},drawCircle:function(t,e,i){this.surface.beginPath(),this.surface.arc(t,e,i,0,2*Math.PI,!1),this.surface.stroke(),this.surface.closePath()},drawRect:function(t,e,i,n){this.surface.beginPath(),this.surface.moveTo(t,e),this.surface.lineTo(t+i,e),this.surface.lineTo(t+i,e+n),this.surface.lineTo(t,e+n),this.surface.stroke(),this.surface.closePath()},drawTri:function(t){this.surface.beginPath();for(var e=0;e<t.length;)0==e?this.surface.moveTo(t[e],t[e+1]):this.surface.lineTo(t[e],t[e+1]),e+=2;this.surface.stroke(),this.surface.closePath()},lineStyle:function(t,e,i){if(this.surface.lineWidth=t,null!=i&&1!=i){var n=e>>16&255,r=e>>8&255,o=255&e;this.surface.strokeStyle="rgba("+n+","+r+","+o+","+i+")"}else{var a=s.hex(e,6);this.surface.strokeStyle="#"+a}},moveTo:function(t,e){this.surface.beginPath(),this.surface.moveTo(t,e)},lineTo:function(t,e){this.surface.lineTo(t,e),this.surface.closePath(),this.surface.stroke()},quadTo:function(t,e,i,n){this.surface.quadraticCurveTo(t,e,i,n),this.surface.stroke()},beginFill:function(t,e){if(null!=e&&1!=e){var i=t>>16&255,n=t>>8&255,r=255&t;this.surface.fillStyle="rgba("+i+","+n+","+r+","+e+")"}else{var o=s.hex(t,6);this.surface.fillStyle="#"+o}this.surface.beginPath()},endFill:function(){this.surface.stroke(),this.surface.closePath(),this.surface.fill()},__class__:ht};var ut=function(){var t=null.split(":");this.width=r.parseInt(t[0]),this.height=r.parseInt(t[1]),this.frameRate=r.parseInt(t[2]),this.bgColor="#"+t[3]};ut.__name__=!0,ut.prototype={parseInt:function(t){return r.parseInt(t)},toHashColor:function(t){return"#"+t},__class__:ut};var lt=t.wings.jsCanvas.CanvasPixelMatrix=function(t,e,i){this.data=t,this.width=e,this.height=i,this.lookup=[];for(var n=0,r=0,s=this.height;r<s;){var o=r++;this.lookup[o]=[];for(var a=0,h=this.width;a<h;){var u=a++;this.lookup[o][u]=4*n|0,++n}}};lt.__name__=!0,lt.createCanvasPixelMatrixFromContext=function(t,e,i){var n=t.getImageData(0,0,e,i).data;return new lt(n,e,i)},lt.prototype={getPixel32:function(t,e){var i=this.lookup[e][t];return this.data[i+3]<<24|this.data[i]<<16|this.data[i+1]<<8|this.data[i+2]},setPixel32:function(t,e,i){var n=this.lookup[e][t];this.data[n+3]=i>>24&255,this.data[n]=i>>16&255,this.data[n+1]=i>>8&255,this.data[n+2]=255&i},setPixel:function(t,e,i){var n=this.lookup[e][t];this.data[n]=i>>16&255,this.data[n+1]=i>>8&255,this.data[n+2]=255&i},getPixel:function(t,e){var i=this.lookup[e][t];return this.data[i]<<16|this.data[i+1]<<8|this.data[i+2]},__class__:lt};var ct=t.wings.jsCanvas.ImageLoader=function(t,e){this.images=new h,this.loaded=e,this.count=t.length;for(var i=0;i<t.length;){var n=t[i];++i,this.load(n)}};ct.__name__=!0,ct.prototype={load:function(t){var e=window.document.createElement("img"),i=e.style;i.left="0px",i.top="0px",i.paddingLeft="0px",i.paddingTop="0px";var n=ft(this,this.store),r=e,s=t.split("/").pop();e.onload=function(t){n(r,s,t)},i.position="absolute",e.src=t},store:function(t,e,i){this.count--;var n=this.images;null!=Mt[e]?n.setReserved(e,t):n.h[e]=t,0==this.count&&this.loaded()},__class__:ct};var gt=t.wings.jsCanvas.SimpleDrawingContext=function(t){this.graphics=t};gt.__name__=!0,gt.__interfaces__=[at],gt.prototype={clear:function(){this.graphics.clear()},lineStyle:function(t,e,i){null==i&&(i=1),this.graphics.lineStyle(t,e,i)},beginFill:function(t,e){null==e&&(e=1),this.graphics.beginFill(t,e)},endFill:function(){this.graphics.endFill()},moveTo:function(t,e){this.graphics.moveTo(t,e)},lineTo:function(t,e){this.graphics.lineTo(t,e)},quadTo:function(t,e,i,n){this.graphics.quadTo(t,e,i,n)},drawCircle:function(t,e,i){this.graphics.drawCircle(t,e,i)},drawRect:function(t,e,i,n){this.graphics.drawRect(t,e,i,n)},drawEquilaterialTri:function(t,e,i,n){for(var r,s,o=2*Math.PI/3,a=[],h=0;h<3;){var u=h++;r=t+i*Math.cos(n+u*o),s=e+i*Math.sin(n+u*o),a.push(r),a.push(s)}this.graphics.drawTri(a)},drawTri:function(t){this.graphics.drawTri(t)},__class__:gt};var _t=0;function ft(t,e){return null==e?null:(null==e.__id__&&(e.__id__=_t++),null==t.hx__closures__?t.hx__closures__={}:i=t.hx__closures__[e.__id__],null==i&&(i=function(){return i.method.apply(i.scope,arguments)},i.scope=t,i.method=e,t.hx__closures__[e.__id__]=i),i);var i}String.prototype.__class__=String,String.__name__=!0,Array.__name__=!0;var dt={__name__:["Int"]},pt={__name__:["Dynamic"]},vt=Number;vt.__name__=["Float"];var xt=Boolean;xt.__ename__=["Bool"];var yt={__name__:["Class"]},mt={},Mt={};et.ARGB=new et(0,1,2,3,"ARGB"),et.RGBA=new et(3,0,1,2,"RGBA"),et.BGRA=new et(3,2,1,0,"BGRA");var wt=e.ArrayBuffer||st;null==wt.prototype.slice&&(wt.prototype.slice=st.sliceImpl);var bt=e.Uint8Array||ot._new;a.count=0,g.NUM_SEGMENTS=6,v.EPSILON=.01,v.EPSILON_SQUARED=1e-4,x.INC=0,y.INC=0,m.INC=0,M.INC=0,w.INC=0,b.INC=0,E.INC=0,C.INC=0,k.INC=0,P.INC=0,V.__samples=[],V.__circumcenter=new T,O.MAX_INT=2147483647,O.maxDistance=1,J.CHANNEL_MASK=3,tt.BYTES_PER_PIXEL=4,rt.__toStr={}.toString,ot.BYTES_PER_ELEMENT=1,ut.__meta__={fields:{parseInt:{static:null},toHashColor:{static:null}}}}(e,"undefined"!=typeof window?window:"undefined"!=typeof i.g?i.g:"undefined"!=typeof self?self:this)},5777:function(t,e,i){var n=i(9743).hxDaedalus,r=n.factories.RectMesh,s=n.ai.EntityAI,o=n.ai.PathFinder,a=n.data.Object;function h(t,e){var i=r.buildRectangle(t,e),n=new s,a=new o;a.entity=n,a.set_mesh(i),this.mesh=i,this.entity=n,this.pathFinder=a,this.path=[]}h.prototype.addRect=function(t,e,i,n){var r=new a;return r.set_coordinates([0,0,0,e,0,e,t,e,t,e,t,0,t,0,0,0]),r.set_x(i),r.set_y(n),this.mesh.insertObject(r),r},h.prototype.addPolygon=function(t,e,i){if(!(t.length<6)){for(var n=new a,r=[],s=t[t.length-2],o=t[t.length-1],h=0;h<t.length;h+=2){var u=t[h],l=t[h+1];r.push(s,o,u,l),s=u,o=l}return n.set_coordinates(r),n.set_x(e||0),n.set_y(i||0),this.mesh.insertObject(n),n}console.log("Polygons must contain at least 3 points!")},h.prototype.addPolyline=function(t,e,i){if(!(t.length<4)){for(var n=new a,r=[],s=0,o=0,h=0;h<t.length;h+=2){var u=t[h],l=t[h+1];h>0&&r.push(s,o,u,l),s=u,o=l}return n.set_coordinates(r),n.set_x(e||0),n.set_y(i||0),this.mesh.insertObject(n),n}console.log("Polylines must contain at least 2 points!")},h.prototype.deleteObstacle=function(t){this.mesh.deleteObject(t)},h.prototype.findPath=function(t,e,i,n,r,s){return void 0===s&&(s=this.path),this.entity.set_radius(r),this.entity.x=t,this.entity.y=e,this.pathFinder.findPath(i,n,s),s},t.exports=h},3897:function(t){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n},t.exports.__esModule=!0,t.exports.default=t.exports},5372:function(t){t.exports=function(t){if(Array.isArray(t))return t},t.exports.__esModule=!0,t.exports.default=t.exports},3405:function(t,e,i){var n=i(3897);t.exports=function(t){if(Array.isArray(t))return n(t)},t.exports.__esModule=!0,t.exports.default=t.exports},6115:function(t){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t},t.exports.__esModule=!0,t.exports.default=t.exports},6690:function(t){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports},9728:function(t){function e(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}t.exports=function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t},t.exports.__esModule=!0,t.exports.default=t.exports},4704:function(t,e,i){var n=i(6116);t.exports=function(t,e){var i="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=n(t))||e&&t&&"number"===typeof t.length){i&&(t=i);var r=0,s=function(){};return{s:s,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,h=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return a=t.done,t},e:function(t){h=!0,o=t},f:function(){try{a||null==i.return||i.return()}finally{if(h)throw o}}}},t.exports.__esModule=!0,t.exports.default=t.exports},6389:function(t,e,i){var n=i(3808),r=i(9617),s=i(4993);t.exports=function(t){var e=r();return function(){var i,r=n(t);if(e){var o=n(this).constructor;i=Reflect.construct(r,arguments,o)}else i=r.apply(this,arguments);return s(this,i)}},t.exports.__esModule=!0,t.exports.default=t.exports},3808:function(t){function e(i){return t.exports=e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},t.exports.__esModule=!0,t.exports.default=t.exports,e(i)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},1655:function(t,e,i){var n=i(6015);t.exports=function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&n(t,e)},t.exports.__esModule=!0,t.exports.default=t.exports},9617:function(t){t.exports=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}},t.exports.__esModule=!0,t.exports.default=t.exports},9498:function(t){t.exports=function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)},t.exports.__esModule=!0,t.exports.default=t.exports},8872:function(t){t.exports=function(t,e){var i=null==t?null:"undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var n,r,s=[],o=!0,a=!1;try{for(i=i.call(t);!(o=(n=i.next()).done)&&(s.push(n.value),!e||s.length!==e);o=!0);}catch(h){a=!0,r=h}finally{try{o||null==i.return||i.return()}finally{if(a)throw r}}return s}},t.exports.__esModule=!0,t.exports.default=t.exports},2218:function(t){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports},2281:function(t){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports},4993:function(t,e,i){var n=i(8698).default,r=i(6115);t.exports=function(t,e){if(e&&("object"===n(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return r(t)},t.exports.__esModule=!0,t.exports.default=t.exports},7061:function(t,e,i){var n=i(8698).default;function r(){"use strict";t.exports=r=function(){return e},t.exports.__esModule=!0,t.exports.default=t.exports;var e={},i=Object.prototype,s=i.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",h=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(L){l=function(t,e,i){return t[e]=i}}function c(t,e,i,n){var r=e&&e.prototype instanceof f?e:f,s=Object.create(r.prototype),o=new k(n||[]);return s._invoke=function(t,e,i){var n="suspendedStart";return function(r,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw s;return S()}for(i.method=r,i.arg=s;;){var o=i.delegate;if(o){var a=b(o,i);if(a){if(a===_)continue;return a}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===n)throw n="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n="executing";var h=g(t,e,i);if("normal"===h.type){if(n=i.done?"completed":"suspendedYield",h.arg===_)continue;return{value:h.arg,done:i.done}}"throw"===h.type&&(n="completed",i.method="throw",i.arg=h.arg)}}}(t,i,o),s}function g(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(L){return{type:"throw",arg:L}}}e.wrap=c;var _={};function f(){}function d(){}function p(){}var v={};l(v,a,(function(){return this}));var x=Object.getPrototypeOf,y=x&&x(x(P([])));y&&y!==i&&s.call(y,a)&&(v=y);var m=p.prototype=f.prototype=Object.create(v);function M(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function i(r,o,a,h){var u=g(t[r],t,o);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==n(c)&&s.call(c,"__await")?e.resolve(c.__await).then((function(t){i("next",t,a,h)}),(function(t){i("throw",t,a,h)})):e.resolve(c).then((function(t){l.value=t,a(l)}),(function(t){return i("throw",t,a,h)}))}h(u.arg)}var r;this._invoke=function(t,n){function s(){return new e((function(e,r){i(t,n,e,r)}))}return r=r?r.then(s,s):s()}}function b(t,e){var i=t.iterator[e.method];if(void 0===i){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,b(t,e),"throw"===e.method))return _;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return _}var n=g(i,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,_;var r=n.arg;return r?r.done?(e[t.resultName]=r.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,_):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,_)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function P(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,n=function e(){for(;++i<t.length;)if(s.call(t,i))return e.value=t[i],e.done=!1,e;return e.value=void 0,e.done=!0,e};return n.next=n}}return{next:S}}function S(){return{value:void 0,done:!0}}return d.prototype=p,l(m,"constructor",p),l(p,"constructor",d),d.displayName=l(p,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,l(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},M(w.prototype),l(w.prototype,h,(function(){return this})),e.AsyncIterator=w,e.async=function(t,i,n,r,s){void 0===s&&(s=Promise);var o=new w(c(t,i,n,r),s);return e.isGeneratorFunction(i)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},M(m),l(m,u,"Generator"),l(m,a,(function(){return this})),l(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=[];for(var i in t)e.push(i);return e.reverse(),function i(){for(;e.length;){var n=e.pop();if(n in t)return i.value=n,i.done=!1,i}return i.done=!0,i}},e.values=P,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!t)for(var e in this)"t"===e.charAt(0)&&s.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(i,n){return o.type="throw",o.arg=t,e.next=i,n&&(e.method="next",e.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n],o=r.completion;if("root"===r.tryLoc)return i("end");if(r.tryLoc<=this.prev){var a=s.call(r,"catchLoc"),h=s.call(r,"finallyLoc");if(a&&h){if(this.prev<r.catchLoc)return i(r.catchLoc,!0);if(this.prev<r.finallyLoc)return i(r.finallyLoc)}else if(a){if(this.prev<r.catchLoc)return i(r.catchLoc,!0)}else{if(!h)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return i(r.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&s.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var r=n;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var o=r?r.completion:{};return o.type=t,o.arg=e,r?(this.method="next",this.next=r.finallyLoc,_):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),_},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),C(i),_}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var r=n.arg;C(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,i){return this.delegate={iterator:P(t),resultName:e,nextLoc:i},"next"===this.method&&(this.arg=void 0),_}},e}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports},6015:function(t){function e(i,n){return t.exports=e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},t.exports.__esModule=!0,t.exports.default=t.exports,e(i,n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},7424:function(t,e,i){var n=i(5372),r=i(8872),s=i(6116),o=i(2218);t.exports=function(t,e){return n(t)||r(t,e)||s(t,e)||o()},t.exports.__esModule=!0,t.exports.default=t.exports},861:function(t,e,i){var n=i(3405),r=i(9498),s=i(6116),o=i(2281);t.exports=function(t){return n(t)||r(t)||s(t)||o()},t.exports.__esModule=!0,t.exports.default=t.exports},8698:function(t){function e(i){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(i)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},6116:function(t,e,i){var n=i(3897);t.exports=function(t,e){if(t){if("string"===typeof t)return n(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(t,e):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports}},e={};function i(n){var r=e[n];if(void 0!==r)return r.exports;var s=e[n]={exports:{}};return t[n].call(s.exports,s,s.exports,i),s.exports}i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,{a:e}),e},i.d=function(t,e){for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}(),i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){e=function(){return i};var i={},n=Object.prototype,r=n.hasOwnProperty,s="function"==typeof Symbol?Symbol:{},o=s.iterator||"@@iterator",a=s.asyncIterator||"@@asyncIterator",h=s.toStringTag||"@@toStringTag";function u(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(S){u=function(t,e,i){return t[e]=i}}function l(t,e,i,n){var r=e&&e.prototype instanceof _?e:_,s=Object.create(r.prototype),o=new C(n||[]);return s._invoke=function(t,e,i){var n="suspendedStart";return function(r,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw s;return P()}for(i.method=r,i.arg=s;;){var o=i.delegate;if(o){var a=w(o,i);if(a){if(a===g)continue;return a}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===n)throw n="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n="executing";var h=c(t,e,i);if("normal"===h.type){if(n=i.done?"completed":"suspendedYield",h.arg===g)continue;return{value:h.arg,done:i.done}}"throw"===h.type&&(n="completed",i.method="throw",i.arg=h.arg)}}}(t,i,o),s}function c(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(S){return{type:"throw",arg:S}}}i.wrap=l;var g={};function _(){}function f(){}function d(){}var p={};u(p,o,(function(){return this}));var v=Object.getPrototypeOf,x=v&&v(v(k([])));x&&x!==n&&r.call(x,o)&&(p=x);var y=d.prototype=_.prototype=Object.create(p);function m(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function M(e,i){function n(s,o,a,h){var u=c(e[s],e,o);if("throw"!==u.type){var l=u.arg,g=l.value;return g&&"object"==t(g)&&r.call(g,"__await")?i.resolve(g.__await).then((function(t){n("next",t,a,h)}),(function(t){n("throw",t,a,h)})):i.resolve(g).then((function(t){l.value=t,a(l)}),(function(t){return n("throw",t,a,h)}))}h(u.arg)}var s;this._invoke=function(t,e){function r(){return new i((function(i,r){n(t,e,i,r)}))}return s=s?s.then(r,r):r()}}function w(t,e){var i=t.iterator[e.method];if(void 0===i){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method))return g;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var n=c(i,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,g;var r=n.arg;return r?r.done?(e[t.resultName]=r.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,g):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,g)}function b(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function E(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(b,this),this.reset(!0)}function k(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,n=function e(){for(;++i<t.length;)if(r.call(t,i))return e.value=t[i],e.done=!1,e;return e.value=void 0,e.done=!0,e};return n.next=n}}return{next:P}}function P(){return{value:void 0,done:!0}}return f.prototype=d,u(y,"constructor",d),u(d,"constructor",f),f.displayName=u(d,h,"GeneratorFunction"),i.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},i.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,h,"GeneratorFunction")),t.prototype=Object.create(y),t},i.awrap=function(t){return{__await:t}},m(M.prototype),u(M.prototype,a,(function(){return this})),i.AsyncIterator=M,i.async=function(t,e,n,r,s){void 0===s&&(s=Promise);var o=new M(l(t,e,n,r),s);return i.isGeneratorFunction(e)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},m(y),u(y,h,"Generator"),u(y,o,(function(){return this})),u(y,"toString",(function(){return"[object Generator]"})),i.keys=function(t){var e=[];for(var i in t)e.push(i);return e.reverse(),function i(){for(;e.length;){var n=e.pop();if(n in t)return i.value=n,i.done=!1,i}return i.done=!0,i}},i.values=k,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(i,n){return o.type="throw",o.arg=t,e.next=i,n&&(e.method="next",e.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),h=r.call(s,"finallyLoc");if(a&&h){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!h)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var s=n;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,g):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),E(i),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var r=n.arg;E(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,i){return this.delegate={iterator:k(t),resultName:e,nextLoc:i},"next"===this.method&&(this.arg=void 0),g}},i}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function r(t,e){var i="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(t){if("string"===typeof t)return n(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(t,e):void 0}}(t))||e&&t&&"number"===typeof t.length){i&&(t=i);var r=0,s=function(){};return{s:s,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,h=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return a=t.done,t},e:function(t){h=!0,o=t},f:function(){try{a||null==i.return||i.return()}finally{if(h)throw o}}}}function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function o(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function a(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?o(Object(i),!0).forEach((function(e){s(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function h(t,e,i,n,r,s,o){try{var a=t[s](o),h=a.value}catch(u){return void i(u)}a.done?e(h):Promise.resolve(h).then(n,r)}var u=i(5547),l=i(5777),c=i.n(l),g=function(){var t,i=(t=e().mark((function t(){var i,n,s,o,h,l,g,_,f,d,p,v,x,y,m,M,w,b,E,C,k,P,S,L,T,V,A,F,O,R,I;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=new(c())(500,1e3),n=(0,u.createStage)(),s=n.getCanvas(),o=(0,u.createViewport)(s,500,1e3),h=o.getContext(),t.next=7,u.Texture.load(h,"./pokemon-bg.jpg");case 7:return l=t.sent,t.next=10,fetch("./test.tmj").then((function(t){return t.json()}));case 10:g=t.sent,_=g.layers.find((function(t){return"obstacles"===t.name})).objects.map((function(t){return a(a({},t),{},{y:1e3-t.y-t.height})})),f=r(_);try{for(f.s();!(d=f.n()).done;)p=d.value,i.addRect(p.width,p.height,p.x,p.y)}catch(e){f.e(e)}finally{f.f()}return t.next=16,u.Texture.load(h,"./spritesheet.png");case 16:v=t.sent,x=u.TextureRegion.splitTexture(v,4,4),y=new u.Animation(x.slice(0,4),.2),m=new u.Animation(x.slice(4,8),.2),M=new u.Animation(x.slice(8,12),.2),w=new u.Animation(x.slice(12,16),.2),b=new u.ShapeRenderer(h),E=new u.PolygonBatch(h),C=o.getCamera(),k=new u.ViewportInputHandler(o),P=new u.Vector2(250,500),S=0,L=0,T=new u.Vector2,V=new u.Vector2,A=0,h.clearColor(0,0,0,1),F=new u.Vector2(250,500),O=[],k.addEventListener(u.InputEvent.TouchStart,(function(t,e){O.length=0,A=0,F=k.getTouchedWorldCoord(),i.findPath(P.x,P.y,F.x,F.y,10,O),console.log(O),F.x=O[0],F.y=O[1],L=180*Math.atan2(F.y-P.y,F.x-P.x)/Math.PI})),R=y.getKeyFrame(S,u.PlayMode.NORMAL),I=150,(0,u.createGameLoop)((function(t){T.x=F.x-P.x,T.y=F.y-P.y,V=T.nor(),h.clear(h.COLOR_BUFFER_BIT),b.setProjection(C.projectionView.values),b.begin(),b.rect(!0,0,0,500,1e3),b.end(),P.x!==F.x||P.y!==F.y?(S+=t,L>=-45&&L<45&&(R=M.getKeyFrame(S,u.PlayMode.LOOP)),L>=-135&&L<-45&&(R=y.getKeyFrame(S,u.PlayMode.LOOP)),L>=45&&L<135&&(R=w.getKeyFrame(S,u.PlayMode.LOOP)),(L>=135&&L<180||L<=-135&&L>=-180)&&(R=m.getKeyFrame(S,u.PlayMode.LOOP)),P.x<F.x&&(P.x=Math.min(P.x+V.x*I*t,F.x)),P.y<F.y&&(P.y=Math.min(P.y+V.y*I*t,F.y)),P.x>F.x&&(P.x=Math.max(P.x+V.x*I*t,F.x)),P.y>F.y&&(P.y=Math.max(P.y+V.y*I*t,F.y))):(S=0,setTimeout((function(){R=y.getKeyFrame(S,u.PlayMode.NORMAL)}),.2),A<=O.length?A+=2:A=0,F.x=O[A],F.y=O[A+1],L=180*Math.atan2(F.y-P.y,F.x-P.x)/Math.PI),E.setProjection(C.projectionView.values),E.begin(),E.draw(l,0,0,500,1e3),R.draw(E,P.x-50,P.y-20,100,100),E.end()}));case 39:case"end":return t.stop()}}),t)})),function(){var e=this,i=arguments;return new Promise((function(n,r){var s=t.apply(e,i);function o(t){h(s,n,r,o,a,"next",t)}function a(t){h(s,n,r,o,a,"throw",t)}o(void 0)}))});return function(){return i.apply(this,arguments)}}();g()}()}();
//# sourceMappingURL=main.6a3f1d48.js.map